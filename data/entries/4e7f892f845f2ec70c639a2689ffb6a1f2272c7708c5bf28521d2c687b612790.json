{"title":"New – AWS CloudTrail Lake Supports Ingesting Activity Events From Non-AWS Sources","link":"https://aws.amazon.com/blogs/aws/new-aws-cloudtrail-lake-supports-ingesting-activity-events-from-non-aws-sources/","date":1675192879000,"content":"<p>In November 2013, we <a href=\"https://aws.amazon.com/blogs/aws/aws-cloudtrail-capture-aws-api-activity/\">announced AWS CloudTrail</a> to track user activity and API usage. AWS CloudTrail enables auditing, security monitoring, and operational troubleshooting. CloudTrail records user activity and API calls across AWS services as events. CloudTrail events help you answer the questions of “who did what, where, and when?”.</p> \n<p>Recently we have improved the ability for you to simplify your auditing and security analysis by using <a href=\"https://aws.amazon.com/blogs/mt/announcing-aws-cloudtrail-lake-a-managed-audit-and-security-lake/\">AWS CloudTrail Lake</a>. CloudTrail Lake is a managed data lake for capturing, storing, accessing, and analyzing user and API activity on AWS for audit, security, and operational purposes. You can aggregate and immutably store your activity events, and run SQL-based queries for search and analysis.</p> \n<p>We have heard your feedback that aggregating activity information from diverse applications across hybrid environments is complex and costly, but important for a comprehensive picture of your organization’s security and compliance posture.</p> \n<p>Today we are announcing support of ingestion for activity events from non-AWS sources using CloudTrail Lake, making it a single location of immutable user and API activity events for auditing and security investigations. Now you can consolidate, immutably store, search, and analyze activity events from AWS and non-AWS sources, such as in-house or SaaS applications, in one place.</p> \n<p>Using the new <code>PutAuditEvents</code> API in CloudTrail Lake, you can centralize user activity information from disparate sources into CloudTrail Lake, enabling you to analyze, troubleshoot and diagnose issues using this data. CloudTrail Lake records all events in standardized schema, making it easier for users to consume this information to comprehensively and quickly respond to security incidents or audit requests.</p> \n<p>CloudTrail Lake is also integrated with selected AWS Partners, such as Cloud Storage Security, Clumio, CrowdStrike, CyberArk, GitHub, Kong Inc, LaunchDarkly, MontyCloud, Netskope, Nordcloud, Okta, One Identity, Shoreline.io, Snyk, and Wiz, allowing you to easily enable audit logging through the CloudTrail console.</p> \n<p><strong><u>Getting Started to Integrate External Sources</u></strong><br /> You can start to ingest activity events from your own data sources or partner applications by choosing <strong>Integrations</strong> under the <strong>Lake</strong> menu in the <a href=\"https://console.aws.amazon.com/cloudtrailv2/home#/lake/integrations\">AWS CloudTrail console</a>.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-1.jpg\" alt width=\"2548\" height=\"1300\" /></p> \n<p>To create a new integration, choose <strong>Add integration</strong> and enter your channel name. You can choose the partner application source from which you want to get events. If you’re integrating with events from your own applications hosted on-premises or in the cloud, choose <strong>My custom integration</strong>.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-2.jpg\" alt width=\"2080\" height=\"1176\" /></p> \n<p>For <strong>Event delivery location</strong>, you can choose destinations for your events from this integration. This allows your application or partners to deliver events to your event data store of CloudTrail Lake. An event data store can retain your activity events for a week to up to seven years. Then you can run queries on the event data store.</p> \n<p>Choose either <strong>Use existing event data stores</strong> or <strong>Create new event data store</strong>—to receive events from integrations. To learn more about event data store, see <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store.html\">Create an event data store</a> in the AWS documentation.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-3.jpg\" alt width=\"2054\" height=\"1130\" /></p> \n<p>You can also set up the permissions policy for the channel resource created with this integration. The information required for the policy is dependent on the integration type of each partner applications.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-7.jpg\" alt width=\"2064\" height=\"1124\" /></p> \n<p>There are two types of integrations: direct and solution. With direct integrations, the partner calls the <code>PutAuditEvents</code> API to deliver events to the event data store for your AWS account. In this case, you need to provide <strong>External ID</strong>, the unique account identifier provided by the partner. You can see a link to partner website for the step-by-step guide. With solution integrations, the application runs in your AWS account and the application calls the <code>PutAuditEvents API</code> to deliver events to the event data store for your <strong>AWS account</strong>.</p> \n<p>To find the Integration type for your partner, choose the <strong>Available sources</strong> tab from the integrations page.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-6.jpg\" alt width=\"2076\" height=\"1188\" /></p> \n<p>After creating an integration, you will need to provide this Channel ARN to the source or partner application. Until these steps are finished, the status will remain as <strong>incomplete</strong>. Once CloudTrail Lake starts receiving events for the integrated partner or application, the status field will be updated to reflect the current state.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/01/26/2023-cloudtrail-extsources-4.jpg\" alt width=\"2138\" height=\"1116\" /></p> \n<p>To ingest your application’s activity events into your integration, call the <code>PutAuditEvents</code> API to add the payload of events. Be sure that there is no sensitive or personally identifying information in the event payload before ingesting it into CloudTrail Lake.</p> \n<p>You can make a JSON array of event objects, which includes a required user-generated ID from the event, the required payload of the event as the value of EventData, and an optional checksum to help validate the integrity of the event after ingestion into CloudTrail Lake.</p> \n<pre><code>{\n  \"AuditEvents\": [\n     {\n      \"Id\": \"event_ID\",\n      \"EventData\": \"{event_payload}\", \"EventDataChecksum\": \"optional_checksum\",\n     },\n   ... ]\n}</code></pre> \n<p>The following example shows how to use the <code>put-audit-events</code> AWS CLI command.</p> \n<pre><code>$ aws cloudtrail-data put-audit-events \\\n--channel-arn $ChannelArn \\\n--external-id $UniqueExternalIDFromPartner \\\n--audit-events \\\n{\n  \"Id\": \"87f22433-0f1f-4a85-9664-d50a3545baef\",\n  \"EventData\":\"{\\\"eventVersion\\\":\\0.01\\\",\\\"eventSource\\\":\\\"MyCustomLog2\\\", ...\\}\",\n},\n{\n  \"Id\": \"7e5966e7-a999-486d-b241-b33a1671aa74\",\n  \"EventData\":\"{\\\"eventVersion\\\":\\0.02\\\",\\\"eventSource\\\":\\\"MyCustomLog1\\\", ...\\}\",\n\"EventDataChecksum\":\"848df986e7dd61f3eadb3ae278e61272xxxx\",\n}</code></pre> \n<p>On the <strong>Editor</strong> tab in the CloudTrail Lake, write your own queries for a new integrated event data store to check delivered events.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2022/09/21/2022-cloudtrail-extsources-5-1.jpeg\" alt width=\"1952\" height=\"1753\" /></p> \n<p>You can make your own integration query, like getting all principals across AWS and external resources that have made API calls after a particular date:</p> \n<pre><code>SELECT userIdentity.principalId FROM $AWS_EVENT_DATA_STORE_ID \nWHERE eventTime &gt; '2022-09-24 00:00:00'\nUNION ALL\nSELECT eventData.userIdentity.principalId FROM $PARTNER_EVENT_DATA_STORE_ID\nWHRERE eventData.eventTime &gt; '2022-09-24 00:00:00'</code></pre> \n<p>To learn more, see <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-lake-examples.html\">CloudTrail Lake event schema</a> and <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-lake-examples.html\">sample queries</a> to help you get started.</p> \n<p><strong><u>Launch Partners</u></strong><br /> You can see the list of our launch partners to support a CloudTrail Lake integration option in the <strong>Available sources</strong> tab. Here are blog posts and announcements from our partners who collaborated on this launch (some will be added in the next few days).</p> \n<ul> \n <li><strong>Cloud Storage Security</strong> – <a href=\"https://cloudstoragesec.com/news/css-announces-aws-cloudtrail-integration\">AWS and CSS Teamed to Deliver Integration for AWS CloudTrail Lake</a></li> \n <li><strong>Clumio</strong> – <a href=\"https://clumio.com/blog/introducing-clumios-integration-with-aws-cloudtrail-lake\">Introducing Clumio’s integration with AWS CloudTrail Lake</a></li> \n <li><strong>CrowdStrike</strong> – <a href=\"https://github.com/CrowdStrike/aws-cloudtrail-lake\">AWS CloudTrail Lake Integration</a></li> \n <li><strong>CyberArk</strong> – <a href=\"https://www.cyberark.com/resources/product-announcements-blog/cyberark-identity-security-intelligence-activity-logs-in-aws-cloudtrail-lake-for-enhanced-visibility-and-troubleshooting\">CyberArk Identity Security Intelligence Activity Logs in AWS CloudTrail Lake for Enhanced Visibility and Troubleshooting</a></li> \n <li><strong>GitHub</strong> – <a href=\"https://github.blog/changelog/2023-01-31-audit-log-streaming-to-aws-s3-integration-with-aws-cloudtrail-lake/\">Audit log streaming to AWS S3 integration with AWS CloudTrail Lake</a></li> \n <li><strong>Kong Inc</strong> – <a href=\"https://konghq.com/blog/aws-cloudtrail-lake-isv-launch-partner\">Maintain Your Kong Gateway Audit Log Trail in AWS CloudTrail Lake</a></li> \n <li><strong>LaunchDarkly</strong> – <a href=\"https://launchdarkly.com/blog/aws-cloudtrail-lake-integration?utm_campaign=aws-ctl-int\">Simplify Audits with AWS CloudTrail Lake and LaunchDarkly</a></li> \n <li><strong>MontyCloud</strong> – <a href=\"https://www.montycloud.com/montycloud-connector-for-aws-cloudtrail-lake/\">MontyCloud DAY2<img src=\"https://s.w.org/images/core/emoji/14.0.0/72x72/2122.png\" alt=\"™\" /> and AWS CloudTrail Lake deliver business context for activities performed by CloudOps teams</a></li> \n <li><strong>Netskope</strong> – <a href=\"https://www.netskope.com/blog/an-overview-of-the-netskope-aws-cloudtrail-lake-integration\">An Overview of the Netskope AWS CloudTrail Lake Integration</a></li> \n <li><strong>Okta</strong> – <a href=\"https://aws.amazon.com/ko/blogs/mt/get-visibility-into-the-activity-logs-for-your-workforce-and-customer-identities/\">Get visibility into the activity logs for your workforce and customer identities</a></li> \n <li><strong>OneIdentity</strong> – <a href=\"https://developers.onelogin.com/blog/aws-cloudtrail-lake\">Integrating OneLogin with AWS CloudTrail Lake</a></li> \n <li><strong>Shoreline.io</strong> – <a href=\"https://www.shoreline.io/blog/shoreline-audit-integration-with-aws-cloudtrail-lake\">Shoreline Audit Integration with AWS CloudTrail Lake</a></li> \n <li><strong>Snyk</strong> – <a href=\"https://snyk.io/blog/aws-cloudtrail-lake/\">Snyk integrates with AWS CloudTrail Lake to simplify security audits</a></li> \n <li><strong>Wiz</strong> – <a href=\"https://www.wiz.io/blog/wiz-and-aws-cloudtrail-lake-cloud-security-and-compliance-posture-audits\">Wiz and AWS CloudTrail Lake: Cloud security and compliance posture audits made easy</a></li> \n</ul> \n<p><strong><u>Now Available</u></strong><br /> <a href=\"https://aws.amazon.com/cloudtrail/\">AWS CloudTrail Lake</a> now supports ingesting activity events from external sources in all AWS Regions where CloudTrail Lake is available today. To learn more, see the <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-user-guide.html\">AWS documentation</a> and each partner’s getting started guides.</p> \n<p>If you are interested in becoming an <a href=\"https://aws.amazon.com/cloudtrail/partners/\">AWS CloudTrail Partner</a>, you can contact your usual partner contacts.</p> \n<p>– <a href=\"https://twitter.com/channyun\">Channy</a></p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"4e7f892f845f2ec70c639a2689ffb6a1f2272c7708c5bf28521d2c687b612790","category":"Tech"}