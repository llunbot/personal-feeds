{"title":"ดูกระบวนการ Proactive Threat Intelligence ตามดูว่า URL เว็บ phishing หนึ่งอันบอกอะไรเราได้บ้าง","link":"https://www.blognone.com/node/140764","date":1720203251000,"content":"<div><div><div><p>ครั้งนี้เราจะใช้เทคนิคในการวิเคราะห์ข่าวกรองทางไซเบอร์ (Cyber Threat Intelligence: CTI) เพื่อขยายผลจาก phishing domain เพียงอันเดียว ไปสู่การตรวจพบอีก 8,500+ โดเมน ที่อยู่ในมือของแฮกเกอร์กลุ่มเดียวกัน ซึ่งกระบวนการนี้อาจจะเรียกได้ว่าเป็น proactive threat intelligence ก็ว่าได้ครับ</p>\n<h3>เริ่มต้นจากการค้นหา phishing domain ที่น่าสนใจ</h3>\n<p>เรื่องของเรื่องคือ ผมได้เคยมีโอกาสอ่านบล็อกของนักวิจัยด้านความปลอดภัยไซเบอร์ชื่อ <a href=\"https://www.embeeresearch.io/\">Matthew</a> ซึ่งมีเนื้อหาเกี่ยวกับการตามสืบเพื่อค้นหา infrastructure ของแฮกเกอร์โดยเริ่มต้นจากโดเมนเพียงอันเดียวแล้วทำให้รู้สึกสนใจ จึงอยากลองหัดทำดูบ้างโดยใช้ตัวอย่างที่เกี่ยวข้องกับประเทศไทยเป็นหลัก (แน่นอนครับ ถ้าคนไทยไม่ทำข่าวกรองทางไซเบอร์กันเอง แล้วใครที่ไหนจะทำให้เรา?)</p>\n<p>หลังจากลองค้นหาใน <a href=\"https://app.any.run/tasks/cc4978b7-0048-4066-bf4c-c7b02eea4817/\">Any.Run</a> ปรากฏว่าผมพบ public submission อันหนึ่งซึ่งเป็น URL ต้องสงสัยที่ถูกอัพโหลดจากประเทศไทยเมื่อวันที่ 25 มิ.ย.67 และที่น่าสนใจคือ URL ดังกล่าวถูกระบุว่าไม่เป็นอันตราย (No threats detected)</p>\n<p><img alt=\"alt=&quot;ภาพที่ 1 รายละเอียดการวิเคราะห์ phishing URL ภายในเว็บไซต์ Any.Run &quot;\" src=\"https://www.blognone.com/sites/default/files/externals/5d176923805709a62fea19b8620d4f2d.png\" /><strong>ภาพที่ 1</strong> รายละเอียดการวิเคราะห์ phishing URL ภายในเว็บไซต์ Any.Run</p>\n<p>ทุกท่านสามารถดูรายละเอียดของ URL ต้องสงสัยได้จากข้อมูลด่านล่างนี้ครับ ซึ่งสำหรับท่านที่คุ้นเคยกับ  cybersecurity ดีอยู่แล้ว น่าจะทราบได้ทันทีที่เห็น ว่า URL ดังกล่าวใช้ประโยชน์จากการละเมิดการใช้งาน Google URL Redirection แต่เราจะไม่พูดถึงรายละเอียดเกี่ยวกับการทำงานของ phishing กันในตอนนี้เพราะเราจะโฟกัสไปที่การตามล่า infrastructure เป็นหลัก</p>\n<p><code>hxxps://www.google[.]com/url?q=//www.google.com.co/amp/s/899415.imfgo.org/zagiryegrt/qopfhygt/paorufgh/3ipmnw/pa[redacted]ir@bum[redacted]rad.com</code></p>\n<p>ถ้าสมมติเราคลิ๊กไปที่ URL ต้องสงสัยในข้างต้น ปลายทางสุดท้ายมันจะพาเราไปสู่หน้าเว็บเพจปลอมของ Outlook Login ที่ถูกสร้างเอาไว้บนโดเมนชื่อ <strong>yamstel[.]com</strong> ซึ่งจะถูกใช้สำหรับหลอกดักรหัสผ่านโดยมีเป้าหมายคืออีเมล <strong>pa[redacted]ir@bum[redacted]rad.com</strong> ซึ่งเป็นอีเมลของพนักงานโรงพยาบาลเอกชนชื่อดังแห่งหนึ่งในประเทศไทย</p>\n<p>ทีนี้เราก็ได้สารตั้งต้นสำหรับการตามล่าแล้วนะครับ ซึ่งก็คือ phishing domain ที่ชื่อ <em>yamstel[.]com</em></p>\n<p><img alt=\"alt=&quot;ภาพที่ 2 รายละเอียดในหน้า phishing page จะเห็นได้ว่าแฮกเกอร์เตรียมการมาเพื่อโจมตีโรงพยาบาลเอกชนชื่อดังแห่งนี้โดยเฉพาะ&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/a30f358ad0d916eb124243a2e583d81e.png\" /><strong>ภาพที่ 2</strong> รายละเอียดในหน้า phishing page จะเห็นได้ว่าแฮกเกอร์เตรียมการมาเพื่อโจมตีโรงพยาบาลเอกชนชื่อดังแห่งนี้โดยเฉพาะ</p>\n<h3>สืบหาข้อมูลเพิ่มเติมจาก phishing domain ที่พึ่งค้นพบ</h3>\n<p>เราสามารถเริ่มต้นสืบจากข้อมูลพื้นฐานของโดเมน โดยการตรวจสอบข้อมูล Whois record ซึ่งบางครั้งสามารถให้รายละเอียดเกี่ยวกับ โดเมน, ผู้จดโดเมน (ต่อไปนี้จะเรียกย่อ ๆ ว่า ผู้จด), และบริษัทที่รับจดโดเมน ซึ่งขึ้นอยู่กับว่าผู้จดให้ความสำคัญกับความเป็นส่วนตัวมากแค่ไหน โดยผู้จดสามารถซื้อบริการเพื่อเซ็นเซอร์ข้อมูลเหล่านี้ได้ ทำให้เป็นอุปสรรคต่อการวิเคราะห์เป็นอย่างมาก</p>\n<p>สำหรับกรณีของโดเมน <em>yamstel[.]com</em> เราสามารถดูข้อมูล Whois record ในส่วนที่เกี่ยวกับโดเมน (Domain Information) ได้ เช่น วันที่จดทะเบียนโดเมน บริษัทที่รับจด และข้อมูล Nameserver (NS) แต่เป็นที่น่าเสียดายเพราะเราพบว่ามันถูกวางไว้หลัง Cloudflare ทำให้เป็นเรื่องยากที่จะสืบหาหมายเลขไอพีที่แท้จริงของโดเมนดังกล่าวได้</p>\n<p><img alt=\"alt=&quot;**ภาพที่ 3** ข้อมูล Domain Information ที่พบจากการตรวจสอบข้อมูลใน Whois record&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/4faa6bb7b081054abd4ee878adefe926.png\" /><strong>ภาพที่ 3</strong> ข้อมูล Domain Information ที่พบจากการตรวจสอบข้อมูลใน Whois record</p>\n<p>แต่อย่าพึ่งเสียใจไปครับ โชคยังเข้าข้างเราอยู่บ้างเพราะแฮกเกอร์ไม่ได้ใช้บริการเซ็นเซอร์ข้อมูลทำให้เราสามารถดูข้อมูลเกี่ยวกับผู้จด (Registrant Contact) ได้ ตอนนี้เราจึงทราบว่าโดเมน <em>yamstel[.]com</em> ถูกจดทะเบียนโดยผู้ใช้ชื่อ <strong>Suiot Dishak</strong> ซึ่งถึงแม้อาจจะเป็นชื่อปลอม แต่ก็ควรค่าแก่การนำไปใช้ติดตาม (track) การโจมตีได้ในอนาคต</p>\n<p>ถึงตอนนี้สิ่งที่น่าเร้าใจกำลังจะเกิดขึ้น เพราะเราพบว่าแฮกเกอร์ใช้อีเมล <strong>sui89657@proton[.]me</strong> ในการจดทะเบียนโดเมน ซึ่งข้อมูลอันนี้เป็นเสมือนใบเบิกทางไปสู่สวนหลังบ้านของแฮกเกอร์ครับ</p>\n<p><img alt=\"alt=&quot;ภาพที่ 4 ข้อมูล Registrant Contact ที่พบจากการตรวจสอบข้อมูลใน Whois record&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/d0402c2c32f633ebabba3cf83cc6086a.png\" /><strong>ภาพที่ 4</strong> ข้อมูล Registrant Contact ที่พบจากการตรวจสอบข้อมูลใน Whois record</p>\n<p>ประโยชน์ของการค้นพบอีเมลที่แฮกเกอร์ใช้ในการจดโดเมนก็คือ เราสามารถนำอีเมลดังกล่าวไปตรวจสอบย้อนกลับเพื่อค้นหาโดเมนอื่น ๆ ที่ถูกจดทะเบียนด้วยอีเมลเดียวกันนั้นได้ หรือที่เรียกว่า Reverse Whois Lookup โดยในครั้งนี้เราจะใช้บริการของเว็บไซต์ชื่อ <a href=\"https://WHOXY.com\"><strong>WHOXY.com</strong></a> เพื่อตรวจสอบข้อมูลดังล่าว ซึ่งผลลัพธ์ที่ได้คือ เราค้นพบว่ามีโดเมนทั้งหมด 18 รายการ ถูกจดทะเบียนด้วยอีเมล <em>sui89657@proton[.]me</em></p>\n<p><img alt=\"alt=&quot;ภาพที่ 5 ผลลัพธ์จากการตรวจสอบข้อมูลการจดทะเบียนโดเมนด้วยวิธี Reverse Whois Lookup โดยใช้อีเมลของแฮกเกอร์&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/9b9c5be7783c7cda765daa2dc2b9a77a.png\" /><strong>ภาพที่ 5</strong> ผลลัพธ์จากการตรวจสอบข้อมูลการจดทะเบียนโดเมนด้วยวิธี Reverse Whois Lookup โดยใช้อีเมลของแฮกเกอร์</p>\n<p>นอกเหนือจากชื่อของโดเมนทั้ง 18 รายการ ที่เราค้นพบเพิ่มเติมนี้แล้ว ถ้าเรามองดูในรายละเอียดจะพบสิ่งที่น่าสนใจ ดังนี้</p>\n<ul>\n<li>เรารู้แน่แล้วว่าแฮกเกอร์มักจะใช้บริษัทที่รับจดทะเบียนชื่อ <strong>PSI-USA, Inc.</strong> และ <strong>PDR Ltd.</strong> ดังนั้นถ้าองค์กรของใครเป็นเป้าหมายของแฮกเกอร์กลุ่มนี้ ในระหว่างการรับมือการโจมตีทางไซเบอร์ก็ควรจับตาโดเมนที่จดทะเบียนผ่านบริษัทเหล่านี้ไว้เป็นพิเศษ</li>\n<li>โดเมนหลายรายการถูกตั้งชื่อโดยใช้รูปแบบ <strong>ชุดอักษร-{ตัวย่อประเทศ}.com</strong> ยกตัวอย่างเช่น <em>atnpetroleum-tz[.]com</em> และ <em>coralenregy-ch[.]com</em> เป็นต้น</li>\n<li>เราจะพบว่าแฮกเกอร์พยายามปลอมแปลงชื่อโดเมนบางรายการให้คล้ายกับชื่อโดเมนขององค์กรเป้าหมาย เช่น โดเมนที่เราค้นพบล่าสุด <em>ahmedfood-pk[.]com</em> ถูกพบว่ามีความพยายามปลอมแปลงให้คล้ายกับชื่อโดเมน <em>ahmedfood[.]com.pk</em> ของบริษัท Ahmed Foods ที่ตั้งอยู่ในประเทศปากีสถาน</li>\n<li>โดเมนเหล่านี้ถูกจดทะเบียนในช่วงเดือน ก.ค.66 - พ.ย.66 แต่ถูกแบ่งนำมาใช้โจมตีจริงเป็นสองช่วงคือ ช่วงที่หนึ่งระหว่างเดือน ก.ย.66 - พ.ย.66 และ ช่วงที่สองในเดือน เม.ย.67</li>\n</ul>\n<p>นอกจากนี้หากเราเช็กการตั้งค่า Nameserver (NS) และ Mail Exchange (MX) ของโดเมนทั้ง 18 รายการ จะพบว่า สำหรับโดเมนที่ไม่ได้อยู่หลัง Cloudflare มีการตั้งค่า NS เหมือนกันทั้งหมดคือ <strong>orderbox-dns[.]com</strong> และใช้ MX เหมือนกันทั้งหมดคือ <strong>mailhostbox[.]com</strong></p>\n<p><img alt=\"alt=&quot;ภาพที่ 6 รายละเอียดข้อมูล NS และ MX ของโดเมนบางรายการที่ไม่ได้อยู่หลัง Cloudflare&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/f61b8f976e7a65ed20d73e701ddf61e3.png\" /><strong>ภาพที่ 6</strong> รายละเอียดข้อมูล NS และ MX ของโดเมนบางรายการที่ไม่ได้อยู่หลัง Cloudflare</p>\n<p>ข้อมูลที่เราค้นพบในเบื้องต้นนี้จะเป็นประโยชน์ในภายหลังเมื่อเราต้องการยืนยันว่ามีโดเมนใดบ้างที่เข้าข่ายต้องสงสัย</p>\n<p>ทีนี้ ถึงเวลาที่เราจะสืบกันต่อโดยใช้ชื่อโดเมนทั้ง 18 รายการ ที่เราพึ่งค้นพบล่าสุดครับ</p>\n<h3>สืบกันต่อ ไปให้ลึกขึ้นกับโดเมนทั้ง 18 รายการ</h3>\n<p>ในลำดับต่อไป เราจะตรวจสอบข้อมูล DNS record ของโดเมนทั้ง 18 รายการ โดยใช้บริการของเว็บไซต์ชื่อ  <a href=\"https://InfoByIp.com\"><strong>InfoByIp.com</strong></a> ซึ่งต้องขอบอกเลยว่าผลลัพธ์ที่ได้เป็นที่น่าพอใจพอสมควรครับ</p>\n<p>ในครั้งนี้ เราพบว่าแฮกเกอร์ไม่ได้วางทุกโดเมนเอาไว้หลัง Cloudflare ทำให้เราสามารถมองเห็นข้อมูลหมายเลขไอพีที่แท้จริงของโดเมนบางส่วนจากใน Address (A) record ซึ่งได้แก่ <strong>5.230.44[.]64</strong>, <strong>193.239.84[.]207</strong>, และ <strong>45.91.171[.]151</strong></p>\n<p><img alt=\"alt=&quot;ภาพที่ 7 ข้อมูลใน A record เผยให้เห็นหมายเลขไอพีที่แท้จริงของโดเมนบางส่วน&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/b0d59984990eb7190a9288ed3b2a6a31.png\" /><strong>ภาพที่ 7</strong> ข้อมูลใน A record เผยให้เห็นหมายเลขไอพีที่แท้จริงของโดเมนบางส่วน</p>\n<p>เพื่อไม่ให้บทความยืดเยื้อเกินไป ผมจะหยิบแค่ไอพีหมายเลข <em>193.239.84[.]207</em> มาแสดงเป็นตัวอย่างในการสืบหาข้อมูลในลำดับถัดไป ซึ่งกระบวนการวิเคราะห์ทั้งหมดนี้สามารถนำไปใช้กับหมายเลขไอพีใดก็ได้ครับ</p>\n<p>ทีนี้ เราจะนำไอพีหมายเลข <em>193.239.84[.]207</em> ไปทำการตรวจสอบแบบย้อนกลับด้วยวิธี Passive DNS Lookup ซึ่งจะทำให้เราสามารถดูได้ว่ามีโดเมนใดบ้างที่ถูกชี้มายังหมายเลขไอพีนี้ แล้วจึงค่อยพิเคราะห์ดูว่าโดเมนไหนบ้างที่เข้าข่ายต้องสงสัย</p>\n<p>เครื่องมือในการทำ Passive DNS Lookup มีหลายตัวให้เลือกใช้ แต่ในที่นี้ผมจะใช้เครื่องมือชื่อ <a href=\"https://www.silentpush.com/community-edition/\"><strong>SilentPush</strong></a> ในการตรวจสอบ โดยผลลัพธ์ที่ได้พบว่ามีโดเมนประมาณ 130,135 รายการ ชี้มายังไอพี <em>193.239.84[.]207</em> ซึ่งการจะตรวจสอบรายละเอียดทุกโดเมนดูจะเป็นไปได้ยาก ดังนั้นเราจำเป็นต้องโฟกัสไปยังโดเมนที่ตรงกับความสนใจของเราจริง ๆ เท่านั้น</p>\n<p><img alt=\"alt=&quot;ภาพที่ 8 ผลลัพธ์จำนวน 130,135 รายการ จากการตรวจสอบ Passive DNS ของหมายเลขไอพี *193.239.84[.]207*&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/2b6aca2a0cf7d196f9c4ec7b5d8286b6.png\" /><strong>ภาพที่ 8</strong> ผลลัพธ์จำนวน 130,135 รายการ จากการตรวจสอบ Passive DNS ของหมายเลขไอพี <em>193.239.84[.]207</em></p>\n<p>ถ้ายังจำกันได้ โดเมนทั้ง 18 รายการ ที่เราค้นพบก่อนหน้านี้ถูกจดทะเบียนในช่วงเดือน ก.ค.66 - พ.ย.66 เราสามารถนำข้อมูลนี้มาใช้ในการคัดกรองได้ ทำให้จากโดเมนจำนวน 130,135 รายการ ถูกคัดกรองเหลือแค่ 4,000 รายการ โดยประมาณ</p>\n<p><img alt=\"alt=&quot;ภาพที่ 9 ผลลัพธ์จากการคัดกรองโดยกำหนดช่วงเวลา&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/a7453a400c52842ebee002d45d8d1f4c.png\" /><strong>ภาพที่ 9</strong> ผลลัพธ์จากการคัดกรองโดยกำหนดช่วงเวลา</p>\n<p>ต่อมา เราจะคัดเลือกเฉพาะโดเมนที่มีชื่อตรงกับรูปแบบ <em>ชุดอักษร-{ตัวย่อประเทศ}.com</em> ซึ่งเป็นรูปแบบที่เราตรวจพบมาก่อนหน้านี้ โดยผมพยายามที่จะใช้คำสั่ง regular expression: <em>^\\w+-[a-z]{2}.com$</em> บนเว็บไซต์ SilentPush แต่พบอุปสรรคบางประการจึงไม่สามารถดำเนินการต่อไป ผมจึงเปลี่ยนไปใช้วิธีการ ‘ดูด’ รายการของโดเมนทั้งหมดเท่าที่จะทำได้จนกว่าโควตาของผมจะหมด ซึ่งรางวัลที่ได้คือโดเมนที่ตรงสเปคเราจำนวนทั้งสิ้น 387 รายการ</p>\n<p><img alt=\"alt=&quot;ภาพที่ 10 บางส่วนของโดเมนที่คัดกรองมาได้จำนวน 387 รายการ&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/20041b1ef2395e2397b8c896f734a951.png\" /><strong>ภาพที่ 10</strong> บางส่วนของโดเมนที่คัดกรองมาได้จำนวน 387 รายการ</p>\n<p>ลำดับต่อมาคือ การพิเคราะห์ดูว่าโดเมนทั้ง 387 รายการนี้ มีโดเมนใดบ้างเข้าข่ายน่าสงสัย โดยเราสามารถนำเงื่อนไขที่เราเรียนรู้จากโดเมนทั้ง 18 รายการก่อนหน้านี้ มาใช้ในการพิจารณาเพิ่มเติม ได้แก่</p>\n<ul>\n<li>ใช้บริษัทรับจดทะเบียนคือ <em>PSI-USA, Inc.</em> หรือ <em>PDR Ltd.</em></li>\n<li>ใช้ <em>orderbox-dns[.]com</em> เป็น NS</li>\n<li>ใช้ <em>mailhostbox[.]com</em> เป็น MX</li>\n</ul>\n<p>ซึ่งผลลัพธ์ที่ได้คือ มีโดเมนที่เข้าเงื่อนไขทั้งหมด 336 รายการ ดังนั้น ณ จุดนี้ เราสามารถพูดได้แล้วว่า <strong>เราค้นพบโดเมนต้องสงสัยเพิ่มเติมอีก 336 รายการ</strong> ซึ่งมีโอกาสสูงที่โดเมนเหล่านี้จะอยู่ในการครอบครองของแฮกเกอร์คนเดียวกัน</p>\n<p><img alt=\"alt=&quot;ภาพที่ 11 ผลลัพธ์จากการนำโดเมนบางส่วนไปตรวจสอบบนเว็บไซต์ www.bulkblacklist.com&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/8451a3a98738e7166e0d80047ab6932e.png\" /><strong>ภาพที่ 11</strong> ผลลัพธ์จากการนำโดเมนบางส่วนไปตรวจสอบบนเว็บไซต์ www.bulkblacklist.com</p>\n<p>ถึงตรงนี้ กระบวนการสืบ ตรวจสอบ และวิเคราะห์ ก็ได้จบลงแต่เพียงเท่านี้ ทว่าในโลกของความเป็นจริงทุกท่านยังคงสามารถเลือกที่จะหยิบหมายเลขไอพีหรือโดเมนใด ๆ ก็ได้เพื่อนำไปเข้าวงรอบการตรวจสอบได้แบบไม่รู้จบ</p>\n<p>เอาล่ะ ก่อนเราจะลาจาก โปรดอนุญาตให้ผมแสดงอะไรให้ดูซักอย่างนะครับ</p>\n<h3>Muhammad กับ Appleseed ของเขา</h3>\n<p>ผมได้ลองเช็กโดเมนจากชุด 336 รายการ พบว่ามีโดเมนที่มีชื่อคล้ายองค์กรในประเทศไทยจำนวน 5 รายการ ได้แก่ <strong>sinologistic-th[.]com</strong>, <strong>panuspoultry-th[.]com</strong>, <strong>mmplogistics-th[.]com</strong>,  <strong>mama-th[.]com</strong>, และ <strong>harachu-th[.]com</strong> ซึ่งองค์กรเหล่านี้น่าจะเป็นเป้าหมายการโจมตีของแฮกเกอร์เช่นเดียวกัน</p>\n<p>ผมนำชื่อโดเมนในข้างต้น มาไล่เช็คดูข้อมูล Whois record และนำอีเมลที่พบจาก Registrant Contact ไปตรวจสอบต่อด้วยวิธี Reverse Whois Lookup ซึ่งสิ่งที่ผมค้นพบค่อนข้างเกินความคาดหมายอย่างมาก กล่าวคือ ผมพบว่าโดเมน <em>mmplogistics-th[.]com</em> ถูกจดทะเบียนด้วยอีเมล <strong>muhammad.appleseed1@mail[.]ru</strong> ซึ่งเมื่อนำไปตรวจสอบย้อนกลับ พบว่าอีเมลนี้ถูกใช้ในการจดทะเบียนโดเมนรวมทั้งสิ้น <strong>8,149 รายการ</strong> (ข้อมูล ณ 5 ก.ค.67)  ซึ่งชื่อโดเมนที่เพิ่งถูกจดทะเบียนล่าสุดเกิดขึ้นเมื่อวันที่ 30 ก.ค.67</p>\n<p><img alt=\"alt=&quot;ภาพที่ 12 ผลลัพธ์บางส่วนจาก Reverse Whois Lookup&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/fe8c39a0ea7e669260c322f642822fd8.png\" /><strong>ภาพที่ 12</strong> ผลลัพธ์บางส่วนจาก Reverse Whois Lookup</p>\n<p>นอกจากนี้ยังพบว่าในปี 2563 ทางบริษัทด้านความมั่นคงปลอดภัยไซเบอร์ <a href=\"https://blog.redteam.pl/2020/06/spear-phishing-muhammad-appleseed1-mail-ru.html\"><strong>REDTEAM.PL</strong></a> ได้เคยรายงานเกี่ยวกับอีเมล <em>muhammad.appleseed1@mail[.]ru</em> มาแล้ว ว่ามีความเกี่ยวข้องกับโดเมนที่ถูกนำไปใช้ในการโจมตีทางไซเบอร์ด้วยเทคนิค Business Email Compromise (BEC)</p>\n<p><img alt=\"alt=&quot;ภาพที่ 13 รายงานของ REDTEAM.PL ในปี 2563&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/3a85f56ac3d15ef24659e3f15fc249e3.png\" /><strong>ภาพที่ 13</strong> รายงานของ REDTEAM.PL ในปี 2563</p>\n<p>จากข้อมูลที่พบ ทำให้ทราบว่าแฮกเกอร์กลุ่มนี้เริ่มปฏิบัติการมาแล้วอย่างน้อย 4 ปี และยังคงดำเนินการอยู่จนถึงปัจจุบัน นอกจากนี้ยังมีการพัฒนาขีดความสามารถเพิ่มขึ้นจากการโจมตีด้วยเทคนิค BEC มาเป็นการใช้เทคนิค Adversary-in-the-Middle (AiTM)</p>\n<p><img alt=\"alt=&quot;ภาพที่ 14 แฮกเกอร์กลุ่มนี้ทำให้ผมนึกถึง meme จากภาพยนต์ชื่อดังเรื่อง John Wick&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/228079b19331c99c58bca5a106f5d9dc.png\" /><strong>ภาพที่ 14</strong> แฮกเกอร์กลุ่มนี้ทำให้ผมนึกถึง meme จากภาพยนต์ชื่อดังเรื่อง John Wick</p>\n<h3>ก่อนจากลา</h3>\n<p>ขอสรุปแบบสั้น ๆ ดังนี้ เราเริ่มต้นจากการค้นพบว่ามี phishing campaign กำลังโจมตีโรงพยาบาลเอกชนชื่อดังแห่งหนึ่งในประเทศไทย โดยมีการใช้ phishing domain ชื่อ yamstel[.]com และเราใช้เทคนิคการวิเคราะห์จนนำไปสู่การค้นพบโดเมนที่ต้องสงสัยอีกอย่างน้อย 8,503 รายการ ซึ่งมีโอกาสสูงที่จะอยู่ในการครอบครองโดยแฮกเกอร์กลุ่มเดียวกัน</p>\n<p>เราค้นพบว่า phishing campaign นี้ นอกจากจะโจมตีโรงพยาบาลเอกชนชื่อดังในไทยแล้ว ยังโจมตีองค์กรอื่น ๆ ทั้งในประเทศไทยและทั่วโลกอีกนับไม่ถ้วน โดยแฮกเกอร์ได้เริ่มปฏิบัติการมาแล้วอย่างน้อย 4 ปี และยังคงดำเนินการโจมตีอยู่ในปัจจุบัน อีกทั้งยังมีการพัฒนาขีดความสามารถในการโจมตีเพิ่มขึ้นอย่างต่อเนื่อง ทั้งการพัฒนาจากเทคนิค BEC ไปสู่ AiTM รวมไปถึงการเพิ่มจำนวนโดเมนที่จะนำไปใช้เป็นเครื่องมือในการโจมตีอยู่ตลอดเวลา ซึ่งแสดงให้เห็นว่าแฮกเกอร์กลุ่มนี้ ‘ไม่กระจอก’ นะครับ :-)</p>\n<p>และเราค้นพบข้อมูลทั้งหมดนี้โดย<strong>เริ่มต้นมาจาก phishing domain แค่ 1 รายการ</strong> ครับ ดังนั้น <strong>เราจะบล็อคทีละโดเมนทำไมในเมื่อเราบล็อคทีละ 8,500 โดเมนได้</strong> 😼</p>\n<p>ทั้งนี้ท่านที่สนใจดูข้อมูล Indicators of Compromise (IOCs) สามารถดูได้จาก ‘ที่มา’</p>\n<p>ขอบคุณทุกท่านที่ทนอ่านจนจบครับ</p>\n<p>ที่มา - <a href=\"https://medium.com/@FatzQatz/one-domain-to-catch-them-all-uncovering-multiple-phishing-domains-in-the-same-threat-actors-hands-7b2c5ca3c304\">ปรับปรุงบางส่วนจาก FatzQatz’s Medium Blog Post</a>, <a href=\"https://github.com/FatzQatz/IOCs/blob/main/202407_One%20Domain%20to%20Catch%20Them%20All%20Uncovering%20Multiple%20Phishing%20Domains%20in%20the%20Same%20Threat%20Actor%E2%80%99s%20Hands.txt\">Indicators of Compromise (IOCs)</a></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/security\">Security</a></div><div><a href=\"/topics/cybersecurity\">Cybersecurity</a></div><div><a href=\"/topics/threat-intelligence\">Threat Intelligence</a></div><div><a href=\"/topics/phishing\">Phishing</a></div><div><a href=\"/topics/depth\">In-Depth</a></div></div></div>","author":"FatzQatz","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"1d6bb12e887337e5e0e1e209801fbec79f59a254abd5c0edbd56ee3ee5001421","category":"Thai"}