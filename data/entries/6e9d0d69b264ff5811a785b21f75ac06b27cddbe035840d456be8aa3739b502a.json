{"title":"TTC-CERT พบแคมเปญ BangkokShell ถูกใช้ในการโจรกรรมข้อมูลจากหน่วยงานด้านความมั่นคงของประเทศไทย","link":"https://www.blognone.com/node/134557","date":1687944278000,"content":"<div><div><div><p>ศูนย์ประสานงานรักษาความมั่นคงปลอดภัยทางคอมพิวเตอร์ด้านโทรคมนาคม (TTC-CERT) รายงานการตรวจพบแคมเปญการโจมตีทางไซเบอร์ซึ่งทำการโจมตีหน่วยงานด้านความมั่นคงแห่งหนึ่งในประเทศไทย โดยศูนย์ TTC-CERT คาดการณ์ด้วยความเชื่อมั่นระดับปานกลาง (medium level of confidence) ว่ากลุ่มผู้โจมตีที่อยู่เบื้องหลังการโจมตีในครั้งนี้มีความเกี่ยวข้องกับกลุ่มแฮกเกอร์ที่ใช้ภาษาจีนในการสื่อสาร\n</p>\n<p>ศูนย์ TTC-CERT ตั้งชื่อให้กับแคมเปญการโจมตีนี้ว่า <strong>BangkokShell</strong> เพื่อต้องการสื่อถึงเทคนิคที่กลุ่มผู้โจมตีใช้ ซึ่งได้มีการเตรียม payload ที่เป็นไฟล์ประเภท Dynamic Link Library (DLL) โดยนำมาแปลงให้กลายเป็นข้อมูลในรูปแบบ shellcode ก่อนที่จะทำการ obfuscate ด้วยอัลกอริทึม XOR cipher และฝัง payload ดังกล่าว เอาไว้ภายในไฟล์ shellcode อีกชั้นหนึ่ง นอกจากนี้ผู้โจมตียังได้ทำการจดทะเบียนโดเมนชื่อ www.bangkokdailyone[.]com เพื่อเตรียมนำมาใช้เป็น Command and Control (C2) อีกด้วย</p>\n<p><img alt=\"alt=&quot;Imgur&quot;\" src=\"https://www.blognone.com/sites/default/files/externals/32b5e2313f611460d538d6ac3a99b2fa.png\" /></p>\n<p>แผนภาพ (diagram) แสดงภาพรวมการทำงานของมัลแวร์ในแคมเปญ BangkokShell</p>\n<p>การโจมตีเริ่มต้นโดยการใช้เทคนิค DLL Side-loading เพื่อทำการโหลดไฟล์ shellcode เข้าสู่พื้นที่หน่วยความจำของโปรเซสซึ่งต่อมาไฟล์ shellcode ดังกล่าวจะทำหน้าที่ในการ deobfuscate และ execute payload ด้วยเทคนิคที่เรียกว่า Reflective Code Loading โดยจะไม่มีการสร้างไฟล์ลงบน filesystem แต่อย่างใด ซึ่งต่อมา payload จะทำการเชื่อมต่อกลับไปยัง C2 เพื่อรับคำสั่งต่อไป โดยศูนย์ TTC-CERT ได้ทำการวิเคราะห์ payload ดังกล่าวและพบว่าเป็นมัลแวร์ประเภท Remote Access Trojan (RAT) จึงได้ตั้งชื่อให้กับมัลแวร์ตัวนี้ว่า <strong>RahadRAT</strong> (อ่านว่า ระ-หัด-แรท) </p>\n<p>มัลแวร์ RahadRAT สามารถรองรับคำสั่งจาก C2 ได้ถึง 14 รูปแบบ โดยมีวัตถุประสงค์เพื่อเก็บรวบรวมข้อมูลและบริหารจัดการไฟล์และไดเรคทอรี่บนเครื่องคอมพิวเตอร์เป้าหมาย เช่น การสร้าง การลบ และ การย้าย เป็นต้น นอกจากนั้นมัลแวร์ยังสามารถสร้างโปรเซส cmd[.]exe เพื่อ execute คำสั่งต่าง ๆ ที่ได้รับจาก C2 อีกด้วย ทั้งนี้ การเชื่อมต่อระหว่างมัลแวร์กับ C2 จะถูก obfuscate เอาไว้ด้วยอัลกอริทึม Rivest Cipher 4 (RC4) และมีการใช้งานอัลกอริทึม CRC-16/XMODEM เพื่อตรวจสอบความถูกต้องของข้อมูลที่มีการรับส่งระหว่างกัน นอกจากนี้ มัลแวร์ยังมีขีดความสามารถที่น่าสนใจอีกอย่างหนึ่งคือ กระบวนการ authentication ระหว่างมัลแวร์กับ C2 โดยใช้รหัสผ่านซึ่งต้องเข้าคู่กับหมายเลขพอร์ตที่ใช้ในการเชื่อมต่อเท่านั้น จึงเป็นที่มาของการตั้งชื่อมัลแวร์นี้ว่า RahadRAT </p>\n<p>ศูนย์ TTC-CERT พบว่า tactics, techniques, and procedures (TTP) ในส่วนที่เกี่ยวข้องกับการทำงานเมื่อได้รับคำสั่งจาก C2 ของมัลแวร์ RahadRAT มีความสอดคล้องกับ TTP ของมัลแวร์ที่ถูกใช้งานโดยกลุ่มแฮกเกอร์ที่มีชื่อว่า Camaro Dragon ซึ่งเป็น Advanced Persistence Threat (APT) ที่ใช้ภาษาจีนในการสื่อสาร (Chinese-based) ซึ่งเป็นกลุ่มที่มุ่งเป้าโจมตีประเทศในแถบเอเชียตะวันออกเฉียงใต้ ตาม<a href=\"https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/\">รายงานของ Check Point Reseach</a> ดังนั้นจึงมีความเป็นไปได้ว่าผู้โจมตีที่อยู่เบื้องหลังแคมเปญ BangkokShell มีความเกี่ยวข้องกับกลุ่มแฮกเกอร์ Camaro Dragon (หรือเรียกอีกชื่อว่า Mustang Panda (CrowdStrike), Earth Preta (Trend Micro))</p>\n<p>ศูนย์ TTC-CERT ได้เผยแพร่ข้อมูล Indicator of Compromise (IOC) และ TTP ของมัลแวร์ที่ถูกใช้ในแคมเปญ BangkokShell รวมถึงวิธีการในการตรวจจับการโจมตีผ่าน <a href=\"https://github.com/ttc-cert/TTC-CERT-Sigma-Rules/blob/main/windows/MALW_bangkokshell.yml\">Sigma rule</a> และ <a href=\"https://github.com/ttc-cert/TTC-CERT-YARA-Rules/blob/main/malware/MALW_bangkokshell.yar\">YARA rule</a> ซึ่งผู้อ่านสามารถตรวจสอบได้จากรายงานการแจ้งเตือนและรายงานผลการวิเคราะห์มัลแวร์ของศูนย์ TTC-CERT นอกจากนี้ ผู้ใช้งานที่มีระบบ MISP สามารถดาวน์โหลด MISP Event สำหรับหัวข้อในรายงานฉบับนี้ได้ที่ <a href=\"https://github.com/ttc-cert/TTC-CERT-MISP-Shared-Events/blob/main/25660619_misp-event_AMAR-230499-1.v2-BangkokShell.json\">TTC-CERT github repository</a></p>\n<p>ที่มา - <a href=\"https://www.ttc-cert.or.th/\">TTC-CERT</a>, <a href=\"https://drive.google.com/file/d/14OdsocsRVK6osG3TLxyGSB0fJZaaS2fK/view?usp=drive_link\">รายงานการแจ้งเตือนแคมเปญ BangkokShell</a>, <a href=\"https://drive.google.com/file/d/1o2uSDksXRG8RPTn7HW4jNCvuoPQMccxj/view?usp=drive_link\">รายงานผลการวิเคราะห์มัลแวร์ AMAR-230499-1.v2 - BangkokShell</a></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/ttc-cert\">TTC-CERT</a></div><div><a href=\"/topics/malware\">Malware</a></div><div><a href=\"/topics/cybersecurity\">Cybersecurity</a></div><div><a href=\"/topics/depth\">In-Depth</a></div></div></div>","author":"TTC-CERT","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"6e9d0d69b264ff5811a785b21f75ac06b27cddbe035840d456be8aa3739b502a","category":"Thai"}