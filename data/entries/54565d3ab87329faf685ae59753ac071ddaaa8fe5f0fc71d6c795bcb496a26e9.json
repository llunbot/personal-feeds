{"title":"Check your AWS Free Tier usage programmatically with a new API","link":"https://aws.amazon.com/blogs/aws/check-your-aws-free-tier-usage-programmatically-with-a-new-api/","date":1701027754000,"content":"<p>Starting today, you can check your usage of the <a href=\"https://aws.amazon.com/free\">AWS Free Tier</a> using the new <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/using-free-tier-api.html\">AWS Free Tier API</a>. You can use the API directly with the <a href=\"https://aws.amazon.com/cli/\">AWS Command Line Interface (AWS CLI)</a> or integrate it into an application with the <a href=\"https://aws.amazon.com/tools/\">AWS SDKs</a>.</p> \n<p>The AWS Free Tier program provides you with the ability to explore and try out AWS services free of charge up to specified limits for each service. The AWS Free Tier includes <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-free-tier.html\">three different types of offerings</a>:</p> \n<ul> \n <li><strong>Always free</strong> offers allow customers to use a service for free up to specified limits as long as they are an AWS customer.</li> \n <li><strong>12 months free</strong> offers allow customers to use a service for free up to specified limits for one year from the date the account was activated.</li> \n <li><strong>Short-term trials</strong> are free to use for a specified period or up to a one-time limit, depending on the service.</li> \n</ul> \n<p>Once you begin turning on AWS resources and interacting with AWS services that offer a free tier, you need to keep track of your progress toward the free tier limit so that you know when to expect to switch to pay-as-you-go pricing.</p> \n<p>There are a few ways you can keep track of your AWS Free Tier usage:</p> \n<ul> \n <li>The usage alerts in the <a href=\"https://console.aws.amazon.com/billing/home#/preferences\"><strong>Billing preferences</strong> of the AWS Billing and Cost Management console</a> are enabled by default (unless the account was created via <a href=\"https://aws.amazon.com/organizations/\">AWS Organizations</a>) and send you emails when you exceed 85 percent of the Free Tier limit for each service.</li> \n <li>You can create a zero-spend or a monthly-cost budget in the <a href=\"https://console.aws.amazon.com/billing/home?#/budgets\"><strong>Budgets</strong> section of the Billing and Cost Management console</a>. Using templates, it just requires a couple of clicks and the email address to notify.</li> \n <li>The <a href=\"https://console.aws.amazon.com/billing/home?#/freetier\"><strong>Free Tier</strong> page in the Billing and Cost Management console</a> tells you the service, the type of offer, the current usage, and the forecasted usage for each offer in the current billing period.</li> \n <li>The new <a href=\"https://docs.aws.amazon.com/aws-cost-management/latest/APIReference/API_freetier_GetFreeTierUsage.html\">GetFreeTierUsage API</a> provides the same information in the Free Tier page with a structured format that you can use programmatically.</li> \n</ul> \n<p>Let’s see how this new API works in practice.</p> \n<p><span><strong>Using the AWS Free Tier API with the AWS CLI<br /> </strong></span>I got access to a new account created in the last few months. Here, I use the <a href=\"https://aws.amazon.com/cli/\">AWS Command Line Interface (AWS CLI)</a> to call the GetFreeTierUsage API.</p> \n<pre><code>aws freetier get-free-tier-usage</code></pre> \n<p>The response is a JSON document that contains a description of the current usage for each offer that is applicable to this account during this billing period. For simplicity, I only show a few offers here.</p> \n<pre><code>{\n    \"freeTierUsages\": [\n        {\n            \"service\": \"Amazon Simple Queue Service\",\n            \"operation\": \"\",\n            \"usageType\": \"Requests\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 294387.0,\n            \"forecastedUsageAmount\": 679354.6153846154,\n            \"limit\": 1000000.0,\n            \"unit\": \"Requests\",\n            \"description\": \"1000000.0 Requests are always free per month as part of AWS Free Usage Tier (Global-Requests)\",\n            \"freeTierType\": \"Always Free\"\n        },\n        {\n            \"service\": \"Amazon Elastic Compute Cloud\",\n            \"operation\": \"\",\n            \"usageType\": \"EBS:VolumeUsage\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 9.0,\n            \"forecastedUsageAmount\": 33.0,\n            \"limit\": 30.0,\n            \"unit\": \"GB-Mo\",\n            \"description\": \"30.0 GB-Mo for free for 12 months as part of AWS Free Usage Tier (Global-EBS:VolumeUsage)\",\n            \"freeTierType\": \"12 Months Free\"\n        },\n        {\n            \"service\": \"Amazon Elastic Compute Cloud\",\n            \"operation\": \"RunInstances:0002\",\n            \"usageType\": \"BoxUsage:freetier.micro\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 476.0,\n            \"forecastedUsageAmount\": 851.0,\n            \"limit\": 750.0,\n            \"unit\": \"Hrs\",\n            \"description\": \"750.0 Hrs for free for 12 months as part of AWS Free Usage Tier (Global-BoxUsage:freetier.micro)\",\n            \"freeTierType\": \"12 Months Free\"\n        },\n        {\n            \"service\": \"Amazon Elastic Compute Cloud\",\n            \"operation\": \"RunInstances\",\n            \"usageType\": \"BoxUsage:freetier.micro\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 225.0,\n            \"forecastedUsageAmount\": 485.0,\n            \"limit\": 750.0,\n            \"unit\": \"Hrs\",\n            \"description\": \"750.0 Hrs for free for 12 months as part of AWS Free Usage Tier (Global-BoxUsage:freetier.micro)\",\n            \"freeTierType\": \"12 Months Free\"\n        },\n        {\n            \"service\": \"Amazon Redshift\",\n            \"operation\": \"RunComputeNode:0001\",\n            \"usageType\": \"Node:dc2.large\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 367.0,\n            \"forecastedUsageAmount\": 735.0,\n            \"limit\": 750.0,\n            \"unit\": \"Hrs\",\n            \"description\": \"750.0 Hrs for free per month during a short-term trial as part of AWS Free Usage Tier (Global-Node:dc2.large)\",\n            \"freeTierType\": \"Free Trial\"\n        },\n        ...\n    ]\n}</code></pre> \n<p>In the <code>freeTierUsages</code> list, I find some of the most common offers:</p> \n<ul> \n <li>Two compute offers for <a href=\"https://aws.amazon.com/ec2/\">Amazon Elastic Compute Cloud (Amazon EC2)</a>. \n  <ul> \n   <li>The offer with <code>operation</code> <code>RunInstances:0002</code> is for Windows.</li> \n   <li>The offer with <code>operation</code> <code>RunInstances</code> is for Linux.</li> \n   <li>The value of the <code>operation</code> property is the same as the platform details and usage operation displayed on the <strong>Instances</strong> or <strong>AMIs</strong> pages in the <a href=\"https://console.aws.amazon.com/ec2\">Amazon EC2 console</a>. For more information, see the <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/billing-info-fields.html#billing-info\">AMI billing information fields in the Amazon EC2 User Guide</a>.</li> \n  </ul> </li> \n <li>One storage offer for <a href=\"https://aws.amazon.com/ebs/\">Amazon Elastic Block Store (Amazon EBS)</a> volumes. This and the two Amazon EC2 compute offers have <code>freeTierType</code> equal to <code>12 Months Free</code>.</li> \n <li>An <code>Always Free</code> offer for <a href=\"https://aws.amazon.com/sqs/\">Amazon Simple Queue Service (Amazon SQS)</a>.</li> \n <li>A <code>Free Trial</code> (short-term) offer for <a href=\"https://aws.amazon.com/redshift/\">Amazon Redshift</a>.</li> \n</ul> \n<p>Let’s have a look at some properties of these offers:</p> \n<ul> \n <li><code>description</code> gives a readable explanation of what the offer is about.</li> \n <li><code>freeTierType</code> tells the type of offer: <code>Always Free</code>, <code>12 Months Free</code>, or <code>Free Trial</code> (short-term).</li> \n <li><code>unit</code> describes the unit used to measure usage for the offer. For example, <code>Hrs</code> (hours) for EC2 instances, <code>GB-Mo</code> (GB per month) for EBS volumes, <code>Requests</code> for Amazon SQS, and so on.</li> \n</ul> \n<p>Three interesting properties are the limit of the offer (<code>limit</code>), the actual usage amount of the offer (<code>actualUsageAmount</code>), and the forecasted usage amount (<code>forecastedUsageAmount</code>) at the end of the billing period (the current month). They are all based on the unit used by the offer. For example, the Windows and Linux compute offers each have a limit of 750 hours per month. For the storage offer, the limit is 30 GB per month. For Amazon SQS, the limit of the offer is one million requests per month.</p> \n<p>Details on the limits and services provided for free are detailed in each card on the <a href=\"https://aws.amazon.com/free\">AWS Free Tier page</a> and on the pricing page of each service. The actual and forecast usage amounts provided by the AWS Free Tier API are estimated up to three times per day, similar to <a href=\"https://aws.amazon.com/aws-cost-management/aws-cost-and-usage-reporting/\">AWS Cost and Usage Reports</a>.</p> \n<p>If the forecast usage is greater than the limit for the offer, I should expect to switch to pay-as-you-go pricing before the end of the billing period if I continue to use the service in the same way. Actual usage is no longer tracked by the GetFreeTierUsage API once the limit is reached. This means that the actual usage amount cannot be greater than its limit. If that’s the case, the corresponding offer is not returned by the API.</p> \n<p>For example, I look for the offers for which the forecast is greater than the limit using the <code>--query</code> option of the AWS CLI:</p> \n<div> \n <pre><code>aws freetier get-free-tier-usage --query 'freeTierUsages[?forecastedUsageAmount &gt; limit]' </code></pre> \n</div> \n<pre><code>{\n    \"freeTierUsages\": [\n        {\n            \"service\": \"Amazon Elastic Compute Cloud\",\n            \"operation\": \"\",\n            \"usageType\": \"EBS:VolumeUsage\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 9.0,\n            \"forecastedUsageAmount\": 33.0,\n            \"limit\": 30.0,\n            \"unit\": \"GB-Mo\",\n            \"description\": \"30.0 GB-Mo for free for 12 months as part of AWS Free Usage Tier (Global-EBS:VolumeUsage)\",\n            \"freeTierType\": \"12 Months Free\"\n        },\n        {\n            \"service\": \"Amazon Elastic Compute Cloud\",\n            \"operation\": \"RunInstances:0002\",\n            \"usageType\": \"BoxUsage:freetier.micro\",\n            \"region\": \"global\",\n            \"actualUsageAmount\": 476.0,\n            \"forecastedUsageAmount\": 851.0,\n            \"limit\": 750.0,\n            \"unit\": \"Hrs\",\n            \"description\": \"750.0 Hrs for free for 12 months as part of AWS Free Usage Tier (Global-BoxUsage:freetier.micro)\",\n            \"freeTierType\": \"12 Months Free\"\n        }\n    ]\n}</code></pre> \n<p>According to this result, if I want to stay within the Free Tier limits, I can check how I use EBS volumes and Amazon EC2 compute with Windows.</p> \n<p>For example, I am currently using 476 hours out of the 750 available in a month for Windows EC2 instances. At this pace, I am forecasted to cross the limit and reach about 851 hours. If I am concerned by the costs, I can switch off my Windows instances when not in use or during the night.</p> \n<p><span><strong>Things to know<br /> </strong></span>Previously, the <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/using-free-tier-api.html\">Free Tier API</a> was not publicly available and was used internally for the <a href=\"https://console.aws.amazon.com/billing/home?#/freetier\">Free Tier page in the AWS Billing console</a>, where you can find the same data. We hope that making the <a href=\"https://docs.aws.amazon.com/aws-cost-management/latest/APIReference/API_freetier_GetFreeTierUsage.html\">GetFreeTierUsage API</a> publicly available can help you have fun with AWS, have better use of the AWS Free Tier offers, and be aware of what is free and what to do when you get close to or over a limit.</p> \n<p>Using this information, you can build custom reporting that meets your business needs. For example, if you want to avoid compute costs, you can programmatically stop or hibernate your EC2 instances or set the size of an EC2 Auto Scaling group to zero. You can use any of the AWS SDKs to create a web app or integrate this data in a monitoring solution.</p> \n<p>More generally, you can send additional emails or notifications (for example, using <a href=\"https://aws.amazon.com/ses\">Amazon SES</a> or <a href=\"https://aws.amazon.com/sns\">Amazon SNS</a>) when the usage of an offer is close to its limit. This can help you get the maximum benefit of an offer without incurring additional costs. You can also do this with AWS Budgets if you set a usage budget amount to the Free Tier limit.</p> \n<p>If an offer is no longer applicable to this account (for example, because it expired at the end of the previous month), the corresponding item is not included in the list. If you save the results from previous invocations of the API, you can compare the list of offers with those reported during the previous billing cycle to see which offers have recently expired.</p> \n<p>To learn more about keeping track of your AWS Free Tier usage, we created these three 10-minute courses on <a href=\"https://skillbuilder.aws\">AWS Skill Builder</a>, an online learning center where you can learn from AWS experts and build cloud skills online:</p> \n<ul> \n <li><a href=\"https://explore.skillbuilder.aws/learn/course/external/view/elearning/15012/aws-free-tier-introduction-to-offerings\">AWS Free Tier: Introduction to Offerings</a></li> \n <li><a href=\"https://explore.skillbuilder.aws/learn/course/external/view/elearning/15010/aws-free-tier-introduction-to-monitoring-services\">AWS Free Tier: Introduction to Monitoring Services</a></li> \n <li><a href=\"https://explore.skillbuilder.aws/learn/course/external/view/elearning/15013/aws-free-tier-introduction-to-managing-services\">AWS Free Tier: Introduction to Managing Services</a></li> \n</ul> \n<p>— <a href=\"https://twitter.com/danilop\">Danilo</a></p>","author":"Danilo Poccia","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"54565d3ab87329faf685ae59753ac071ddaaa8fe5f0fc71d6c795bcb496a26e9","category":"Tech"}