{"title":"[Flutter] ว่าด้วยเรื่อง StreamBuilder vs FutureBuilder Widget","link":"https://www.somkiat.cc/flutter-streambuilder-vs-futurebuilder-widget/","date":1628780931000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>August 12, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/08/flutter-1024x486.png\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/08/flutter-1024x486.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/08/flutter-300x142.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/08/flutter-768x364.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/08/flutter.png 1124w\" sizes=\"(max-width: 1024px) 100vw, 1024px\"></figure><p>วันนี้เขียน Mobile app ด้วย Flutter เลยไปเจอ code ส่วนหนึ่งที่เกิดปัญหา<br>คือ เมื่อมีการเปลี่ยน state แล้วพบว่า app ทำการ render ใหม่ทั้งหน้า<br>แน่นอนว่า ทำให้การ render ช้า หรือ performance แย่ลง<br>ทีมพัฒนามองว่าเป็นเรื่องปกติแต่ผมคิดว่า ไม่น่าจะเป็นเรื่องที่ปกติ<br>ดังนั้นจึงมาแก้ไขกันหน่อย</p><p><strong>เริ่มต้นมาดูระบบก่อนว่า ทำงานอย่างไร ?</strong></p><ul><li>ในหน้าจะมี state หลายส่วน ซึ่งทำการดึงข้อมูลจาก API มาแสดงผล</li><li>โดยทำการเรียก API 4-5 ตัว (ไม่รู้จะเรียกเยอะไปไหน)</li><li>การทำงานจะทำการดึงข้อมูลมาทั้งหมดก่อน แล้วจึงทำการ render</li></ul><p>ผลที่ตามมาคือ กว่าจะ render หน้านี้เสร็จ ใช้เวลานานมาก<br>หรือเมื่อมีการแก้ไขบาง state ก็จะ render ทั้งหน้า</p><p><strong>ดังนั้นจึงทำการแก้ไขปัญหานี้นิดหน่อย</strong></p><div><p>ถ้าไม่คิดอะไรมาก ก็ปรับเปลี่ยน API ให้น้อยลง และให้ทำงานเร็วขึ้น !!<br>แน่นอนว่า ไม่ทำ ซึ่งจะอ้างว่า มันใช้เวลาเยอะ !!<br>ดังนั้นมีทางเดียวที่ทำได้คือ ฝั่ง mobile app ที่ใช้ Flutter นั่นเอง</p><p>โดยทำการเปลี่ยนมาใช้งาน <strong><a href=\"https://api.flutter.dev/flutter/widgets/StreamBuilder-class.html\" target=\"_blank\" rel=\"noreferrer noopener\">StreamBuilder</a></strong> และ <strong><a href=\"https://api.flutter.dev/flutter/widgets/FutureBuilder-class.html\" target=\"_blank\" rel=\"noreferrer noopener\">FutureBuilder</a></strong> Widget ไปเลย<br>เพราะว่าทั้งสองตัวนี้ ออกแบบมาให้ทำงานกับข้อมูล<br>ที่มาแบบ asynchronous และ stream<br>ที่สำคัญคือ จะทำการ render เฉพาะ Widget นั้น ๆ ด้วย<br>ไม่ได้ทำการ render ทั้งหน้าแบบเดิม<br>รวมทั้งไม่ต้องรอให้ดึงข้อมูลเสร็จก่อน render อีกด้วย</p></div><p><strong>คำถามที่ตามมาคือ ใช้อะไรดีระหว่าง StreamBuilder vs FutureBuilder Widget ?</strong></p><p>ตามจริงทั้งคู่มีพฤติกรรมการทำงานเหมือนกัน<br>คือจะ listen การเปลี่ยนแปลงของข้อมูล<br>ถ้ามีการเปลี่ยนแปลงก็จะทำการ build และ render widget ใหม่<br>แต่ต่างกันดังนี้</p><ul><li>FutureBuilder จะรับข้อมูลกลับมาเพียงครั้งเดียว เช่นข้อมูล API เป็นต้น</li><li>ส่วน StreamBuilder มากกว่า 1 ครั้ง เพราะว่าข้อมูลจะค่อย ๆ มา เช่นข้อมูล Location, VDO, Sound เป็นต้น</li></ul><p>เพียงเท่านี้ก็สามารถแก้ไขปัญหาที่เจอได้แล้ว</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"6b1e51ec7db3cec9172fdaa02aab6c0aa0661e95da9d3fa17c8712e6c001eefd","category":"Thai"}