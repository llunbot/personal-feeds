{"title":"On Apple Exclaves","link":"https://randomaugustine.medium.com/on-apple-exclaves-d683a2c37194","date":1742411108000,"content":"\n<p>Random Augustine has written a splendidly nerdy but very approachable overview of the evolution of Apple’s XNU kernel over the last decade:</p>\n\n<blockquote>\n  <p><em>2017 — Page Protection Layer</em></p>\n\n<p>With the release of the iPhone 8 and iPhone X containing the A11\nprocessor, Apple introduced a security feature known as the Page\nProtection Layer (PPL). This hardware+software feature isolated a\nsmall part of the kernel and gave it privileges to modify memory\npage tables — critical structures that manage memory access. The\nrest of the kernel lost the ability to directly modify these page\ntables. The PPL’s limited attack surface ensured that bypasses\nwere infamously rare. While PPL added a layer of protection, it\nwas only partly effective as the rest of the kernel still held\nmost privileges required to compromise data without modifying\npage tables.</p>\n\n<p><em>2021–2023 — Secure Page Table Monitor</em></p>\n\n<p>Following PPL, the release of the iPhone 13 containing the A15\nprocessor introduced new functionality utilised in iOS 17: the\nSecure Page Table Monitor (SPTM). This replaced and improved upon\nthe PPL by securing additional memory functions and dividing them\ninto subsystems, further isolating small kernel components.\nValidation of code signatures, confirming that all code had been\nsigned by Apple was also isolated.</p>\n\n<p>Around this time, oblique references to exclaves began to surface\nin XNU source code. These exclaves were speculated to be the\nsubsystems managed by SPTM. Then 2024 happened…</p>\n\n<p><em>2024 — Exclaves: A major addition to XNU</em></p>\n\n<p>With the release of XNU source code supporting M4 and A18 based\nsystems (such as the iPhone 16), the curtain was partly pulled\nback on exclaves. (Exclaves are not active on prior processors).</p>\n\n<p>It is now clear that exclaves are part of a much larger redesign\nof XNU’s security model.</p>\n</blockquote>\n\n<p>I am reminded of <a href=\"https://en.wikipedia.org/wiki/John_Gall_(author\">Gall’s Law</a>): </p>\n\n<blockquote>\n  <p>A complex system that works is invariably found to have evolved\nfrom a simple system that worked. A complex system designed from\nscratch never works and cannot be patched up to make it work. You\nhave to start over with a working simple system.</p>\n</blockquote>\n\n<p>(I also suspect that Siri — today’s Siri at least — might be a canonical example of “a complex system designed from scratch”. But that’s a different topic.)</p>\n\n<div>\n<a href=\"https://daringfireball.net/linked/2025/03/19/on-apple-exclaves\"> ★ </a>\n</div>\n\n\t","author":"John Gruber","siteTitle":"Daring Fireball","siteHash":"fc569638025dadf22a867470f8215f38855cf50e975782a6c989909474292a36","entryHash":"3b384016021b50bc75a5ebfd4ab02039c4d3219295af944d51c466b0dac13e23","category":"Tech"}