{"title":"ช่องโหว่ PuTTY เปิดทางให้คนร้ายรู้กุญแจลับ ECDSA แบบ P521 แค่เห็นข้อความที่เซ็นแล้ว 60 ข้อความ","link":"https://www.blognone.com/node/139243","date":1713280435000,"content":"<div><div><div><p>PuTTY แจ้งเตือนช่องโหว่ CVE-2024-31497 ที่ถูกค้นพบโดยทีมวิจัยจาก Ruhr University Bochum เกิดจากความผิดพลาดในการสร้างค่าสุ่มประจำข้อความ หรือ nonce จนทำให้ค่าสุ่มไม่สมบูรณ์และคนร้ายคาดเดากุญแจลับได้หากเห็นข้อความที่เซ็นไปแล้วมากพอ โดยทั่วไปประมาณ 60 ข้อความ</p>\n<p>ช่องโหว่นี้เกิดจาก PuTTY พัฒนามาก่อนที่วินโดวส์จะมีระบบสุ่มค่าอย่างปลอดภัยทำให้ต้องสร้างกระบวนการสุ่มขึ้นมาใช้งานเอง PuTTY อาศัยการแฮชข้อความด้วย SHA512 แล้ว mod q ให้เหลือค่าประมาณ 160 บิต แต่หากใช้ NIST P521 ค่าที่ได้ 9 บิตสูงสุดกลับเป็น 0 เสมอ ทำให้ค่า nonce อ่อนแอลงมาก เปิดทางให้แฮกเกอร์ที่มองเห็นข้อความที่เซ็น (เช่น แพ็กเก็ตเริ่มต้นการเชื่อมต่อ SSH) เพียงประมาณ 60 ข้อความ ก็จะกู้คืนกุญแจลับออกมาได้</p>\n<p>PuTTY ออกเวอร์ชั่น 0.81 เปลี่ยนการอิมพลีเมนต์ไปใช้วิธีมาตรฐาน <a href=\"https://www.rfc-editor.org/rfc/rfc6979\">RFC 6979</a> แต่หากมีใครใช้กุญแจก่อนหน้านี้ก็มีความเสี่ยงกุญแจหลุดอยู่ดี แต่ช่องโหว่นี้ไม่กระทบคนใช้กุญแจ EdDSA หรือ Ed25519 แต่อย่างใด ส่วนเวอร์ชั่นที่ได้รับผลกระทบทนนั้นไล่มาตั้งแต่ 0.68 (ออกปี 2017) จนถึง 0.80</p>\n<p>ที่มา - <a href=\"https://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-p521-bias.html\">PuTTY</a></p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/64d9d5d8ad7899aa22ad177d33b09ecb.png\" /></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/putty\">PuTTY</a></div><div><a href=\"/topics/security-patch\">Security Patch</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"36c3fda1f12492cd26a8fa3f493382952b51c46d8d2b7f3a9657f59605521a61","category":"Thai"}