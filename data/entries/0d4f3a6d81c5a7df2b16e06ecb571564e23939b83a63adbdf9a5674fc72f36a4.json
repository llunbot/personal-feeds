{"title":"Respecting Users’ Motion Preferences","link":"https://smashingmagazine.com/2021/10/respecting-users-motion-preferences/","date":1634812200000,"content":"<p>When working with motion on the web, it’s important to consider that not everyone experiences it in the same way. What might feel smooth and slick to some might be annoying or distracting to others — or worse, induce feelings of sickness, or even cause seizures. Websites with <strong>a lot of motion</strong> might also have a higher impact on the battery life of mobile devices, or cause more data to be used (autoplaying videos, for instance, will require more of a user’s data than a static image). These are just some of the reasons why motion-heavy sites might not be desirable for all.</p>\n<p>Most new operating systems enable the user to set their motion preferences in their system-level settings. The <code>prefers-reduced-motion</code> media query (part of the <a href=\"https://www.w3.org/TR/mediaqueries-5/#prefers-reduced-motion\">Level 5 Media Queries</a> specification) allows us to detect users’ system-level motion preferences, and apply CSS styles that respect that.</p>\n<p>The two options for <code>prefers-reduced-motion</code> are <code>reduce</code> or <code>no-preference</code>. We can use it in the following way in our CSS to turn off an element’s animation if the user has explicitly set a <strong>preference for reduced motion</strong>:</p>\n<pre><code>.some-element {\n  animation: bounce 1200ms;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .some-element {\n    animation: none;\n  }\n}</code></pre>\n\n<p>Conversely, we could set the animation <strong>only</strong> if the user has no motion preference. This has the advantage of reducing the amount of code we need to write, and means it’s less likely we’ll forget to cater for users’ motion preferences:</p>\n<pre><code>@media (prefers-reduced-motion: no-preference) {\n  .some-element {\n    animation: bounce 1200ms;\n  }\n}</code></pre>\n\n<p>An added advantage is that older browsers that don’t support <code>prefers-reduced-motion</code> will ignore the rule and only display our original, motion-free element.</p>\nWhich Rule?\n<p>Unlike <code>min-width</code> and <code>max-width</code> media queries, where the more-or-less established consensus is mobile-first (therefore favoring <code>min-width</code>), <strong>there is no single “right” way</strong> to write your reduced-motion styles. I tend to favor the second example (applying animations only if <code>prefers-reduced-motion: no-preference</code> evaluates true), for the reasons listed above. Tatiana Mac wrote <a href=\"https://www.tatianamac.com/posts/prefers-reduced-motion/\">this excellent article</a> which covers some of the approaches developers might consider taking, as well plenty of other great points, including key questions to ask when designing with motion on the web.</p>\n<p>As always, <strong>team communication</strong> and <strong>a consistent strategy</strong> are key to ensuring all bases are covered when it comes to web accessibility.</p>\nPractical Use: Applying <code>prefers-reduced-motion</code> To Scroll Behavior\n<p><code>prefers-reduced-motion</code>  has plenty of applications beyond applying (or not applying) keyframe animations or transitions. One example is smooth scrolling. If we set <code>scroll-behaviour: smooth</code> on our <code>html</code> element, when a user clicks an in-page anchor link they will be smoothly scrolled to the appropriate position on the page (<em>currently not supported in Safari</em>):</p>\n<pre><code>html {\n  scroll-behavior: smooth;\n}</code></pre>\n\n<p>Unfortunately, in CSS we don’t have much control over that behavior right now. If we have a long page of content, the page scrolls very fast, which can be a pretty unpleasant experience for someone with motion sensitivity. By wrapping it in a media query, we can <strong>prevent that behavior</strong> from being applied in cases where the user has a <code>reduced-motion</code> preference:</p>\n<pre><code>@media (prefers-reduced-motion: no-preference) {\n  html {\n    scroll-behavior: smooth;\n  }\n}</code></pre>\n\nCatering For Motion Preferences In Javascript\n<p>Sometimes we need to apply motion in JavaScript rather than CSS. We can similarly detect a user’s motion preferences with JS, using <code>matchMedia</code>. Let’s see how we can conditionally implement smooth scroll behavior in our JS code:</p>\n<pre><code>/* Set the media query */\nconst prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)')\n\nbutton.addEventListener('click', () =&gt; {\n  /* If the media query matches, set scroll behavior variable to 'auto', \n  otherwise set it to 'smooth' */\n  const behavior = prefersReducedMotion.matches ? 'auto' : 'smooth'\n\n  /* When the button is clicked, the user will be scrolled to the top */\n  window.scrollTo({\n    x: 0,\n    y: 0,\n    behavior\n  })\n})</code></pre>\n\n<p>The same principle can be used to detect whether to implement motion-rich UIs with JS libraries — or even whether to load the libraries themselves.</p>\n<p>In the following code snippet, the function returns early if the user prefers reduced motion, avoiding the unnecessary import of a large dependency — a performance win for the user. If they have no motion preference set, then we can <a href=\"https://javascript.info/modules-dynamic-imports\">dynamically import</a> the Greensock animation library and initialize our animations.</p>\n<pre><code>const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)')\n\nconst loadGSAPAndInitAnimations = () =&gt; {\n  /* If user prefers reduced motion, do nothing */\n  if (prefersReducedMotion.matches) return\n\n  /* Otherwise, import the GSAP module and initialize animations */\n  import('gsap').then((object) =&gt; {\n    const gsap = object.default\n    /* Initialize animations with GSAP here */\n  })\n}\n\nloadGSAPAndInitAnimations()</code></pre>\n\n<code>reduced-motion</code> Doesn’t Mean No Motion\n<p>When styling for reduced motion preferences, it’s important that we still provide the user with <strong>meaningful and accessible indicators</strong> of when an action has occurred. For instance, when switching off a distracting or motion-intensive hover state for users who prefer reduced motion, we must take care to provide a clear alternative style for when the user is hovering on the element.</p>\n<p>The following demo shows an elaborate transition when the user hovers or focuses on a gallery item if they have no motion preference set. If they prefer reduced motion, the transition is more subtle, yet still clearly indicates the hover state:</p>\n<p>See the Pen <a href=\"https://codepen.io/smashingmag/pen/KKvMqaL\">Gallery with prefers-reduced-motion</a> by <a href=\"https://codepen.io/michellebarker\">Michelle Barker</a>.</p>\n<p>Reduced motion doesn’t necessarily mean removing <em>all</em> transforms from our webpage either. For instance, a button that has a small arrow icon that moves a few pixels on hover is unlikely to cause problems for someone who prefers a reduced-motion experience, and provides a more useful indicator of <strong>a change of state</strong> than color alone.</p>\n<p>I sometimes see developers applying reduced motion styles in the following way, which eliminates all transitions and animations on all elements:</p>\n<pre><code>@media screen and (prefers-reduced-motion: reduce) {\n  * {\n    animation: none !important;\n    transition: none !important;\n    scroll-behavior: auto !important;\n  }\n}</code></pre>\n\n<p>This is arguably better than ignoring users’ motion preferences, but doesn’t allow us to easily tailor elements to provide more subtle transitions when necessary.</p>\n<p>In the following code snippet, we have a button that <strong>grows in scale on hover</strong>. We’re transitioning the colors and the scale, but users with a preference for reduced motion will get no transition at all:</p>\n<div>\n <pre><code>button {\n  background-color: hotpink;\n  transition: color 300ms, background-color 300ms, transform 500ms cubic-bezier(.44, .23, .47, 1.27);\n}\n\nbutton:hover,\nbutton:focus {\n  background-color: darkviolet;\n  color: white;\n  transform: scale(1.2);\n}\n\n@media screen and (prefers-reduced-motion: reduce) {\n  * {\n    animation: none !important;\n    transition: none !important;\n    scroll-behavior: auto !important;\n  }\n\n  button {\n    /* Even though we would still like to transition the colors of our button, the following rule will have no effect */\n    transition: color 200ms, background-color 200ms;\n  }\n\n  button:hover,\n  button:focus {\n    /* Preventing the button scaling on hover */\n    transform: scale(1);\n  }\n}</code></pre>\n</div>\n\n<p>Check out <a href=\"https://codepen.io/michellebarker/pen/GRvqZWN\">this demo</a> to see the effect. This is perhaps not ideal, as the sudden color switch without a transition could feel more jarring than a transition of a couple of hundred milliseconds. This is one reason why, on the whole, I generally <strong>prefer to style for reduced motion</strong> on a case-by-case basis. </p>\n<p>If you’re interested, <a href=\"https://codepen.io/michellebarker/pen/eYEzZQa\">this is the same demo refactored</a> to allow for customizing the transition when necessary. It uses a custom property for the transition duration, which allows us to toggle the scale transition on and off without having to rewrite the whole declaration.</p>\n<h3>When Removing Animation Is Better</h3>\n<p>Eric Bailey raises the point that “not every device that can access the web can also render animation, or render animation smoothly“ in his article, “<a href=\"https://css-tricks.com/revisiting-prefers-reduced-motion-the-reduced-motion-media-query/\">Revisiting prefers-reduced-motion, the reduced motion media query</a>.” For devices with a low refresh rate, which can cause janky animations, it might in fact be <strong>preferable to remove the animation</strong>. The <code>update</code> media feature can be used to determine this:</p>\n<pre><code>@media screen and\n  (prefers-reduced-motion: reduce), \n  (update: slow) {\n  * {\n    animation-duration: 0.001ms !important;\n    animation-iteration-count: 1 !important;\n    transition-duration: 0.001ms !important;\n  }\n}</code></pre>\n\n<p>Be sure to read the full article for Eric’s recommendations, as he’s a first-rate person to follow in the field of accessibility.</p>\nThe Sum Of All Parts\n<p>It’s important to keep in mind the overall page design when focusing so tightly on component-level CSS. What might seem a fairly innocuous animation at the component level could have a far greater impact when it’s repeated throughout the page, and is one of many moving parts.</p>\n<p>In Tatiana’s article, she suggests organizing animations (with <code>prefers-reduced-motion</code>) in a single CSS file, which can be loaded only if <code>(prefers-reduced-motion: no-preference)</code> evaluates true. Seeing the sum total of all our animations could have the added benefit of helping us <strong>visualize the experience</strong> of visiting the site as a whole, and tailor our reduced-motion styles accordingly.</p>\nExplicit Motion Toggle\n<p>While <code>prefers-reduced-motion</code> is useful, it does have the drawback of only catering to users who are aware of the feature in their system settings. Plenty of users lack knowledge of this setting, while others might be using a borrowed computer, without access to system-level settings. Still, others might be happy with the motion for the vast majority of sites, but find sites with heavy use of motion hard to bear.</p>\n<p>It can be annoying to have to adjust your system preferences just to visit one site. For these reasons, in some cases, it might be preferable to provide an explicit control on the site itself to <strong>toggle motion on and off</strong>. We can implement this with JS.</p>\n<p>The following demo has several circles drifting around the background. The initial animation styles are determined by the user’s system preferences (with <code>prefers-reduced-motion</code>), however, the user has the ability to toggle motion on or off via a button. This adds a class to the <code>body</code>, which we can use to set styles depending on the selected preference. As a bonus, the <strong>choice of motion preference</strong> is also preserved in local storage — so it is “remembered” when the user next visits.</p>\n<p>See the Pen <a href=\"https://codepen.io/smashingmag/pen/porEQLB\">Reduced-motion toggle</a> by <a href=\"https://codepen.io/michellebarker\">Michelle Barker</a>.</p>\n<h3>Custom Properties</h3>\n<p>One feature in the demo is that the toggle sets a custom property, <code>--playState</code>, which we can use to play or pause animations. This could be especially handy if you need to <strong>pause or play a number of animations</strong> at once. First of all, we set the play state to <code>paused</code>:</p>\n<pre><code>.circle {\n  animation-play-state: var(--playState, paused);\n}</code></pre>\n\n<p>If the user has set a preference for reduced motion in their system settings, we can set the play state to <code>running</code>:</p>\n<pre><code>@media (prefers-reduced-motion: no-preference) {\n  body {\n    --playState: running;\n  }\n}</code></pre>\n\n<p><strong>Note:</strong> <em>Setting this on the <code>body</code>, as opposed to the individual element, means the custom property can be inherited.</em></p>\n<p>When the user clicks the toggle, the custom property is updated on the <code>body</code>, which will toggle any instances where it is used:</p>\n<pre><code>// This will pause all animations that use the `--playState` custom property\ndocument.body.style.setProperty('--playState', 'paused')</code></pre>\n\n<p>This might not be the ideal solution in all cases, but one advantage is that the <strong>animation simply pauses</strong> when the user clicks the toggle, rather than jumping back to its initial state, which could be quite jarring.</p>\n<p>Special thanks goes to <a href=\"https://twitter.com/scottohara\">Scott O’Hara</a> for his recommendations for improving the accessibility of the toggle. He made me aware that some screenreaders don’t announce the updated button text, which is changed when a user clicks the button, and suggested <code>role=\"switch\"</code> on the button instead, with <code>aria-checked</code> toggled to <code>on</code> or <code>off</code> on click.</p>\n<h3>Video Component</h3>\n<p>In some instances, toggling motion at the component level might be a better option. Take a webpage with an auto-playing video background. We should ensure the video doesn’t autoplay for users with a preference for reduced motion, but we should still provide a way for them to <strong>play the video only <em>if</em> they choose</strong>. (Some might argue we should avoid auto-playing videos full stop, but we don’t always win that battle!) Likewise, if a video is set to autoplay for users without a stated preference, we should also provide a way for them to pause the video.</p>\n<p>This demo shows how we can <strong>set the autoplay attribute</strong> when the user has no stated motion preference, implementing a custom play/pause button to allow them to also toggle playback, regardless of preference:</p>\n<p>See the Pen <a href=\"https://codepen.io/smashingmag/pen/qBXNjqR\">Video with motion preference</a> by <a href=\"https://codepen.io/michellebarker\">Michelle Barker</a>.</p>\n<p>(I subsequently came upon <a href=\"https://codepen.io/scottohara/pen/bPOoEW\">this post by Scott O‘Hara</a>, detailing this exact use case.)</p>\n<h3>Using The <code>&lt;picture&gt;</code> Element</h3>\n<p>Chris Coyier wrote an <a href=\"https://css-tricks.com/reduced-motion-picture-technique-take-two/\">interesting article</a> combining a couple of techniques to load different media sources depending on the user’s motion preferences. This is pretty cool, as it means that for <strong>users who prefer reduced motion</strong>, the much larger GIF file won’t even be downloaded. The downside, as far as I can see, is that once the file is downloaded, there is no way for the user to switch back to the motion-free alternative.</p>\n<p>I create a modified version of the demo which adds this option. (Switch on <code>reduced-motion</code> in your system preferences to see it in action.) Unfortunately, when toggling between the animated and motion-free options in Chrome, it appears the GIF file is downloaded afresh each time, which isn’t the case in other browsers:</p>\n<p>See the Pen <a href=\"https://codepen.io/smashingmag/pen/porbPXG\">Prefers Reduction Motion Technique PLUS! [forked]</a> by <a href=\"https://codepen.io/michellebarker\">Michelle Barker</a>.</p>\n<p>Still, this technique seems like a more respectful way of displaying GIFs, which can be a source of frustration to users.</p>\nBrowser Support And Final Thoughts\n<p><code>prefers-reduced-motion</code> has excellent support in all modern browsers going back a couple of years. As we’ve seen, by taking a reduced-motion-first approach, non-supporting browsers will simply get a <code>reduced-motion</code> fallback. There’s no reason not to use it today to make your sites more accessible.</p>\n<p>Custom toggles most definitely have a place, and can <strong>vastly improve the experience</strong> for users who aren’t aware of this setting, or what it does. The downside for the user is inconsistency — if every developer is forced to come up with their own solution, the user needs to look for a motion toggle in a different place on every website.</p>\n<p>It feels like the missing layer here is <em>browsers</em>. I’d love to see browsers implement <code>reduced-motion</code> toggles, somewhere easily accessible to the user, so that people know where to find it regardless of the site they’re browsing. It might encourage developers to spend more time ensuring motion accessibility, too.</p>\n<h3>Related Resources</h3>\n<ul>\n<li><a href=\"https://www.w3.org/TR/mediaqueries-5/#prefers-reduced-motion\">Level 5 Media Queries Specification</a>, World Wide Web Consortium (W3C)</li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-reduced-motion\"><code>prefers-reduced-motion</code></a>, MDN Web Docs, Mozilla</li>\n<li><a href=\"https://www.smashingmagazine.com/2020/09/design-reduced-motion-sensitivities/\">Design With Reduced Motion For Motion Sensitivities</a>, Val Head, Smashing Magazine</li>\n<li><a href=\"https://www.tatianamac.com/posts/prefers-reduced-motion/\">Taking A No-Motion-First Approach To Animations</a>, Tatiana Mac</li>\n<li><a href=\"https://css-tricks.com/reduced-motion-picture-technique-take-two/\">Reduced Motion Picture Technique, Take 2</a>, Chris Coyier, CSS-Tricks</li>\n<li><a href=\"https://css-tricks.com/revisiting-prefers-reduced-motion-the-reduced-motion-media-query/\">Revisiting <code>prefers-reduced-motion</code>, The Reduced Motion Media Query</a>, Eric Bailey, CSS-Tricks</li>\n<li><a href=\"https://www.a11ywithlindsey.com/blog/reducing-motion-improve-accessibility\">Reducing Motion To Improve Accessibility</a>, Lindsey Kopacz</li>\n</ul>","author":"","siteTitle":"Articles on Smashing Magazine — For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"0d4f3a6d81c5a7df2b16e06ecb571564e23939b83a63adbdf9a5674fc72f36a4","category":"Tech"}