{"title":"แนวทางการจำลอง external dependency ใน Spring Boot ด้วย WireMock","link":"https://www.somkiat.cc/spring-boot-testing-with-wiremock/","date":1743345389000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2025/03/spring-boot-wiremock-testing-150x150.jpg\" alt=\"\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2025/03/spring-boot-wiremock-testing-150x150.jpg 150w, https://www.somkiat.cc/wp-content/uploads/2025/03/spring-boot-wiremock-testing-75x75.jpg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/03/spring-boot-wiremock-testing.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/03/spring-boot-wiremock-testing-1024x678.jpg\" alt=\"\" width=\"544\" height=\"360\" /></a></figure>\n\n\n\n<p>หลังจากที่แบ่งปันเรื่องการทดสอบระบบงานมานั้น<br />หนึ่งในแนวทางการทดสอบคือ การจำลอง external dependency ของระบบ<br />ไม่ว่าจะเป็น database, messaging และ  REST API เป็นต้น<br />เพื่อควบคุมการทดสอบให้สามารถทดสอบซ้ำได้อย่างต่อเนื่อง<br />ดังนั้นมาดูแนวทางการทดสอบกันหน่อยว่าทำอย่างไร ?</p>\n\n\n\n<span></span>\n\n\n\n<p><strong>ในแต่ละภาษาโปรแกรม และ  framework มีแนวทางคล้าย ๆ  กัน</strong></p>\n\n\n\n<p>ยกตัวอย่างของการจำลอง REST API เช่น</p>\n\n\n\n<ul>\n<li>NodeJS ใช้งาน <a href=\"https://github.com/nock/nock\" target=\"_blank\">Nock</a></li>\n\n\n\n<li>Go ใช้งาน <a href=\"https://github.com/h2non/gock\" target=\"_blank\">Gock</a></li>\n\n\n\n<li>Spring boot ใช้งาน Spring cloud contract และ <a href=\"https://wiremock.org/\" target=\"_blank\">Wiremock</a></li>\n\n\n\n<li>Playwright มี <a href=\"https://playwright.dev/docs/mock\" target=\"_blank\">Mock API</a></li>\n\n\n\n<li>ถ้าใครใช้พวก container-based ก็สามารถใช้ <a href=\"https://testcontainers.com/\" target=\"_blank\">Test containers</a> ได้เลย</li>\n</ul>\n\n\n\n<p>โดยแนวทางเหล่านี้ เราสามารถเขียน code ไว้ใน test case ได้เลย<br />นั่นคือ เมื่อ run test case ต่าง ๆ  แล้ว<br />จะทำการสร้าง Mock server ขึ้นมาให้แบบอัตโนมัติ<br />เมื่อทำการทดสอบเสร็จแล้ว จะทำการลบ Mock server ให้เองทันที</p>\n\n\n\n<p><strong>มาดูตัวอย่างของการใช้งาน WireMock ใน Spring Boot testing กัน</strong></p>\n\n\n\n<ul>\n<li>ทำการจำลอง REST API 3 case คือ success, failure (404) และ ให้ response time 5 วินาที</li>\n</ul>\n\n\n\n[gist id=\"f4f6e52156657385efbaaffc37213a51\" file=\"DemoGatewayTest.java\"]\n\n\n\n<p>ลองนำไปใช้งานกันดู<br />เพื่อช่วยให้การทดสอบทำงานได้รวดเร็ว ทำซ้ำได้ง่าย<br />และช่วยให้นักพัฒนามั่นใจต่อ code ที่สร้างขึ้นมาอีกด้วย<br />ก่อนที่จะทำ integration test ต่อไป</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"a4b5414cf14d057ce486822ec68538046ebf85607719a129027f00df8f281064","category":"Thai"}