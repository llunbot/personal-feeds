{"title":"Maximize accelerator utilization for model development with new Amazon SageMaker HyperPod task governance","link":"https://aws.amazon.com/blogs/aws/maximize-accelerator-utilization-for-model-development-with-new-amazon-sagemaker-hyperpod-task-governance/","date":1733331450000,"content":"<p>Today, we’re announcing the general availability of <a href=\"https://aws.amazon.com/sagemaker/hyperpod/\">Amazon SageMaker HyperPod</a> task governance, a new innovation to easily and centrally manage and maximize GPU and Trainium utilization across <a href=\"https://aws.amazon.com/ai/generative-ai/\">generative AI</a> model development tasks, such as training, fine-tuning, and inference.</p> \n<p>Customers tell us that they’re rapidly increasing investment in generative AI projects, but they face challenges in efficiently allocating limited compute resources. The lack of dynamic, centralized governance for resource allocation leads to inefficiencies, with some projects underutilizing resources while others stall. This situation burdens administrators with constant replanning, causes delays for data scientists and developers, and results in untimely delivery of AI innovations and cost overruns due to inefficient use of resources.</p> \n<p>With SageMaker HyperPod task governance, you can accelerate time to market for AI innovations while avoiding cost overruns due to underutilized compute resources. With a few steps, administrators can set up quotas governing compute resource allocation based on project budgets and task priorities. Data scientists or developers can create tasks such as model training, fine-tuning, or evaluation, which SageMaker HyperPod automatically schedules and executes within allocated quotas.</p> \n<p>SageMaker HyperPod task governance manages resources, automatically freeing up compute from lower-priority tasks when high-priority tasks need immediate attention. It does this by pausing low-priority training tasks, saving checkpoints, and resuming them later when resources become available. Additionally, idle compute within a team’s quota can be automatically used to accelerate another team’s waiting tasks.</p> \n<p>Data scientists and developers can continuously monitor their task queues, view pending tasks, and adjust priorities as needed. Administrators can also monitor and audit scheduled tasks and compute resource usage across teams and projects and, as a result, they can adjust allocations to optimize costs and improve resource availability across the organization. This approach promotes timely completion of critical projects while maximizing resource efficiency.</p> \n<p><strong><u>Getting started with SageMaker HyperPod task governance</u></strong><br /> Task governance is available for <a href=\"https://aws.amazon.com/blogs/machine-learning/introducing-amazon-eks-support-in-amazon-sagemaker-hyperpod/\">Amazon EKS clusters in HyperPod</a>. Find <strong>Cluster Management</strong> under <strong>HyperPod Clusters</strong> in the <a href=\"https://console.aws.amazon.com/sagemaker/home?#/cluster-management\">Amazon SageMaker AI console</a> for provisioning and managing clusters. As an administrator, you can streamline the operation and scaling of HyperPod clusters through this console.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-1-clusters-1.png\" alt=\"\" width=\"2380\" height=\"1004\" /></p> \n<p>When you choose a HyperPod cluster, you can see a new <strong>Dashboard</strong>, <strong>Tasks</strong>, and <strong>Policies</strong> tab in the cluster detail page.</p> \n<p><strong>1. New dashboard</strong><br /> In the new dashboard, you can see an overview of cluster utilization, team-based, and task-based metrics.</p> \n<p>First, you can view both point-in-time and trend-based metrics for critical compute resources, including GPU, vCPU, and memory utilization, across all instance groups.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-2-dashboard-1-1.png\" alt=\"\" width=\"1974\" height=\"2596\" /></p> \n<p>Next, you can gain comprehensive insights into team-specific resource management, focusing on GPU utilization versus compute allocation across teams. You can use customizable filters for teams and cluster instance groups to analyze metrics such as allocated GPUs/CPUs for tasks, borrowed GPUs/CPUs, and GPU/CPU utilization.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/27/2024-sagemaker-hyperpod-task-governance-2-dashboard-2.png\" alt=\"\" width=\"1972\" height=\"3292\" /></p> \n<p>You can also assess task performance and resource allocation efficiency using metrics such as counts of running, pending, and preempted tasks, as well as average task runtime and wait time. To gain comprehensive observability into your SageMaker HyperPod cluster resources and software components, you can integrate with <a href=\"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights.html\">Amazon CloudWatch Container Insights</a> or <a href=\"https://aws.amazon.com/grafana/\">Amazon Managed Grafana</a>.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/27/2024-sagemaker-hyperpod-task-governance-2-dashboard-3.png\" alt=\"\" width=\"1974\" height=\"2098\" /></p> \n<p><strong>2. Create and manage a cluster policy</strong><br /> To enable task prioritization and fair-share resource allocation, you can configure a cluster policy that prioritizes critical workloads and distributes idle compute across teams defined in compute allocations.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-3-policy-2-1.png\" alt=\"\" width=\"1950\" height=\"1976\" /></p> \n<p>To configure priority classes and fair sharing of borrowed compute in cluster settings, choose <strong>Edit</strong> in the <strong>Cluster policy</strong> section.</p> \n<p>You can define how tasks waiting in queue are admitted for task prioritization: <strong>First-come-first-serve</strong> by default or <strong>Task ranking</strong>. When you choose task ranking, tasks waiting in queue will be admitted in the priority order defined in this cluster policy. Tasks of same priority class will be executed on a first-come-first-serve basis.</p> \n<p>You can also configure how idle compute is allocated across teams: <strong>First-come-first-serve</strong> or <strong>Fair-share</strong> by default. The fair-share setting enables teams to borrow idle compute based on their assigned weights, which are configured in relative compute allocations. This enables every team to get a fair share of idle compute to accelerate their waiting tasks.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-3-edit-policy-1.png\" alt=\"\" width=\"1672\" height=\"2058\" /></p> \n<p>In the <strong>Compute allocation</strong> section of the <strong>Policies</strong> page, you can create and edit compute allocations to distribute compute resources among teams, enable settings that allow teams to lend and borrow idle compute, configure preemption of their own low-priority tasks, and assign fair-share weights to teams.</p> \n<p>In the <strong>Team</strong> section, set a team name and a corresponding Kubernetes namespace will be created for your data science and machine learning (ML) teams to use. You can set a fair-share weight for a more equitable distribution of unused capacity across your teams and enable the preemption option based on task priority, allowing higher-priority tasks to preempt lower-priority ones.</p> \n<p>In the <strong>Compute</strong> section, you can add and allocate instance type quotas to teams. Additionally, you can allocate quotas for instance types not yet available in the cluster, allowing for future expansion.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-3-edit-compute-allocation-1.png\" alt=\"\" width=\"1668\" height=\"2998\" /></p> \n<p>You can enable teams to share idle compute resources by allowing them to lend their unused capacity to other teams. This borrowing model is reciprocal: teams can only borrow idle compute if they are also willing to share their own unused resources with others. You can also specify the borrow limit that enables teams to borrow compute resources over their allocated quota.</p> \n<p><strong>3. Run your training task in SageMaker HyperPod cluster</strong><br /> As a data scientist, you can submit a training job and use the quota allocated for your team, using the <a href=\"https://github.com/aws/sagemaker-hyperpod-cli\">HyperPod Command Line Interface (CLI)</a> command. With the HyperPod CLI, you can start a job and specify the corresponding namespace that has the allocation.</p> \n<pre><code>$ hyperpod start-job --name smpv2-llama2 --namespace hyperpod-ns-ml-engineers\nSuccessfully created job smpv2-llama2\n$ hyperpod list-jobs --all-namespaces\n{\n \"jobs\": [\n  {\n   \"Name\": \"smpv2-llama2\",\n   \"Namespace\": \"hyperpod-ns-ml-engineers\",\n   \"CreationTime\": \"2024-09-26T07:13:06Z\",\n   \"State\": \"Running\",\n   \"Priority\": \"fine-tuning-priority\"\n  },\n  ...\n ]\n}</code></pre> \n<p>In the <strong>Tasks</strong> tab, you can see all tasks in your cluster. Each task has different priority and capacity need according to its policy. If you run another task with higher priority, the existing task will be suspended and that task can run first.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/12/02/2024-sagemaker-hyperpod-task-governance-4-run-training-task-1.png\" alt=\"\" width=\"2066\" height=\"894\" /></p> \n<p>OK, now let’s check out a demo video showing what happens when a high-priority training task is added while running a low-priority task.</p> \n<p></p> \n<p>To learn more, visit <a href=\"https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-hyperpod-eks-operate-console-ui-governance.html\">SageMaker HyperPod task governance</a> in the Amazon SageMaker AI Developer Guide.</p> \n<p><u><strong>Now available</strong></u><br /> Amazon SageMaker HyperPod task governance is now available in US East (N. Virginia), US East (Ohio), US West (Oregon) AWS Regions. You can use HyperPod task governance without additional cost. To learn more, visit the <a href=\"https://aws.amazon.com/sagemaker/hyperpod\">SageMaker HyperPod product page</a>.</p> \n<p>Give HyperPod task governance a try in the <a href=\"https://console.aws.amazon.com/sagemaker\">Amazon SageMaker AI console</a> and send feedback to <a href=\"https://repost.aws/tags/TAT80swPyVRPKPcA0rsJYPuA/amazon-sagemaker\">AWS re:Post for SageMaker</a> or through your usual AWS Support contacts.</p> \n<p>— <a href=\"https://twitter.com/channyun\">Channy</a></p> \n<p><em>P.S. Special thanks to <a href=\"https://www.linkedin.com/in/nisha-nadkarni-317594124/\">Nisha Nadkarni</a>, a senior generative AI specialist solutions architect at AWS for her contribution in creating a HyperPod testing environment.</em></p>","author":"Channy Yun (윤석찬)","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"2415f4ede52bf24d4a99e68d0b2c902636cff1b8c32a0983558a0f178dacae55","category":"Tech"}