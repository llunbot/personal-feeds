{"title":"Using Modern Image Formats: AVIF And WebP","link":"https://smashingmagazine.com/2021/09/modern-image-formats-avif-webp/","date":1632903900000,"content":"<p>Images are the <a href=\"https://httparchive.org/reports/state-of-images#reqImg\">most popular</a> resource type on the web and are often the largest. Users appreciate high-quality visuals, but care needs to be taken to deliver those hero images, product photos and cat memes as efficiently and effectively as possible. </p>\n<p>If you’re optimizing for the <a href=\"https://web.dev/vitals/\">Web Vitals</a>, you might be interested to hear that images account for ~<a href=\"https://paulcalvano.com/2021-06-07-lcp-httparchive/\">42%</a> of the <a href=\"https://web.dev/lcp/\">Largest Contentful Paint</a> element for websites. Key <a href=\"https://web.dev/vitals/\">user-centric metrics</a> often depend on the size, number, layout, and loading priority of images on the page. This is why a lot of our guidance on performance talks about image optimization.  </p>\n<p>A tl;dr of recommendations can be found below.</p>\n<blockquote><strong>tl;dr</strong><br /><br />\n<ul>\n<li><a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#avif\">AVIF</a> is a solid first choice if lossy, low-fidelity compression is acceptable and saving bandwidth is the number one priority. Assuming encode/decode speeds meet your needs.</li>\n<li><a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#webp\">WebP</a> is more widely supported and may be used for rendering regular images where advanced features like wide color gamut or text overlays are not required.</li>\n<li>AVIF may not be able to compress non-photographic images as well as PNG or lossless WebP. Compression savings from WebP may be lower than JPEG for high-fidelity lossy compression.</li>\n<li>If both AVIF and WebP are not viable options, consider evaluating MozJPEG (optimize JPEG images), OxiPNG (non-photographic images), or JPEG 2000 (lossy or lossless photographic images).</li>\n<li><a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#progressive-enhancement\">Progressive enhancement</a> via <code>&lt;picture&gt;</code> lets the browser choose the first supported format in the order of preference. This implementation is considerably simplified when using image CDN’s where the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept\">Accept Header</a> and content negotiation (e.g. auto-format and quality) can serve the best image.</li></ul></blockquote>\n\nWhy Do We Need Modern Formats?\n<p>We have a reasonably wide selection of image formats to choose from when rendering images on the web. The essential difference between image formats is that the image codec used to encode or decode each image type is different. An image codec represents the algorithm used to compress and encode images to a specific file type and decode them for display on the screen.</p>\n<h3>Evaluating Codecs</h3>\n<p>You can evaluate which image format is suitable for you based on different parameters.</p>\n<ul>\n<li><strong>Compression</strong><br />The efficiency of a codec can be mainly measured by how much compression it can achieve. Compression achieved is relevant because the higher the compression, the smaller the file size, and the lower the data required to transfer the image on the network. Smaller file size directly impacts the Largest contentful Paint (LCP) metric for the page as image resources needed by the page get loaded faster.</li>\n<li><strong>Quality</strong><br />Ideally, compression should not result in any loss of image data; it should be lossless. Compression formats that result in some loss of image data, thereby reducing the quality of the image, are known as lossy. You may use tools like <a href=\"https://github.com/kornelski/dssim\">DSSIM</a> or <a href=\"https://github.com/cloudinary/ssimulacra\">ssimulacra</a> to measure the <a href=\"https://en.wikipedia.org/wiki/Structural_similarity\">structural similarity</a> between images and judge if the loss in quality is acceptable.</li>\n<li><strong>Encode/Decode Speed</strong><br />Complex compression algorithms may require higher processing power to encode/decode images. This can be complicated by whether encoding is being done ahead of time (static/build) or on-the-fly (on-demand). While encoding may be one-time in the case of static images, the browser still has to decode images before rendering them. A complex decoding process can slow down the rendering of images.</li>\n</ul>\n<p>Degree of compression, image quality, and decoding speed are key factors to be considered when comparing image performance for the web. Specific use cases may require image formats that support other features like:</p>\n<ul>\n<li>Software support: An image format may perform very well but is useless if browsers, CDN’s and other image manipulation tools do not recognize it.</li>\n<li>Animation support may be required for some images on the web (e.g., GIF). However, you should ideally replace such images with <a href=\"https://web.dev/replace-gifs-with-videos/\">videos</a>.</li>\n<li>Alpha Transparency: The ability to create images with different opacity levels using the alpha channel. (e.g., PNG images with transparent backgrounds) </li>\n<li>It should support <a href=\"https://w3c.github.io/ColorWeb-CG/\">High dynamic range(HDR) imaging and wide color gamut</a>.</li>\n<li>Progressive decoding to load images gradually allows users to get a reasonable preview of the image before it gets refined.</li>\n<li>Depth maps that will enable you to apply effects to the foreground or background of the image. </li>\n<li>Images with multiple overlapping layers, for example, text overlays, borders, and so on.</li>\n</ul>\n<p><strong>Tip:</strong> <em>When evaluating quality, compression and fine-tuning of modern formats, <a href=\"https://squoosh.app/\">Squoosh.app</a>’s ability to perform a visual side-by-side comparison is helpful. Zooming in allows you to better appreciate where a format exhibits blockiness or edge-artifacts to reason about trade-offs.</em></p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/d64452e0-f3a6-46be-a86a-579efdc0aacf/1-modern-image-formats.png\" /></p>\nThe Old Guards: JPEG And PNG\n<p>JPEG has been the most widely supported image format for 25 years. Classic JPEG encoders lead to relatively weak compression, while more modern JPEG encoding efforts (like <a href=\"https://github.com/mozilla/mozjpeg\">MozJPEG</a>) improve compression but are not quite as optimal as modern formats. JPEG is also a lossy compression format. While decoding speed for JPEGs is excellent, it lacks other desirable features required of images on modern, eye-catching websites. It does not support transparency in images, animation, depth maps, or overlays. </p>\n<p>JPEG works best with photographs, while PNG is its counterpart for other still images. PNG is a lossless format and can support alpha transparency, but the compression achieved, especially for photographs, is considerably low. JPEG and PNG are both used extensively depending on the type of image required.</p>\n<p>The target for modern image formats is thus to overcome the limitations of JPEG and PNG by offering better compression and flexibility to support the other features discussed earlier. With this background, let us look at what AVIF and WebP have to offer.</p>\nAVIF\n<p>The AV1 image file format (AVIF) is an open-source image format for storing still and animated images. It was released in February 2019 by the <a href=\"https://aomedia.org/\">Alliance for Open Media</a> (AOMedia). AVIF is the image version of the popular AV1 video format. The goal was to develop a new open-source video coding format that is both state-of-the-art and royalty-free. </p>\n<h3>AVIF Benefits</h3>\n<p>AVIF supports very efficient lossy and lossless compression to produce high-quality images after compression AVIF compresses much better than most popular formats on the web today (JPEG, WebP, JPEG 2000, and so on). Images can be up to ten times smaller than JPEGs of similar visual quality. Some tests have shown that AVIF offers a 50% saving in file size compared to JPEG with <strong>similar perceptual quality</strong>. Note that there can be cases where WebP lossless can be better than AVIF lossless, so do be sure to manually evaluate.</p>\n<p>Here, you can see a size comparison between a JPEG image and its corresponding (lossy) AVIF image converted using the <a href=\"https://squoosh.app/\">Squoosh</a> app:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/96da1cce-5594-4fd1-89c9-4edb5608903c/12-modern-image-formats.png\" /></p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/982f3a59-ec9a-401c-a6a6-6400f400e9a9/sqoosh-zoomed-in.png\" /></p>\n<p>In addition to superior compression, AVIF also provides the following features:</p>\n<ul>\n<li>AVIF supports animations, live photos, and more through multilayer images stored in image sequences.</li>\n<li>It offers better support for graphical elements, logos, and infographics, where JPEG has limitations.</li>\n<li>It provides better lossless compression than JPEG.</li>\n<li>It supports twelve bits of color depth enabling high dynamic range (HDR) and wide color gamut (WCG) images with a better span of bright and dark tones and a broader range of luminosity.</li>\n<li>It includes support for monochrome images and multichannel images, including transparent images that use the alpha channel.</li>\n</ul>\nComparing Formats\n<p>To better understand the differences in quality and compression offered by the different formats, we can visually compare images and evaluate the differences.</p>\n<h3>Evaluating Quality And Compression</h3>\n<p>We will begin our quality evaluation of JPEG, WebP, and AVIF using the default high-quality output settings of Squoosh for each format — intentionally untuned to mimic a new user’s experience with them. As a reminder, you should aim to evaluate the quality configuration and formats that best suit your needs. If you’re short on time, image CDNs automate some of this.</p>\n<p>In this first test, encoding a 560KB photo of a sunset (with many textures) produces an image that is visually and perceptually quite similar for each. The output comes in at 289KB (JPEG@q75), 206KB (WebP@q75), and 101KB (AVIF@q30) — up to 81% in compression savings.</p>\n<p>Great stuff, but let’s dig deeper.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/ab37fe06-0aad-4c2f-8295-013363a84257/18-modern-image-formats.png\" /></p>\n<p>For a more extreme example of the differences between JPEG and AVIF, we can look at an example from the Kodak dataset (<a href=\"https://netflixtechblog.com/avif-for-next-generation-image-coding-b1d75675fe4\">evaluated</a> by Netflix) comparing a JPEG (4:4:4) at 20KB to an AVIF (4:4:4) at 19.8KB. Notice how the JPEG has visible blocky artifacts in the sky and roof. The AVIF is visibly better, containing fewer blocking artifacts. There is, however, a level of texture loss on the roof and some blurriness. It’s still quite impressive, given the overall compression factor is 59x.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/27e2710d-1598-4566-8568-5e500b73db2b/11-modern-image-formats.png\" /></p>\n<p>To include an AVIF image on your page, you can add it as an image element. However, browsers that do not support AVIF cannot render this image.</p>\n<pre><code>&lt;img src=\"/images/sky.avif\" width=\"360\" height=\"240\" alt=\"a beautiful sky\"&gt;</code></pre>\n\n<p>A workaround to ensure that at least one supported image format is delivered to all browsers is to apply AVIF as a <strong>progressive enhancement</strong>. There are two ways to do this.</p>\n<h5>Progressive Enhancement</h5>\n<ol>\n<li><strong>Using The <code>&lt;picture&gt;</code> Element</strong><br />As <code>&lt;picture&gt;</code> allows browsers to skip images they do not recognize, you can include images in your order of preference. The browser selects the first one it supports.</li>\n</ol>\n<pre><code>&lt;picture&gt;\n &lt;source srcset=\"img/photo.avif\" type=\"image/avif\"&gt;\n &lt;source srcset=\"img/photo.webp\" type=\"image/webp\"&gt;\n &lt;img src=\"img/photo.jpg\" alt=\"Description\" width=\"360\" height=\"240\"&gt;\n&lt;/picture&gt;</code></pre>\n\n<ol>\n<li><strong>Using Content Negotiation</strong><br /><a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation\">Content negotiation</a> allows the server to serve different resource formats based on what is supported by the browser. Browsers that support a specific format can announce it by adding the format to their <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept\">Accept</a> Request Header. E.g., the Accept Request Header for images in Chrome is:<br /><code>Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8</code><br />The code to check if AVIF is supported in the fetch event handler can look something like this:<br /><code>const hdrAccept = event.request.headers.get(\"accept\");</code><br /><code>const sendAVIF = /image\\/avif/.test(hdrAccept);</code><br />You can use this value to serve AVIF or any other default format to the client.</li>\n</ol>\n<p>Creating the markup for progressive enhancement can be daunting. Image CDN’s offer the option to automatically serve the best format suitable to the client. However, if you are not using an image CDN, you can consider using a tool like <a href=\"https://just-gimme-an-img.vercel.app/\">just-gimme-an-img</a>. This tool can generate the markup for the picture element for a given image with different formats and widths. It also creates the images corresponding to the markup using Squoosh entirely client-side. Note: encoding multiple formats can take a while using it, so you might want to grab a coffee while you wait.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/3a90fb79-0aa4-4858-995c-f311b3f7a24b/14-modern-image-formats.png\" /></p>\n<p><strong>Note:</strong> <em>Image CDNs are mentioned a few times in this article. CDN servers are often located closer to users than origin servers and can have a <a href=\"https://web.dev/content-delivery-networks/\">shorter round-trip times</a> (RTT), improving network latency. That said, serving from a different origin can add round-trips and impact performance gains. This may be fine if the CDN is serving other site content, but when in doubt, experiment and measure.</em></p>\n<h4>Encode And Decode AVIF Files</h4>\n<p>Several open-source projects provide different methods to encode/decode AVIF files:</p>\n<ul>\n<li><strong>Libraries</strong><br /><a href=\"https://aomedia.googlesource.com/aom/\">Libaom</a> is the open-source encoder and decoder maintained by AOMedia, the creators of AVIF. The library is continuously updated with new optimizations that aim to reduce the cost of encoding AVIF, especially for frequently loaded or high-priority images. <a href=\"https://github.com/AOMediaCodec/libavif\">Libavif</a> is an open-source muxer and parser for AVIF used in Chrome for decoding AVIF images. You can use libavif with libaom to create AVIF files from original uncompressed images or transcode them from other formats. There is also <a href=\"https://github.com/strukturag/libheif\">Libheif</a>, a popular AVIF/HEIF encoder/decoder and <a href=\"https://github.com/kornelski/cavif-rs\">Cavif</a>. Thanks to Ben Morss, <a href=\"https://libgd.github.io/\">libgd</a> supports AVIF and is also coming to PHP in November.</li>\n<li><strong>Web Apps And Desktop Apps</strong><br /><a href=\"https://squoosh.app\">Squoosh</a>, a web app that lets you use different image compressors, also supports AVIF, making it relatively straightforward to convert and create <code>.avif</code> files online. On desktop, <a href=\"https://www.gimp.org/\">GIMP</a> <a href=\"https://avif.io/blog/tutorials/gimp/\">supports AVIF exporting</a>. ImageMagick and <a href=\"https://forums.getpaint.net/\">Paint.net</a> also support AVIF while Photoshop community <a href=\"https://github.com/0xC0000054/avif-format\">plugins for AVIF</a> are also available.</li>\n<li><strong>JavaScript Libraries</strong>  <ul>\n<li><a href=\"https://github.com/Kagami/avif.js\">AVIF.js</a> is an AVIF polyfill for browsers that do not support AVIF yet. It uses Service Worker API to intercept the fetch event and decode AVIF files.</li>\n<li><a href=\"https://avif.io/\">Avif.io</a> is another web utility that can convert files from different image types to AVIF on the <a href=\"https://github.com/justinschmitz97/avif.io/\">client-side</a>. It calls Rust code in the browser using a WebWorker. The converter library is compiled to WASM using wasm-pack.</li>\n<li><a href=\"https://sharp.pixelplumbing.com/\">Sharp</a> is a Node.js module that can convert large images in standard formats to smaller web-friendly images, including AVIF images. </li>\n</ul>\n</li>\n<li><strong>Utilities</strong><br />Image conversion or transformation utilities support the AVIF format. You can use <a href=\"https://github.com/gpac/gpac/wiki/MP4Box\">MP4Box</a> to create and decode AVIF files.</li>\n<li><strong>In Code</strong><br /><a href=\"https://github.com/Kagami/go-avif\"><code>go-avif</code></a> implements an AVIF encoder for Go using <code>libaom</code>. It comes with a utility called <code>avif</code> which can encode JPEG or PNG files to AVIF.</li>\n</ul>\n<p>Anyone interested in learning how to create AVIF images using Squoosh or building the command line encoder <a href=\"https://github.com/AOMediaCodec/libavif/blob/master/apps/avifenc.c\"><code>avifenc</code></a> can do so at the codelab on <a href=\"https://codelabs.developers.google.com/codelabs/avif#2\">serving AVIF files</a>.</p>\n<h3>AVIF And Performance</h3>\n<p>AVIF can reduce the file size of images due to better compression. As a result, AVIF files download faster and consume lower bandwidth. This can potentially improve performance by reducing the time to load images.</p>\n<p>Lighthouse-best practices audit now considers that AVIF image compression can bring significant improvements. It collects all the BMP, JPEG, and PNG images on the page, converts them to WebP and estimates the AVIF file size. This estimate helps Lighthouse report the potential savings under the “Serve images in next-gen formats” section.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/6383da02-0562-46f6-802f-c8dfb3c05ca5/9-modern-image-formats.png\" /></p>\n<p><a href=\"https://twitter.com/TimVereecke/status/1372210487191085063\">Tim Vereecke</a> reported 25% byte savings and a positive impact on LCP (compared to JPEG) after converting 14 million images on the website to AVIF measured using Real User Monitoring (RUM).</p>\n<h3>AVIF Gotchas</h3>\n<p>The biggest drawback for AVIF at present is that it lacks uniform support across browsers. Introducing AVIF as a <a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#avif-tooling-and-support\">progressive</a> enhancement helps overcome this. A few other aspects in which AVIF does not meet the ideal standards for a modern file format.</p>\n<ul>\n<li>Modern versions of Chrome (Chrome 94+) <a href=\"https://bugs.chromium.org/p/chromium/issues/detail?id=1221717\">do support AVIF progressive rendering</a> while older versions do not. While at the time of writing there isn’t an encoder that can make these images easily, there is hope this will change. </li>\n<li>AVIF images take longer to encode and create. This could be a problem for sites that create images files dynamically. However, the AVIF team is working on improving encoding speeds. AVIF contributors at Google have also reported some nice performance gains. Since Jan 1st 2021, AVIF encoding had a ~47% improvement in transcode time (this is speed 6, the current default for libavif) and across the calendar year a 73% improvement. Since July, there’s also been a 72% improvement in transcode times at speed 9 (on-the-fly-encoding).</li>\n</ul>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/3272f1d2-d85d-416d-88a9-63008f2f30bc/16-modern-image-formats.png\" /></p>\n<ul>\n<li>Decoding AVIF images for display can also take up more CPU power than other codecs, though smaller file sizes may compensate for this.</li>\n<li>Some CDNs do not yet support AVIF by default for their automatic format modes because it can still be slower to generate on the first request.</li>\n</ul>\nWebP\n<p>We have mentioned WebP a few times, but let’s briefly cover its history. Google created the WebP format in 2011 as an image format that would help to make the web faster. Over the years, it has been accepted and adopted widely because of its ability to compress images to lower file sizes compared to JPEG and PNG. WebP offers both lossless and lossy compression at an acceptable visual quality and supports alpha-channel transparency and animation.</p>\n<p>Lossy WebP compression is based on the <a href=\"http://static.googleusercontent.com/media/research.google.com/en/us/pubs/archive/37073.pdf\">VP8</a> video codec and uses predictive encoding to encode an image. It uses values in the neighboring blocks of pixels to predict the value in a block and encodes only the difference. <a href=\"https://developers.google.com/speed/webp/docs/compression#lossless_webp\">Lossless WebP</a> images are generated by applying multiple transformation techniques to images to compress them. </p>\n<h3>WebP Benefits</h3>\n<p>WebP lossless images are generally 26% smaller than PNG, and WebP lossy images are 25–34% smaller than JPEG images of similar quality. Animation support makes them an excellent replacement for GIF images as well. The following shows a transparent PNG image on the left and the corresponding WebP image on the right generated by the Squoosh app with a 26% size reduction.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/6570876c-99cc-4522-8491-c60125c74e39/8-modern-image-formats.png\" /></p>\n<p>Additionally, WebP offers other benefits like:</p>\n<ul>\n<li><strong>Transparency</strong><br />WebP has a lossless 8-bit transparency channel with only 22% more bytes than PNG. It also supports lossy RGB transparency, which is a feature unique to WebP.</li>\n<li><strong>Metadata</strong><br />The WebP file format supports EXIF photo metadata and Extensible Metadata Platform (XMP) digital document metadata. It may also contain an ICC color profile.</li>\n<li><strong>Animation</strong><br />WebP supports true-color animated images.</li>\n</ul>\n<p><strong>Note:</strong> <em>In the case of transparent, vector-like images such as the above, an optimized SVG may ultimately deliver a sharper, smaller file compared to a raster format.</em></p>\n<h3>WebP Tooling And Support</h3>\n<p>Over the years, ecosystems other than Google have adopted WebP, and there are many tools available to create, view and load WebP files.</p>\n<h4>Serving And Viewing WebP Files</h4>\n<p>WebP is supported on the latest versions of almost all major browsers today.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/53671dd1-89ba-47b7-b6cc-af3be817c87a/13-modern-image-formats.png\" /></p>\n<p>If developers wish to serve WebP on other browsers in the future, they can do so using the <code>&lt;picture&gt;</code> element or request headers as shown in the section on <a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#avif-tooling-and-support\">AVIF</a>. </p>\n<p>Image Content Delivery Networks (CDN) also support <a href=\"https://cloudinary.com/documentation/responsive_images#responsive_images_with_automatic_format_selection\">responsive images</a> with automatic format selection for images in WebP or AVIF depending on the browser support. WebP plug-ins are available for other popular stacks like <a href=\"https://wordpress.org/plugins/search/convert+webp/\">WordPress</a>, <a href=\"https://extensions.joomla.org/instant-search/?jed_live%5Bquery%5D=webp\">Joomla</a>, <a href=\"https://www.drupal.org/project/project_module?f%5B0%5D=&amp;f%5B1%5D=&amp;f%5B2%5D=&amp;f%5B3%5D=&amp;f%5B4%5D=sm_field_project_type%3Afull&amp;f%5B5%5D=&amp;f%5B6%5D=&amp;text=webp&amp;solrsort=iss_project_release_usage+desc&amp;op=Search\">Drupal</a>, etc. Initial support for WebP is also available in <a href=\"https://make.wordpress.org/core/2021/06/07/wordpress-5-8-adds-webp-support/\">WordPress core</a>, starting with WordPress 5.8.</p>\n<p>You can view WebP images easily by opening them in a browser that supports them. Additionally, you can also preview them on Windows and macOS using an add-on. Installing the <a href=\"https://github.com/Nyx0uf/qlImageSize\">Quick Look plug-in for WebP</a> (<code>qlImageSize</code>) would allow you to preview WebP files using the Quick Look utility. The WebP team has published <a href=\"https://developers.google.com/speed/webp/download\">precompiled</a> libraries and utilities for the WebP codec for Windows, macOS, and Linux. Using these on Windows allows you to preview WebP images in File Explorer or Windows Photo Viewer.</p>\n<p><strong>Converting images to WebP</strong></p>\n<p>In addition to the libraries provided by the WebP team, several free, open-source, and commercial image editing tools support WebP.</p>\n<p><strong>Utilities:</strong><br />Like AVIF, Squoosh can also convert files to WebP online, as shown in the <a href=\"https://www.smashingmagazine.com/2021/09/modern-image-formats-avif-webp/#why-do-we-need-modern-formats\">previous section</a>. <a href=\"https://www.xnview.com/en/xnconvert/\">XnConvert</a> is a utility that you can install on the desktop to convert different image formats, including WebP. XnConvert can also help with stripping and editing metadata, cropping and resizing, brightness and contrast, customizing color depth, blurring and sharpening, masks and watermarks, and other transforms.</p>\n<p><strong>Node.js Modules:</strong><br /><a href=\"https://github.com/imagemin/imagemin\">Imagemin</a> is a popular image minification module with an add-on for converting images to WebP (<a href=\"https://github.com/imagemin/imagemin-webp\">imagemin-webp</a>). The add-on supports both lossy and lossless WebP modes.</p>\n<p><strong>Others:</strong><br />Several apps for image conversion and manipulation support the WebP format. These include <a href=\"https://www.sketch.com/\">Sketch</a>, <a href=\"https://www.gimp.org/\">GIMP</a>, <a href=\"https://imagemagick.org/\">ImageMagick</a>, etc. A <a href=\"https://github.com/webmproject/WebPShop\">Photoshop plug-in for WebP</a> is also available.    </p>\n<h3>WebP Production Usage</h3>\n<p>Due to its compression benefits over JPEG and PNG, Many large companies use WebP in production to reduce costs and decrease web page load times. Google reports 30–35% savings using WebP over other lossy compression schemes, serving 43 billion image requests a day, 26% of those being lossless compression. </p>\n<p>To reach its large user base in emerging markets where data is expensive, Facebook started serving WebP images to Android users. They <a href=\"https://engineering.fb.com/2014/06/19/android/improving-facebook-on-android/\">observed</a>, “data savings of 25 to 35 percent compared with JPG, and 80 percent compared with PNG”. </p>\n<h3>WebP Gotchas</h3>\n<p>In its early days, a substantial downside with WebP was the lack of browser and tooling support. There are still few trade-offs with WebP when considering all the features a modern format should ideally support. </p>\n<ul>\n<li>WebP is limited to 8-bit color precision. As a result, it cannot support HDR/wide gamut images.</li>\n<li>WebP does not support lossy images without chroma subsampling. Lossy WebP works exclusively with an 8-bit YCbCr 4:2:0, while lossless WebP works with the RGBA format. This can affect images with fine details, chromatic textures, or colored text. See below for an example.</li>\n<li>It does not support progressive decoding, however does support <a href=\"https://developers.google.com/speed/webp/faq#does_webp_support_progressive_or_interlaced_display\">incremental decoding</a>. This can somewhat compensate for that, but the effect on rendering can be different.</li>\n</ul>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/1edb68f4-ee79-426e-b90c-a32830e6e98d/5-modern-image-formats.png\" /></p>\n<p>You should ideally generate WebP files from the best quality source files available. Converting substandard JPEGs to WebP’s is not very efficient since you lose on quality twice.  </p>\nSummary\n<p>Summarizing all the information about the four formats JPEG, PNG, AVIF, and WebP and comparing and quantifying strengths and weaknesses as presented in the previous section, we have come up with the following table.</p>\n<p><strong>Note:</strong> <em>The number of stars is based on a general opinion and may differ for specific use cases.</em></p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/b3e168f7-0c9a-46dc-be3d-bd379be6ad7b/modern-image-formats-3.png\" /></p>\n<p>Following are some of the key points to be considered when referring to this table.</p>\n<ul>\n<li>Compression for photographic and non-photographic images may further differ based on the fidelity (quality) of the images. We have indicated an overall score here.</li>\n<li>You should choose quality and chroma subsampling settings based on the purpose of the images. Low to medium-fidelity images may be acceptable in most scenarios on the web, e.g., for news, social media, and e-commerce. Image archival, movie, or photography websites require high fidelity images. You should test the actual savings due to compression for high fidelity before converting to another format.</li>\n<li>Lack of progressive decoding support and speed may be a problem for encoding/decoding AVIF files. For websites with average-sized images, the byte savings due to compression can compensate for speed and the absence of progressive decoding as images get downloaded quickly.</li>\n<li>When comparing compression offered by image formats, compare file sizes at the <a href=\"https://www.ctrl.blog/entry/webp-avif-comparison.html#section-results\">same DSSIM</a>. </li>\n<li>The quality setting used when encoding need not be the same for different formats to yield the same quality of images. A JPEG encoded at a quality setting of 60 may be similar to an AVIF at a quality setting of 50 and a WebP at a quality setting of 65, as suggested by this <a href=\"https://www.industrialempathy.com/posts/avif-webp-quality-settings/\">post</a>.</li>\n<li>Extensive studies are still required to measure the actual impact on LCP when comparing formats.</li>\n<li>We have not included other formats like JPEG XL and HEIC in this comparison. JPEG XL is still in a relatively nascent stage, and only Apple devices support HEIC (while Safari does not). Royalty and license fees further complicate support for HEIC.</li>\n</ul>\n<p>AVIF does check most of the boxes overall, and WebP has better support and offers better compression when compared to JPEG or PNG. As such, you should undoubtedly consider WebP support when optimizing images on your website. Evaluating AVIF if it meets your requirements and introducing it as a progressive enhancement could provide value as the format gets adopted across different browsers and platforms. With quality comparison tooling and improving encoding speeds using AVIF would ultimately get easier.</p>\n<p><em>With thanks to Leena Sohoni-Kasture for her heavy input into this article as well as Patrick Meenan, Frank Galligan and Yoav Weiss for their reviews.</em></p>\nA Smashing Note\n<p>Earlier this year, we published a brand new book with Addy on everything you need to know to optimize how you compress, serve and maintain images — boosting performance along the way. We are <strong>shipping the books for free worldwide</strong>, and if you <a href=\"/printed-books/image-optimization/\">get the book now</a>, you will also receive a <strong>hand-written postcard</strong> by Addy with a personal message.</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/16be6d44-974d-4700-977b-a2a700fa90f6/picture-perfect-front-opt.jpeg\" /></p>\n<ul>\n<li><a href=\"#about-the-book\">Jump to the details ↓</a></li>\n<li><a href=\"http://provide.smashingmagazine.com/eBooks/image-optimization-sample-chapter.pdf\">Download a free PDF sample</a> (12MB)</li>\n<li><strong>Free worldwide airmail shipping</strong> for printed books.\n</li><li><strong><a href=\"/printed-books/image-optimization/\">Get the book right away.</a></strong></li>\n</ul>\n\n\n    <a href=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/b41ae541-7618-44f2-81cd-cc681c64d0d0/image-optimization-header.png\">\n    <img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/b41ae541-7618-44f2-81cd-cc681c64d0d0/image-optimization-header.png\" />\n    </a>","author":"","siteTitle":"Articles on Smashing Magazine — For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"af5ef11d6848994fda4ba8f3dd080894da8d759f2125076f10344f9f91db5ade","category":"Tech"}