{"title":"สรุปการแก้ไขปัญหา Log4j จาก Spring","link":"https://www.somkiat.cc/fix-log4j-from-spring/","date":1639288450000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>December 12, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Apache-Log4j-Logo-1024x576.jpg\" alt=\"\" width=\"560\" height=\"315\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Apache-Log4j-Logo-1024x576.jpg 1024w, https://www.somkiat.cc/wp-content/uploads/2021/12/Apache-Log4j-Logo-300x169.jpg 300w, https://www.somkiat.cc/wp-content/uploads/2021/12/Apache-Log4j-Logo-768x432.jpg 768w, https://www.somkiat.cc/wp-content/uploads/2021/12/Apache-Log4j-Logo.jpg 1200w\" sizes=\"(max-width: 560px) 100vw, 560px\"></figure><p>จากปัญหาของ Log4j core ที่มีช่องโหว่ในการโจมตี จาก <a rel=\"noreferrer noopener\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44228\" target=\"_blank\">CVE-2021-44228</a><br>ซึ่งทาง <strong><a rel=\"noreferrer noopener\" href=\"https://spring.io/blog/2021/12/10/log4j2-vulnerability-and-spring-boot\" target=\"_blank\">Spring</a></strong> ได้ออกมาอธิบาย<br>รวมทั้งวิธีการตรวจสอบ แก้ไขต่าง ๆ ไว้ดังนี้</p><p>หลัก ๆ ปัญหานี้ถูกแก้ไขแล้วใน <a rel=\"noreferrer noopener\" href=\"https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-core/2.15.0/\" target=\"_blank\">Log4J version 2.15.0</a></p><p><strong><em>สำหรับคนที่ใช้งาน Spring Boot แบบ default ในการพัฒนา<br>จะไม่ได้รับผลกระทบ เพราะว่าไม่ได้ใช้งาน Log4j-core นั่นเอง</em></strong></p><p>แต่ถ้าใครเปลี่ยน <a href=\"https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto.logging.log4j\" target=\"_blank\" rel=\"noreferrer noopener\">default logging มาเป็น Log4j</a><br>แน่นอนว่าได้รับผลกระทบแน่นอน<br>ซึ่งจำเป็นต้อง upgrade ไปใช้ log4j version 2.15.0</p><p><strong>สำหรับ project ที่ใช้งานผ่าน Apache Maven</strong><br>ให้ทำการตรวจสอบ version ของ log4j ดังนี้</p><div id=\"highlighter_668134\"><table><tbody><tr><td><p>1</p></td><td><div><p><code>mvn dependency:list | grep log4j</code></p></div></td></tr></tbody></table></div><p><strong>ส่วน Gradle ก็ตรวจสอบดังนี้</strong></p><div id=\"highlighter_955241\"><table><tbody><tr><td><p>1</p></td><td><div><p><code>gradle dependencyInsight --dependency log4j-core</code></p></div></td></tr></tbody></table></div><p><strong>สำหรับ project ที่ไม่สามารถแก้ไข code หรือ dependency ได้</strong></p><p>ก็ให้แก้ไข environment variable ในไฟล์ property</p><div id=\"highlighter_227526\"><table><tbody><tr><td><p>1</p></td><td><div><p><code>log4j2.formatMsgNoLookups=true</code></p></div></td></tr></tbody></table></div><p>หรือใน environment variable ดังนี้</p><div id=\"highlighter_809881\"><table><tbody><tr><td><p>1</p></td><td><div><p><code>java -Dlog4j2.formatMsgNoLookups=true -jar myapp.jar</code></p></div></td></tr></tbody></table></div></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"8e43201752ce223aee9f097a237ca6816dec5f17bf4f23a0bd1d2730c3a392af","category":"Thai"}