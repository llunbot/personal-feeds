{"title":"[RaspberryPi] ทำ Kiosk โดยใช้ Raspberry Pi + Chromium browser","link":"https://thanapon.info/raspberrypi-kiosk/","date":1632757501000,"content":"<p>ก่อนอื่นเราต้องลง Image Rasbian OS Desktop ก่อน โดยที่ผมจะใช้ตัว <a href=\"https://www.raspberrypi.org/software/\" target=\"_blank\">Raspberry Pi Imager</a> ในการสร้าง Kiosk นะครับ ซึ่งในตัว Image นี้ได้ติดตั้ง Chromium browser กับ LXDE อยู่แล้วนะครับ</p>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/image.png\" /></figure></div>\n\n\n\n<h2>ตั้งค่า Raspberry Pi OS ให้เปิด browser อัตโนมัติ</h2>\n\n\n\n<ul><li>ก่อนอื่นเข้าไปตั้งค่า LXDE โดยที่เราจะไปแก้ script ตอนที่มัน boot ระบบขึ้นมาตอนแรก</li></ul>\n\n\n\n<div><pre><code>sudo nano /etc/xdg/lxsession/LXDE-pi/autostart</code></pre></div>\n\n\n\n<ul><li>เพิ่ม command ข้างล่างนี้ไปเลย</li></ul>\n\n\n\n<blockquote><p>@xscreensaver -no-splash : </p><p>@xset s off : ปิด screensaver</p><p><span>@xset -dpms : </span>ปิดระบบ power management</p><p>@xset s noblank : ปิด screen blanking</p><p>@chromium-browser –kiosk –disable-restore-session-state &lt;url&gt; : เปิด chormium ใน kiosk mode</p></blockquote>\n\n\n\n<div><pre><code>@lxpanel --profile LXDE-pi\n@pcmanfm --desktop --profile LXDE-pi\n@xscreensaver -no-splash\n@xset s off\n@xset -dpms\n@xset s noblank\n@chromium-browser --kiosk  --disable-restore-session-state http://localhost:3000</code></pre></div>\n\n\n\n<ul><li>จากนั้นก็ทำการ save config file</li></ul>\n\n\n\n<h2>ตั้งค่า Raspi-config สำหรับ Boot ผ่าน Console</h2>\n\n\n\n<ul><li>อันดับแรกให้เข้ามาที่ Raspi-config ก่อนผ่าน terminal เพื่อที่จะตั้งค่า network connection ตอนที่ boot ครั้งแรกโดยที่จะให้มันรอรับ IP Address ก่อน</li></ul>\n\n\n\n<div><pre><code>sudo raspbi-config</code></pre></div>\n\n\n\n<ul><li>เลือกเมนู System Options</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/32e34a67-cbb6-40a9-a557-02f1659ffcf7.png\" /></figure></div>\n\n\n\n<ul><li>เลือก Network at Boot</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/0e0b5fee-a770-4f9f-8d33-64b90c8d6648.png\" /></figure></div>\n\n\n\n<ul><li>จากนั้นเลือก S5 Boot/Auto Login แล้วเลือก B2 Console Autologin เพื่อให้ตอนที่เรา boot ระบบขึ้นมามันจะได้ skip หน้าที่ให้กรอก username/password</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/304ecae3-6384-4339-b4c1-5e28d253c380.png\" /></figure></div>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/71e8c243-dfa8-460f-ae7c-ffe4f645d04f.png\" /></figure></div>\n\n\n\n<ul><li>แล้วก็ Back ออกมาโดยกดปุ่ม Tab ไล่ลงมาเรื่อยๆ แล้วเลือก Finish ระบบจะ restart เครื่องใหม่</li></ul>\n\n\n\n<h2>ตั้งค่า Bash profile ให้รัน X Server ทุกครั้งหลังจาก Login</h2>\n\n\n\n<ul><li>สร้างไฟล์  bash_profile มาก่อนโดยจะเก็บไว้ที่ home</li></ul>\n\n\n\n<div><pre><code>sudo nano ~/.bash_profile</code></pre></div>\n\n\n\n<ul><li>เพิ่ม script สำหรับรัน X server โดยเพิ่ม flag nocursor เข้าไปเพื่อให้มันซ่อน mouse cursor</li></ul>\n\n\n\n<div><pre><code>startx -- -nocursor</code></pre></div>\n\n\n\n<ul><li>บันทึก bash_profile โดยกด <strong>Ctrl-o</strong><span> =&gt; </span><strong>Enter</strong><span> =&gt; </span><strong>Ctrl-X</strong><span>.</span></li><li>ทดสอบรัน bash_profile จากนั้นก็ระบบก็จะ login เข้าสู่หน้า Desktop mode</li></ul>\n\n\n\n<div><pre><code>source ~/.bash_profile</code></pre></div>\n\n\n\n<ul><li>reboot ระบบอีกครั้งแล้วรอดูผลลัพท์ได้เลยครับ</li></ul>\n\n\n\n<div><pre><code>sudo reboot</code></pre></div>\n\n\n\n<blockquote><p>วิธีออกไปหน้า console เราจะกด Ctrl + Alt + F1/F2 เพื่อ Switch mode นะครับ</p></blockquote>\n\n\n\n<h1>[Optional] การหมุนหน้าจอใน Desktop mode </h1>\n\n\n\n<ul><li>แก้ไขไฟล์ /boot/config.txt</li></ul>\n\n\n\n<div><pre><code>sudo nano /boot/config.txt</code></pre></div>\n\n\n\n<blockquote><p>0 is the normal configuration. 1 is 90 degrees. 2 is 180 degress. 3 is 270 degrees.</p><p>If you are using the Official Raspberry Pi touch screen you can use “lcd_rotate” rather than “display_rotate”.</p><p>Save the file by using CTRL-X, Y then ENTER.</p></blockquote>\n\n\n\n<ul><li>Comment “dtoverlay=vc4-fkms-v3d” ออกไว้ด้วยนะครับเพราะมันจะต้องกลับไปใช้ Legacy mode ก่อน แล้วเพิ่ม display_rotate เข้าไปได้เลย</li></ul>\n\n\n\n<div><pre><code>[pi4]\n# Enable DRM VC4 V3D driver on top of the dispmanx display stack\n#dtoverlay=vc4-fkms-v3d\nmax_framebuffers=1\n\n[all]\n#dtoverlay=vc4-fkms-v3d\ngpu_mem=256\ndisplay_rotate=3</code></pre></div>\n\n\n\n<ul><li>เสร็จแล้วก็ Reboot กันอีกรอบก็จะได้หน้าตาแบบนี้มา (อันนี้เป็นตัวอย่างนะครับ ผมรัน web server ไว้ให้มัน generate QRCode ออกมา)</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/09/242834340_421221472735958_3354533217175125399_n.png\" /></figure></div>\n\n\n\n<p>เสร็จเรียบร้อย หากมีข้อสงสัยหรืออยากแนะนำมีอะไรเจ๋งๆ สามารถติดต่อมาที่ Facebook หรือ  Linkedin ได้เลยนะครับ สำหรับวันนี้ขอบคุณและสวัสดีครับ <img src=\"https://s.w.org/images/core/emoji/13.1.0/72x72/1f609.png\" /></p>\n<p>The post <a href=\"https://thanapon.info/raspberrypi-kiosk/\">[RaspberryPi] ทำ Kiosk โดยใช้ Raspberry Pi + Chromium browser</a> appeared first on <a href=\"https://thanapon.info\">Thanapon</a>.</p>","author":"thanapon.tap","siteTitle":"Thanapon","siteHash":"6a039c2f54d76e4c49227d80968f2a30de5427cc57525c047c383ea3563cde5f","entryHash":"f8239609e8d0f4d3f42e5002b511ae0d387b20cc07969e7b183d0816b9d188de","category":"Thai"}