{"title":"สวัสดี Fuzzing test ใน Go 1.18","link":"https://www.somkiat.cc/fuzzing-test-in-go/","date":1639374188000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>December 13, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19-1024x554.png\" alt=\"\" width=\"547\" height=\"295\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19-1024x554.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19-300x162.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19-768x415.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19-1536x831.png 1536w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.38.19.png 1856w\" sizes=\"(max-width: 547px) 100vw, 547px\"></figure><p>ใน Go 1.18 นั้น จะมีความสามารถใหม่ ๆ ที่น่าสนใจเพิ่มเข้ามา เช่น</p><ul><li>Type parameters (Generic)</li><li><a href=\"https://www.somkiat.cc/go-workspace/\" target=\"_blank\" rel=\"noreferrer noopener\">Workspace</a></li><li>Fuzzing test</li></ul><p>โดยสิ่งที่จะอธิบายใน blog นี้คือ <strong><a href=\"https://pkg.go.dev/testing@master#hdr-Fuzzing\" target=\"_blank\" rel=\"noreferrer noopener\">Fuzzing test</a></strong><br>เพิ่มเข้ามาใน testing library นั่นเอง<br>แน่นอนว่ายังเป็น <a href=\"https://go.dev/blog/fuzz-beta\" target=\"_blank\" rel=\"noreferrer noopener\">beta version</a> อยู่</p><p><strong>ความสามารถหลัก ๆ ของ Fuzzing test คือ</strong></p><p>ช่วยทำการสร้าง input แบบ random ขึ้นมา<br>ตาม type ของ method ที่ทดสอบผ่าน unit test นั่นเอง<br>ทำให้ลดปัญหาเรื่อง edge case ที่นักพัฒนาอาจจะพลาดไปได้เยอะ<br>ทำให้มี data test ที่หลากหลาย รวมทั้งเรื่องของ security อีกด้วย<br>ซึ่งบางคนอาจจะเคยได้ยินเรื่อง Mutation testing<br>ดังนั้น Fuzzing test น่าจะมีประโยชน์มาก ๆ สำหรับนักพัฒนา<br>มาลองใช้งานกันดีกว่า</p><p><strong>จากเอกสารของ Go นั้น เราเพียงใช้ prefix ของ test case ชื่อว่า Fuzz</strong></p><div itemprop=\"text\" id=\"gist113567586\" translate=\"no\"><template><div data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg> <span>This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. <a href=\"https://github.co/hiddenchars\" target=\"_blank\">Learn more about bidirectional Unicode characters</a></span><div data-view-component=\"true\" class=\"flash-action\"><a href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\">Show hidden characters</a></div></div></template><template><span aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"bidi-line-alert tooltipped tooltipped-e\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg></span></template><table data-tab-size=\"8\" data-paste-markdown-skip=\"\" data-tagsearch-lang=\"Go\" data-tagsearch-path=\"1.go\"><tbody><tr><td id=\"file-1-go-L1\" data-line-number=\"1\"></td><td id=\"file-1-go-LC1\"><span>func</span> <span>FuzzAdd</span>(<span>f</span> <span>*</span>testing.<span>F</span>) {</td></tr><tr><td id=\"file-1-go-L2\" data-line-number=\"2\"></td><td id=\"file-1-go-LC2\"><span>// Seed input หรือไม่จำเป็นต้องมี จะเป็นค่า default ที่ Fuzzing จัดการ random ให้เอง</span></td></tr><tr><td id=\"file-1-go-L3\" data-line-number=\"3\"></td><td id=\"file-1-go-LC3\"><span>f</span>.<span>Add</span>(<span>1</span>,<span>2</span>)</td></tr><tr><td id=\"file-1-go-L4\" data-line-number=\"4\"></td><td id=\"file-1-go-LC4\"><span>// Run fuzzing test</span></td></tr><tr><td id=\"file-1-go-L5\" data-line-number=\"5\"></td><td id=\"file-1-go-LC5\"><span>f</span>.<span>Fuzz</span>(<span>func</span>(<span>t</span> <span>*</span>testing.<span>T</span>, <span>a</span> <span>int</span>, <span>b</span> <span>int</span>) {</td></tr><tr><td id=\"file-1-go-L6\" data-line-number=\"6\"></td><td id=\"file-1-go-LC6\"><span>demo</span>.<span>Add</span>(<span>a</span>,<span>b</span>)</td></tr><tr><td id=\"file-1-go-L7\" data-line-number=\"7\"></td><td id=\"file-1-go-LC7\">})</td></tr><tr><td id=\"file-1-go-L8\" data-line-number=\"8\"></td><td id=\"file-1-go-LC8\">}</td></tr></tbody></table></div><p><strong>ในการ run test นั้นก็ใช้งานผ่าน go test เหมือนเดิม ดังนี้</strong></p><p>แน่นอนใช้เวลาในการ run นาน<br>เพราะว่า จะทดสอบแบบ sub-test ซึ่งมี test case จำนวนมาก ๆ</p><div itemprop=\"text\" id=\"gist113567586\" translate=\"no\"><template><div data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg> <span>This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. <a href=\"https://github.co/hiddenchars\" target=\"_blank\">Learn more about bidirectional Unicode characters</a></span><div data-view-component=\"true\" class=\"flash-action\"><a href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\">Show hidden characters</a></div></div></template><template><span aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"bidi-line-alert tooltipped tooltipped-e\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg></span></template><table data-tab-size=\"8\" data-paste-markdown-skip=\"\" data-tagsearch-lang=\"Text\" data-tagsearch-path=\"1.txt\"><tbody><tr><td id=\"file-1-txt-L1\" data-line-number=\"1\"></td><td id=\"file-1-txt-LC1\">$gotip test -fuzz=Fuzz</td></tr><tr><td id=\"file-1-txt-L2\" data-line-number=\"2\"></td><td id=\"file-1-txt-LC2\"></td></tr><tr><td id=\"file-1-txt-L3\" data-line-number=\"3\"></td><td id=\"file-1-txt-LC3\">fuzz: elapsed: 0s, gathering baseline coverage: 0/1 completed</td></tr><tr><td id=\"file-1-txt-L4\" data-line-number=\"4\"></td><td id=\"file-1-txt-LC4\">fuzz: elapsed: 0s, gathering baseline coverage: 1/1 completed, now fuzzing with 8 workers</td></tr><tr><td id=\"file-1-txt-L5\" data-line-number=\"5\"></td><td id=\"file-1-txt-LC5\">fuzz: elapsed: 3s, execs: 480216 (160023/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L6\" data-line-number=\"6\"></td><td id=\"file-1-txt-LC6\">fuzz: elapsed: 6s, execs: 912366 (144046/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L7\" data-line-number=\"7\"></td><td id=\"file-1-txt-LC7\">fuzz: elapsed: 9s, execs: 1287578 (125105/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L8\" data-line-number=\"8\"></td><td id=\"file-1-txt-LC8\">fuzz: elapsed: 12s, execs: 1646734 (119720/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L9\" data-line-number=\"9\"></td><td id=\"file-1-txt-LC9\">fuzz: elapsed: 15s, execs: 2029499 (127573/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L10\" data-line-number=\"10\"></td><td id=\"file-1-txt-LC10\">fuzz: elapsed: 18s, execs: 2315231 (95251/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L11\" data-line-number=\"11\"></td><td id=\"file-1-txt-LC11\">fuzz: elapsed: 21s, execs: 2654756 (113182/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L12\" data-line-number=\"12\"></td><td id=\"file-1-txt-LC12\">fuzz: elapsed: 24s, execs: 2952964 (99404/sec), new interesting: 0 (total: 0)</td></tr><tr><td id=\"file-1-txt-L13\" data-line-number=\"13\"></td><td id=\"file-1-txt-LC13\">fuzz: elapsed: 27s, execs: 3326314 (124438/sec), new interesting: 0 (total: 0)</td></tr></tbody></table></div><p>แถม CPU นี่พุ่งปรี๊ดมาก ๆ</p><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29-1024x456.png\" alt=\"\" width=\"387\" height=\"172\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29-1024x456.png 1024w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29-300x134.png 300w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29-768x342.png 768w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29-1536x685.png 1536w, https://www.somkiat.cc/wp-content/uploads/2021/12/Screen-Shot-2564-12-13-at-12.34.29.png 1696w\" sizes=\"(max-width: 387px) 100vw, 387px\"></figure><p>ลองศึกษาและใช้งานกันดูครับ<br>ให้ทำหลังจากทดสอบ function การทำงานปกติผ่านแล้วนะครับ</p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"487342070cb99b16134a0f9ffbb44feff9f8a87bace258cfc33950644c3db91d","category":"Thai"}