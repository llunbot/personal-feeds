{"title":"Apple Silicon Vulnerability Allows Hackers to Extract Encryption Keys","link":"https://www.macrumors.com/2024/03/22/apple-silicon-vulnerability-encryption-keys/","date":1711109992000,"content":"An unpatchable vulnerability has been discovered in Apple's M-series chips that allows attackers to extract secret encryption keys from Macs under certain conditions, according to a newly published <a href=\"https://gofetch.fail/files/gofetch.pdf\">academic research paper</a> (via <em><a href=\"https://arstechnica.com/security/2024/03/hackers-can-extract-secret-encryption-keys-from-apples-mac-chips/\">ArsTechnica</a></em>).\r<br />\n\r<br />\n<img src=\"https://images.macrumors.com/article-new/2022/07/m1-vs-m2-air-feature-toned-down.jpg\" width=\"2112\" height=\"1188\" />\r<br />\nNamed \"<a href=\"https://gofetch.fail\">GoFetch</a>,\" the type of cyber attack described involves Data Memory-Dependent Prefetchers (DMPs), which try to predict what data the computer will need next and retrieve it in advance. This is meant to make processing faster, but it can unintentionally reveal information about what the computer is doing.\r<br />\n\r<br />\nThe paper finds that DMPs, especially the ones in Apple's processors, pose a significant threat to the security provided by constant-time programming models, which are used to write programs so that they take the same amount of time to run, no matter what data they're dealing with.\r<br />\n\r<br />\nThe constant-time programming model is meant to protect against side-channel attacks, or types of attacks where someone can gain sensitive information from a computer system without directly accessing it (by observing certain patterns, for example). The idea is that if all operations take the same amount of time, there's less for an attacker to observe and exploit.  \r<br />\n\r<br />\nHowever, the paper finds that DMPs, particularly in Apple silicon, can leak information even if the program is designed not to reveal any patterns in how it accesses memory. The new research finds that the DMPs can sometimes confuse memory content, which causes it to treat the data as an address to perform memory access, which goes against the constant-time model.\r<br />\n\r<br />\nThe authors present GoFetch as a new type of attack that can exploit this vulnerability in DMPs to extract encryption keys from secure software. The attack works against some popular encryption algorithms that are thought to be resistant to side-channel attacks, including both traditional (e.g. OpenSSL Diffie-Hellman Key Exchange, Go RSA decryption) and post-quantum (e.g. CRYSTALS-Kyber and CRYSTALS-Dilithium) cryptographic methods.\r<br />\n\r<br />\nIn an email to <em>ArsTechnica</em>, the authors explained:\r<br />\n<blockquote>Prefetchers usually look at addresses of accessed data (ignoring values of accessed data) and try to guess future addresses that might be useful. The DMP is different in this sense as in addition to addresses it also uses the data values in order to make predictions (predict addresses to go to and prefetch). In particular, if a data value \"looks like\" a pointer, it will be treated as an \"address\" (where in fact it's actually not!) and the data from this \"address\" will be brought to the cache. The arrival of this address into the cache is visible, leaking over cache side channels.\r<br />\n\r<br />\nOur attack exploits this fact. We cannot leak encryption keys directly, but what we can do is manipulate intermediate data inside the encryption algorithm to look like a pointer via a chosen input attack. The DMP then sees that the data value \"looks like\" an address, and brings the data from this \"address\" into the cache, which leaks the \"address.\" We don't care about the data value being prefetched, but the fact that the intermediate data looked like an address is visible via a cache channel and is sufficient to reveal the secret key over time.</blockquote>In summary, the paper shows that the DMP feature in Apple silicon CPUs could be used to bypass security measures in cryptography software that were thought to protect against such leaks, potentially allowing attackers to access sensitive information, such as a 2048-bit RSA key, in some cases in less than an hour. \r<br />\n\r<br />\nAccording to the authors, the flaw in Apple's chips cannot be patched directly. Instead, the attack vector can only be reduced by building defenses into third-party cryptographic software that could result in an extreme performance degradation when executing the cryptographic operations, particularly on the earlier <a href=\"https://www.macrumors.com/guide/m1/\">M1</a> and <a href=\"https://www.macrumors.com/guide/m2/\">M2</a> chips. The DMP on the M3, Apple's latest chip, has a special bit that developers can invoke to disable it, but the researchers aren't yet sure what kind of penalty will occur when this performance optimization is turned off. \r<br />\n\r<br />\nAs <em>ArsTechnica</em> notes, this isn't the first time researchers have identified threats in Apple DMPs. Research documented in 2022 discovered one such threat in both the ‌M1‌ and Apple's A14 Bionic chip for iPhones, which resulted in the \"<a href=\"https://www.prefetchers.info/about/\">Augury</a>\" attack. However, this attack was ultimately unable to extract the sensitive data when constant-time practices were used.\r<br />\n<blockquote>\"GoFetch shows that the DMP is significantly more aggressive than previously thought and thus poses a much greater security risk,\" the researchers claim on their website. \"Specifically, we find that any value loaded from memory is a candidate for being dereferenced (literally!). This allows us to sidestep many of Augury's limitations and demonstrate end-to-end attacks on real constant-time code.\"</blockquote>DMP-style attacks are not common, and typically require physical access to a Mac. The researchers informed Apple of the vulnerability in December 2023, and users concerned about the vulnerability are advised to check for GoFetch mitigation updates that become available in future macOS updates for any of the encryption protocols known to be vulnerable. Apple representatives declined to comment on the record when <em>ArsTechnica</em> asked about the paper.<div>Tags: <a href=\"https://www.macrumors.com/guide/apple-security/\">Apple Security</a>, <a href=\"https://www.macrumors.com/guide/encryption/\">Encryption</a>, <a href=\"https://www.macrumors.com/guide/apple-silicon/\">Apple Silicon</a></div><br />This article, \"<a href=\"https://www.macrumors.com/2024/03/22/apple-silicon-vulnerability-encryption-keys/\">Apple Silicon Vulnerability Allows Hackers to Extract Encryption Keys</a>\" first appeared on <a href=\"https://www.macrumors.com\">MacRumors.com</a><br /><br /><a href=\"https://forums.macrumors.com/threads/apple-silicon-vulnerability-allows-hackers-to-extract-encryption-keys.2422535/\">Discuss this article</a> in our forums<br /><br />","author":"Tim Hardwick","siteTitle":"MacRumors: Mac News and Rumors - All Stories","siteHash":"4c0f1b1ecc2ed084c9f5be50f1058e33a55cdf9b904dadc33a2071fc2d63e8c1","entryHash":"fc000a6b00693d5ad887ce8ce51fdb45a1349c1132b28ba53b3e108742813fcc","category":"Apple"}