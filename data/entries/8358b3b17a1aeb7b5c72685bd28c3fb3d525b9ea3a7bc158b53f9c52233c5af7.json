{"title":"Smashing Animations Part 6: Magnificent SVGs With `<use>` And CSS Custom Properties","link":"https://smashingmagazine.com/2025/11/smashing-animations-part-6-svgs-css-custom-properties/","date":1762527600000,"content":"<p>I explained recently how I use <code>&lt;symbol&gt;</code>, <code>&lt;use&gt;</code>, and CSS Media Queries to develop what I call <a href=\"https://www.smashingmagazine.com/2025/10/smashing-animations-part-5-building-adaptive-svgs/\">adaptive SVGs</a>. Symbols let us define an element once and then <em>use</em> it again and again, making SVG animations easier to maintain, more efficient, and lightweight.</p>\n<p>Since I wrote that explanation, I’ve designed and implemented new <a href=\"https://stuffandnonsense.co.uk/blog/say-hello-to-my-magnificent-7\">Magnificent 7</a> animated graphics across <a href=\"https://stuffandnonsense.co.uk/\">my website</a>. They play on the web design pioneer theme, featuring seven magnificent Old West characters.</p>\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/1-graphics-old-west-characters.png\" /></p>\n<p><code>&lt;symbol&gt;</code> and <code>&lt;use&gt;</code> let me define a character design and reuse it across multiple SVGs and pages. First, I created my characters and put each into a <code>&lt;symbol&gt;</code> inside a hidden library SVG:</p>\n<div>\n<pre><code>&lt;!-- Symbols library --&gt;\n&lt;svg xmlns=\"<a href=\"http://www.w3.org/2000/svg&quot;\">http://www.w3.org/2000/svg\"</a> style=\"display:none;\"&gt;\n &lt;symbol id=\"outlaw-1\"&gt;[...]&lt;/symbol&gt;\n &lt;symbol id=\"outlaw-2\"&gt;[...]&lt;/symbol&gt;\n &lt;symbol id=\"outlaw-3\"&gt;[...]&lt;/symbol&gt;\n &lt;!-- etc. --&gt;\n&lt;/svg&gt;\n</code></pre>\n</div>\n\n<p>Then, I referenced those symbols in two other SVGs, one for large and the other for small screens:</p>\n<pre><code>&lt;!-- Large screens --&gt;\n&lt;svg xmlns=\"http://www.w3.org/2000/svg\" id=\"svg-large\"&gt;\n &lt;use href=\"outlaw-1\" /&gt;\n &lt;!-- ... --&gt;\n&lt;/svg&gt;\n\n&lt;!-- Small screens --&gt;\n&lt;svg xmlns=\"http://www.w3.org/2000/svg\" id=\"svg-small\"&gt;\n &lt;use href=\"outlaw-1\" /&gt;\n &lt;!-- ... --&gt;\n&lt;/svg&gt;\n</code></pre>\n\n<p>Elegant. But then came the infuriating. I could reuse the characters, but couldn’t animate or style them. I added CSS rules targeting elements within the symbols referenced by a <code>&lt;use&gt;</code>, but nothing happened. Colours stayed the same, and things that should move stayed static. It felt like I’d run into an invisible barrier, and I had.</p>\nUnderstanding The Shadow DOM Barrier\n<p>When you reference the contents of a <code>symbol</code> with <code>use</code>, a browser creates a copy of it in the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_shadow_DOM\">Shadow DOM</a>. Each <code>&lt;use&gt;</code> instance becomes its own encapsulated copy of the referenced <code>&lt;symbol&gt;</code>, meaning that CSS from outside can’t break through the barrier to style any elements directly. For example, in normal circumstances, this <code>tapping</code> value triggers a CSS animation:</p>\n<pre><code>&lt;g class=\"outlaw-1-foot tapping\"&gt;\n &lt;!-- ... --&gt;\n&lt;/g&gt;\n</code></pre>\n\n<pre><code>.tapping {\n  animation: tapping 1s ease-in-out infinite;\n}\n</code></pre>\n\n<p>But when the same animation is applied to a <code>&lt;use&gt;</code> instance of that same foot, nothing happens:</p>\n<pre><code>&lt;symbol id=\"outlaw-1\"&gt;\n &lt;g class=\"outlaw-1-foot\"&gt;&lt;!-- ... --&gt;&lt;/g&gt;\n&lt;/symbol&gt;\n\n&lt;use href=\"#outlaw-1\" class=\"tapping\" /&gt;\n</code></pre>\n\n<pre><code>.tapping {\n  animation: tapping 1s ease-in-out infinite;\n}\n</code></pre>\n\n<p>That’s because the <code>&lt;g&gt;</code> inside the <code>&lt;symbol&gt;</code> element is in a protected shadow tree, and the CSS Cascade stops dead at the <code>&lt;use&gt;</code> boundary. This behaviour can be frustrating, but it’s intentional as it ensures that reused symbol content stays consistent and predictable.</p>\n<p>While learning how to develop adaptive SVGs, I found all kinds of attempts to work around this behaviour, but most of them sacrificed the reusability that makes SVG so elegant. I didn’t want to duplicate my characters just to make them blink at different times. I wanted a single <code>&lt;symbol&gt;</code> with instances that have their own timings and expressions.</p>\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/2-animated-elements-single-svg-symbol.png\" /></p>\nCSS Custom Properties To The Rescue\n<p>While working on my pioneer animations, I learned that <strong>regular CSS values can’t cross the boundary into the Shadow DOM, but CSS Custom Properties can</strong>. And even though you can’t directly style elements inside a <code>&lt;symbol&gt;</code>, you can pass custom property values to them. So, when you insert custom properties into an inline style, a browser looks at the cascade, and those styles become available to elements inside the <code>&lt;symbol&gt;</code> being referenced. </p>\n<p>I added <code>rotate</code> to an inline style applied to the <code>&lt;symbol&gt;</code> content:</p>\n<pre><code>&lt;symbol id=\"outlaw-1\"&gt;\n  &lt;g class=\"outlaw-1-foot\" style=\"\n    transform-origin: bottom right; \n    transform-box: fill-box; \n    transform: rotate(var(--foot-rotate));\"&gt;\n    &lt;!-- ... --&gt;\n  &lt;/g&gt;\n&lt;/symbol&gt;\n</code></pre>\n\n<p>Then, defined the foot tapping animation and applied it to the element:</p>\n<pre><code>@keyframes tapping {\n  0%, 60%, 100% { --foot-rotate: 0deg; }\n  20% { --foot-rotate: -5deg; }\n  40% { --foot-rotate: 2deg; }\n}\n\nuse[data-outlaw=\"1\"] {\n  --foot-rotate: 0deg;\n  animation: tapping 1s ease-in-out infinite;\n}\n</code></pre>\n\nPassing Multiple Values To A Symbol\n<p>Once I’ve set up a symbol to use CSS Custom Properties, I can pass as many values as I want to any <code>&lt;use&gt;</code> instance. For example, I might define variables for <code>fill</code>, <code>opacity</code>, or <code>transform</code>. What’s elegant is that each <code>&lt;symbol&gt;</code> instance can then have its own set of values.</p>\n<pre><code>&lt;g class=\"eyelids\" style=\"\n  fill: var(--eyelids-colour, #f7bea1);\n  opacity: var(--eyelids-opacity, 1);\n  transform: var(--eyelids-scale, 0);\"\n&gt;\n  &lt;!-- etc. --&gt;\n&lt;/g&gt;\n</code></pre>\n\n<pre><code>use[data-outlaw=\"1\"] {\n  --eyelids-colour: #f7bea1; \n  --eyelids-opacity: 1;\n}\n\nuse[data-outlaw=\"2\"] {\n  --eyelids-colour: #ba7e5e; \n  --eyelids-opacity: 0;\n}\n</code></pre>\n\n<p>Support for passing CSS Custom Properties like this is solid, and every contemporary browser handles this behaviour correctly. Let me show you a few ways I’ve been using this technique, starting with a multi-coloured icon system.</p>\nA Multi-Coloured Icon System\n<p>When I need to maintain a set of icons, I can define an icon once inside a <code>&lt;symbol&gt;</code> and then use custom properties to apply colours and effects. Instead of needing to duplicate SVGs for every theme, each <code>use</code> can carry its own values.</p>\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/3-custom-properties-colours.png\" /></p>\n<p>For example, I applied an <code>--icon-fill</code> custom property for the default <code>fill</code> colour of the <code>&lt;path&gt;</code> in this Bluesky icon :</p>\n<pre><code>&lt;symbol id=\"icon-bluesky\"&gt;\n  &lt;path fill=\"var(--icon-fill, currentColor)\" d=\"...\" /&gt;\n&lt;/symbol&gt;\n</code></pre>\n\n<p>Then, whenever I need to vary how that icon looks — for example, in a <code>&lt;header&gt;</code> and <code>&lt;footer&gt;</code> — I can pass new <code>fill</code> colour values to each instance:</p>\n<pre><code>&lt;header&gt;\n  &lt;svg xmlns=\"http://www.w3.org/2000/svg\"&gt;\n    &lt;use href=\"#icon-bluesky\" style=\"--icon-fill: #2d373b;\" /&gt;\n  &lt;/svg&gt;\n&lt;/header&gt;\n\n&lt;footer&gt;\n  &lt;svg xmlns=\"http://www.w3.org/2000/svg\"&gt;\n    &lt;use href=\"#icon-bluesky\" style=\"--icon-fill: #590d1a;\" /&gt;\n  &lt;/svg&gt;\n&lt;/footer&gt;\n</code></pre>\n\n<p>These icons are the same shape but look different thanks to their inline styles.</p>\nData Visualisations With CSS Custom Properties\n<p>We can use <code>&lt;symbol&gt;</code> and <code>&lt;use&gt;</code> in plenty more practical ways. They’re also helpful for creating lightweight data visualisations, so imagine an infographic about three famous <a href=\"https://en.wikipedia.org/wiki/American_frontier\">Wild West</a> sheriffs: <a href=\"https://en.wikipedia.org/wiki/Wyatt_Earp\">Wyatt Earp</a>, <a href=\"https://en.wikipedia.org/wiki/Pat_Garrett\">Pat Garrett</a>, and <a href=\"https://en.wikipedia.org/wiki/Bat_Masterson\">Bat Masterson</a>.</p>\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/4-data-visualisations-css-custom-properties.png\" /></p>\n<p>Each sheriff’s profile uses the same set of SVG three symbols: one for a bar representing the length of a sheriff’s career, another to represent the number of arrests made, and one more for the number of kills. Passing custom property values to each <code>&lt;use&gt;</code> instance can vary the bar lengths, arrests scale, and kills colour without duplicating SVGs. I first created symbols for those items:</p>\n<pre><code>&lt;svg xmlns=\"http://www.w3.org/2000/svg\" style=\"display:none;\"&gt;\n  &lt;symbol id=\"career-bar\"&gt;\n    &lt;rect\n      height=\"10\"\n      width=\"var(--career-length, 100)\" \n      fill=\"var(--career-colour, #f7bea1)\"\n    /&gt;\n  &lt;/symbol&gt;\n\n  &lt;symbol id=\"arrests-badge\"&gt;\n    &lt;path \n      fill=\"var(--arrest-color, #d0985f)\" \n      transform=\"scale(var(--arrest-scale, 1))\"\n    /&gt;\n  &lt;/symbol&gt;\n\n  &lt;symbol id=\"kills-icon\"&gt;\n    &lt;path fill=\"var(--kill-colour, #769099)\" /&gt;\n  &lt;/symbol&gt;\n&lt;/svg&gt;\n</code></pre>\n\n<p>Each symbol accepts one or more values:</p>\n<ul>\n<li><strong><code>--career-length</code></strong> adjusts the <code>width</code> of the career bar.</li>\n<li><strong><code>--career-colour</code></strong> changes the <code>fill</code> colour of that bar.</li>\n<li><strong><code>--arrest-scale</code></strong> controls the arrest badge size.</li>\n<li><strong><code>--kill-colour</code></strong> defines the <code>fill</code> colour of the kill icon.</li>\n</ul>\n<p>I can use these to develop a profile of each sheriff using <code>&lt;use&gt;</code> elements with different inline styles, starting with Wyatt Earp.</p>\n<div>\n<pre><code>&lt;svg xmlns=\"<a href=\"http://www.w3.org/2000/svg&quot;\">http://www.w3.org/2000/svg\"</a>&gt;\n  &lt;g id=\"wyatt-earp\"&gt;\n    &lt;use href=\"#career-bar\" style=\"--career-length: 400; --career-color: #769099;\"/&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;!-- ... --&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 1;\" /&gt;\n    &lt;use href=\"#kills-icon\" style=\"--kill-color: #769099;\" /&gt;\n  &lt;/g&gt;\n\n  &lt;g id=\"pat-garrett\"&gt;\n    &lt;use href=\"#career-bar\" style=\"--career-length: 300; --career-color: #f7bea1;\"/&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;!-- ... --&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 1;\" /&gt;\n    &lt;use href=\"#kills-icon\" style=\"--kill-color: #f7bea1;\" /&gt;\n  &lt;/g&gt;\n\n  &lt;g id=\"bat-masterson\"&gt;\n    &lt;use href=\"#career-bar\" style=\"--career-length: 200; --career-color: #c2d1d6;\"/&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;!-- ... --&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 2;\" /&gt;\n    &lt;use href=\"#arrests-badge\" style=\"--arrest-scale: 1;\" /&gt;\n    &lt;use href=\"#kills-icon\" style=\"--kill-color: #c2d1d6;\" /&gt;\n  &lt;/g&gt;\n&lt;/svg&gt;\n</code></pre>\n</div>\n\n<p>Each <code>&lt;use&gt;</code> shares the same symbol elements, but the inline variables change their colours and sizes. I can even animate those values to highlight their differences:</p>\n<pre><code>@keyframes pulse {\n  0%, 100% { --arrest-scale: 1; }\n  50% { --arrest-scale: 1.2; }\n}\n\nuse[href=\"#arrests-badge\"]:hover {\n  animation: pulse 1s ease-in-out infinite;\n}\n</code></pre>\n\n\n<p>CSS Custom Properties aren’t only helpful for styling; they can also channel data between HTML and SVG’s inner geometry, binding visual attributes like colour, length, and scale to semantics like arrest numbers, career length, and kills.</p>\nAmbient Animations\n<p>I started learning to animate elements within symbols while creating the animated graphics for my website’s Magnificent 7. To reduce complexity and make my code lighter and more maintainable, I needed to define each character once and reuse it across SVGs:</p>\n<div>\n<pre><code>&lt;!-- Symbols library --&gt;\n&lt;svg xmlns=\"<a href=\"http://www.w3.org/2000/svg&quot;\">http://www.w3.org/2000/svg\"</a> style=\"display:none;\"&gt;\n  &lt;symbol id=\"outlaw-1\"&gt;[…]&lt;/symbol&gt;\n  &lt;!-- ... --&gt;\n&lt;/svg&gt;\n\n&lt;!-- Large screens --&gt;\n&lt;svg xmlns=\"<a href=\"http://www.w3.org/2000/svg&quot;\">http://www.w3.org/2000/svg\"</a> id=\"svg-large\"&gt;\n  &lt;use href=\"outlaw-1\" /&gt;\n  &lt;!-- ... --&gt;\n&lt;/svg&gt;\n\n&lt;!-- Small screens --&gt;\n&lt;svg xmlns=\"<a href=\"http://www.w3.org/2000/svg&quot;\">http://www.w3.org/2000/svg\"</a> id=\"svg-small\"&gt;\n  &lt;use href=\"outlaw-1\" /&gt;\n  &lt;!-- ... --&gt;\n&lt;/svg&gt;\n</code></pre>\n</div>\n\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/5-characters.png\" /></p>\n<p>But I didn’t want those characters to stay static; I needed subtle movements that would bring them to life. I wanted their eyes to blink, their feet to tap, and their moustache whiskers to twitch. So, to animate these details, I pass animation data to elements inside those symbols using CSS Custom Properties, starting with the blinking. </p>\n<p>I implemented the blinking effect by placing an SVG group over the outlaws’ eyes and then changing its <code>opacity</code>. </p>\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/6-blinking-effect.png\" /></p>\n<p>To make this possible, I added an inline style with a CSS Custom Property to the group:</p>\n<div>\n<pre><code>&lt;symbol id=\"outlaw-1\" viewBox=\"0 0 712 2552\"&gt;\n &lt;g class=\"eyelids\" style=\"opacity: var(--eyelids-opacity, 1);\"&gt;\n    &lt;!-- ... --&gt;\n  &lt;/g&gt;\n&lt;/symbol&gt;\n</code></pre>\n</div>\n\n<p>Then, I defined the blinking animation by changing <code>--eyelids-opacity</code>:</p>\n<pre><code>@keyframes blink {\n  0%, 92% { --eyelids-opacity: 0; }\n  93%, 94% { --eyelids-opacity: 1; }\n  95%, 97% { --eyelids-opacity: 0.1; }\n  98%, 100% { --eyelids-opacity: 0; }\n}\n</code></pre>\n\n<p>…and applied it to every character:</p>\n<div>\n<pre><code>use[data-outlaw] {\n  --blink-duration: 4s;\n  --eyelids-opacity: 1;\n  animation: blink var(--blink-duration) infinite var(--blink-delay);\n}\n</code></pre>\n</div>\n\n<p>…so that each character wouldn’t blink at the same time, I set a different <code>--blink-delay</code> before they all start blinking, by passing another Custom Property:</p>\n<pre><code>use[data-outlaw=\"1\"] { --blink-delay: 1s; }\nuse[data-outlaw=\"2\"] { --blink-delay: 2s; }\n\nuse[data-outlaw=\"7\"] { --blink-delay: 3s; }\n</code></pre>\n\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/7-foot-tapping-effect.png\" /></p>\n<p>Some of the characters tap their feet, so I added an inline style with a CSS Custom Property to those groups, too:</p>\n<pre><code>&lt;symbol id=\"outlaw-1\" viewBox=\"0 0 712 2552\"&gt;\n  &lt;g class=\"outlaw-1-foot\" style=\"\n    transform-origin: bottom right; \n    transform-box: fill-box; \n    transform: rotate(var(--foot-rotate));\"&gt;\n  &lt;/g&gt;\n&lt;/symbol&gt;\n</code></pre>\n\n<p>Defining the foot-tapping animation:</p>\n<pre><code>@keyframes tapping {\n  0%, 60%, 100% { --foot-rotate: 0deg; }\n  20% { --foot-rotate: -5deg; }\n  40% { --foot-rotate: 2deg; }\n}\n</code></pre>\n\n<p>And adding those extra Custom Properties to the characters’ declaration:</p>\n<pre><code>use[data-outlaw] {\n  --blink-duration: 4s;\n  --eyelids-opacity: 1;\n  --foot-rotate: 0deg;\n  animation: \n    blink var(--blink-duration) infinite var(--blink-delay),\n    tapping 1s ease-in-out infinite;\n}\n</code></pre>\n\n<p><img src=\"https://files.smashing.media/articles/smashing-animations-part-6-svgs-css-custom-properties/8-jiggling-effect.png\" /></p>\n<p>…before finally making the character’s whiskers jiggle via an inline style with a CSS Custom Property which describes how his moustache transforms:</p>\n<pre><code>&lt;symbol id=\"outlaw-1\" viewBox=\"0 0 712 2552\"&gt;\n  &lt;g class=\"outlaw-1-tashe\" style=\"\n    transform: translateX(var(--jiggle-x, 0px));\"\n  &gt;\n    &lt;!-- ... --&gt;\n  &lt;/g&gt;\n&lt;/symbol&gt;\n</code></pre>\n\n<p>Defining the jiggle animation:</p>\n<pre><code>@keyframes jiggle {\n  0%, 100% { --jiggle-x: 0px; }\n  20% { --jiggle-x: -3px; }\n  40% { --jiggle-x: 2px; }\n  60% { --jiggle-x: -1px; }\n  80% { --jiggle-x: 4px; }\n}\n</code></pre>\n\n<p>And adding those properties to the characters’ declaration:</p>\n<pre><code>use[data-outlaw] {\n  --blink-duration: 4s;\n  --eyelids-opacity: 1;\n  --foot-rotate: 0deg;\n  --jiggle-x: 0px;\n  animation: \n    blink var(--blink-duration) infinite var(--blink-delay),\n    jiggle 1s ease-in-out infinite,\n    tapping 1s ease-in-out infinite;\n}\n</code></pre>\n\n<p>With these moving parts, the characters come to life, but my markup remains remarkably lean. By combining several animations into a single declaration, I can choreograph their movements without adding more elements to my SVG. Every outlaw shares the same base <code>&lt;symbol&gt;</code>, and their individuality comes entirely from CSS Custom Properties.</p>\nPitfalls And Solutions\n<p>Even though this technique might seem bulletproof, there are a few traps it’s best to avoid:</p>\n<ul>\n<li><strong>CSS Custom Properties only work if they’re referenced with a <code>var()</code> inside a <code>&lt;symbol&gt;</code>.</strong> Forget that, and you’ll wonder why nothing updates. Also, properties that aren’t naturally inherited, like <code>fill</code> or <code>transform</code>, need to use <code>var()</code> in their value to benefit from the cascade.</li>\n<li><strong>It’s always best to include a fallback value alongside a custom property</strong>, like <code>opacity: var(--eyelids-opacity, 1);</code> to ensure SVG elements render correctly even without custom property values applied.</li>\n<li><strong>Inline styles set via the <code>style</code> attribute take precedence</strong>, so if you mix inline and external CSS, remember that Custom Properties follow normal cascade rules.</li>\n<li><strong>You can always use DevTools to inspect custom property values.</strong> Select a <code>&lt;use&gt;</code> instance and check the Computed Styles panel to see which custom properties are active.</li>\n</ul>\nConclusion\n<p>The <code>&lt;symbol&gt;</code> and <code>&lt;use&gt;</code> elements are among the most elegant but sometimes frustrating aspects of SVG. The Shadow DOM barrier makes animating them trickier, but <strong>CSS Custom Properties act as a bridge</strong>. They let you pass colour, motion, and personality across that invisible boundary, resulting in cleaner, lighter, and, best of all, fun animations.</p>","author":"","siteTitle":"Articles on Smashing Magazine — For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"8358b3b17a1aeb7b5c72685bd28c3fb3d525b9ea3a7bc158b53f9c52233c5af7","category":"Tech"}