{"title":"MSTest 3.4 สนับสนุน WinUI และ Playwright แล้ว","link":"https://www.somkiat.cc/mstest-3-4-with-playwright/","date":1717909932000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2024/06/mstestsdk-1024x576-1-150x150.jpg\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2024/06/mstestsdk-1024x576-1-150x150.jpg 150w, https://www.somkiat.cc/wp-content/uploads/2024/06/mstestsdk-1024x576-1-75x75.jpg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2024/06/mstestsdk-1024x576-1.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2024/06/mstestsdk-1024x576-1.jpg\" width=\"653\" height=\"367\" /></a></figure>\n\n\n\n<p>ทาง <strong><a href=\"https://devblogs.microsoft.com/dotnet/introducing-mstest-34\" target=\"_blank\">Microsoft ได้ปล่อย MSTest 3.4</a></strong> ออกมา สำหรับการทดสอบระบบงาน<br />โดยเพิ่มความสามารถต่าง ๆ เข้ามา เช่น</p>\n\n\n\n<ul>\n<li>สนับสนุนการทดสอบกับ WinUI</li>\n\n\n\n<li>สนับสนุนการทดสอบกับ Playwright ไม่ต้องมา config เอง</li>\n\n\n\n<li>สนับสนุน Aspire</li>\n\n\n\n<li>เพิ่ม [Timeout] เข้ามาใน test สำหรับกำหนด timeout ของการทดสอบ หรือใช้ร่วมกับ [ClassCleanup] ได้</li>\n\n\n\n<li>เพิ่ม <a href=\"https://learn.microsoft.com/en-us/dotnet/api/system.stathreadattribute\" target=\"_blank\">STA Thread (Single Thread Apartment)</a> เข้ามาสำหรับการทำ UI test</li>\n\n\n\n<li>ทำการปรับปรุง MSTest.Analyzers เพื่อช่วยแก้ไขปัญหาของการทดสอบ ให้มีมาตรฐานมากขึ้น ตาม <a href=\"https://learn.microsoft.com/en-us/dotnet/core/testing/mstest-analyzers/design-rules\" target=\"_blank\">design rules ทั้ง 9 ข้อ</a></li>\n</ul>\n\n\n\n<span></span>\n\n\n\n<p>ดังนั้นมาลองใช้งานกันดู<br /></p>\n\n\n\n<p><strong>เริ่มด้วยการสร้าง project (ใช้งาน dotnet 9 preview 4)</strong></p>\n\n\n\n[gist id=\"62c17d1ea64b0a4af32722f0172a37d4\" file=\"1.txt\"]\n\n\n\n<p>จากนั้นเข้าไปดู config ของ project จะทำการ enable Playwright มาให้เลย<br />เปลี่ยนมาใช้ version 3.4 ด้วย</p>\n\n\n\n[gist id=\"62c17d1ea64b0a4af32722f0172a37d4\" file=\"demo.csproj\"]\n\n\n\n<p>ปิดด้วยการเขียน test case กันเลย</p>\n\n\n\n[gist id=\"62c17d1ea64b0a4af32722f0172a37d4\" file=\"DemoTest.cs\"]\n\n\n\n<p>จากนั้นทำการ run test<br />แต่ต้องติดตั้ง <a href=\"https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.4\">Power</a><a href=\"https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.4\" target=\"_blank\">s</a><a href=\"https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.4\">hell</a> ก่อนนะครับ<br />เนื่องจากใช้สำหรับการติดตั้ง Playwright และ Driver + Web Browser ในการทดสอบ</p>\n\n\n\n[gist id=\"62c17d1ea64b0a4af32722f0172a37d4\" file=\"2.txt\"]\n\n\n\n<p>เพียงเท่านี้ก็ใช้ได้แล้วครับ<br />ลองใช้งานกันดู สำหรับการทดสอบแบบง่าย ๆ</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"becb52e169c0e53de99b62783c14660ad09ce9cf9fe0f1ec6ec5b5b28653d072","category":"Thai"}