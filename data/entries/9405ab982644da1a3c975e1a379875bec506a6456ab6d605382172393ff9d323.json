{"title":"Microsoft reports SIP-bypassing “Shrootless” vulnerability in macOS","link":"https://arstechnica.com/?p=1808830","date":1635526655000,"content":"<div>\n<figure>\n  <img src=\"https://cdn.arstechnica.net/wp-content/uploads/2021/10/GettyImages-1139157939-800x600.jpg\" />\n      <p><a href=\"https://cdn.arstechnica.net/wp-content/uploads/2021/10/GettyImages-1139157939.jpg\">Enlarge</a> <span>/</span> The worm says, \"I've got root!\" (credit: Andreus / Getty Images)</p>  </figure>\n\n\n\n\n\n\n<div><a name=\"page-1\"></a></div>\n<p>The Microsoft 365 Defender Research Team <a href=\"https://www.microsoft.com/security/blog/2021/10/28/microsoft-finds-new-macos-vulnerability-shrootless-that-could-bypass-system-integrity-protection/\">released a blog post yesterday</a> describing a newly found macOS vulnerability that can abuse entitlement inheritance in macOS's System Integrity Protection (SIP) to allow execution of arbitrary code with root-level privilege. The vulnerability is listed as <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30892\">CVE-2021-30892</a> and has been given the nickname \"Shrootless.\"</p>\n<p>To explain how Shrootless works, we need to review how SIP functions. Introduced back in 2015 with OS X 10.11 El Capitan (and explained in detail on <a href=\"https://arstechnica.com/gadgets/2015/09/os-x-10-11-el-capitan-the-ars-technica-review/8/\">pages eight and nine of our review</a>), SIP attempts to do away with an entire class of vulnerabilities (or at least neuter their effectiveness) by adding kernel-level protections against changing certain files on disk and certain processes in memory, even with root privilege. These protections are (more or less) inviolable unless one disables SIP, which cannot be done without rebooting into recovery mode and executing a terminal command.</p>\n<p>The Shrootless exploit takes advantage of the fact that, while root privilege is no longer sufficient to change important system files, the kernel itself still can—and does—alter protected locations as needed. The most obvious example is when installing an application. Apple-signed application install packages have the ability to do things normally prohibited by SIP, and that's where Shrootless slides in.</p></div><p><a href=\"https://arstechnica.com/?p=1808830#p3\">Read 5 remaining paragraphs</a> | <a href=\"https://arstechnica.com/?p=1808830&amp;comments=1\">Comments</a></p>","author":"Lee Hutchinson","siteTitle":"Ars Technica","siteHash":"5b0ddf6e8923e49262a7894cfd77962733e43fbcc565a103b48373820b310636","entryHash":"9405ab982644da1a3c975e1a379875bec506a6456ab6d605382172393ff9d323","category":"Tech"}