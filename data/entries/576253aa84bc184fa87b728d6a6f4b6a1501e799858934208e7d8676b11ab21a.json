{"title":"New – Simplify the Investigation of AWS Security Findings with Amazon Detective","link":"https://aws.amazon.com/blogs/aws/new-simplify-the-investigation-of-aws-security-findings-with-amazon-detective/","date":1684442779000,"content":"<p>With <a href=\"https://aws.amazon.com/detective/?trk=45bfbf2b-40fb-4630-a57e-5cb8ce0f6c5f&amp;sc_channel=el\">Amazon Detective</a>, you can analyze and visualize security data to investigate potential security issues. Detective collects and analyzes events that describe IP traffic, AWS management operations, and malicious or unauthorized activity from <a href=\"https://aws.amazon.com/cloudtrail/\">AWS CloudTrail</a> logs, <a href=\"https://aws.amazon.com/vpc/\">Amazon Virtual Private Cloud (Amazon VPC)</a> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html\">Flow Logs</a>, <a href=\"https://aws.amazon.com/guardduty/\">Amazon GuardDuty</a> findings, and, <a href=\"https://aws.amazon.com/blogs/aws/amazon-detective-supports-kubernetes-workloads-on-amazon-eks-for-security-investigations/\">since last year</a>, <a href=\"https://aws.amazon.com/eks/\">Amazon Elastic Kubernetes Service (EKS)</a> audit logs. Using this data, Detective constructs a graph model that distills log data using machine learning, statistical analysis, and graph theory to build a linked set of data for your security investigations.</p> \n<p>Starting today, Detective offers investigation support for findings in <a href=\"https://aws.amazon.com/security-hub/\">AWS Security Hub</a> in addition to those detected by GuardDuty. Security Hub is a service that provides you with a view of your security state in AWS and helps you check your environment against security industry standards and best practices. If you’ve turned on Security Hub and another integrated AWS security services, those services will begin sending findings to Security Hub.</p> \n<p>With this new capability, it is easier to use Detective to determine the cause and impact of findings coming from new sources such as <a href=\"https://aws.amazon.com/iam/features/analyze-access/\">AWS Identity and Access Management (IAM) Access Analyzer</a>, <a href=\"https://aws.amazon.com/inspector/\">Amazon Inspector</a>, and <a href=\"https://aws.amazon.com/macie/\">Amazon Macie</a>. All <a href=\"https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-internal-providers.html\">AWS services that send findings to Security Hub</a> are now supported.</p> \n<p>Let’s see how this works in practice.</p> \n<p><span><strong>Enabling AWS Security Findings in the Amazon Detective Console<br /> </strong></span>When you enable Detective for the first time, Detective now identifies findings coming from both GuardDuty and Security Hub, and automatically starts ingesting them along with other data sources. Note that you don’t need to enable or publish these log sources for Detective to start its analysis because this is managed directly by Detective.</p> \n<p>If you are an existing Detective customer, you can enable investigation of AWS Security Findings as a data source with one click in the Detective Management Console. I already have Detective enabled, so I add the source package.</p> \n<p>In the <a href=\"https://console.aws.amazon.com/detective\">Detective console</a>, in the <strong>Settings</strong> section of the navigation pane, I choose <strong>General</strong>. There, I choose <strong>Edit</strong> in the <strong>Optional source packages</strong> section to enable <strong>Detective for AWS Security Findings</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/11/amazon-detective-enable-aws-security-findings.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/11/amazon-detective-enable-aws-security-findings-1024x329.png\" alt=\"Console screenshot.\" width=\"1024\" height=\"329\" /></a></p> \n<p>Once enabled, Detective starts analyzing all the relevant data to identify connections between disparate events and activities. To start your investigation process, you can get a visualization of these connections, including resource behavior and activities. Historical baselines, which you can use to provide comparisons against recent activity, are established after two weeks.</p> \n<p><span><strong>Investigating AWS Security Findings in the Amazon Detective Console<br /> </strong></span>I start in the <a href=\"https://console.aws.amazon.com/securityhub\">Security Hub console</a> and choose <strong>Findings</strong> in the navigation pane. There, I filter findings to only see those where the <strong>Product name</strong> is <strong>Inspector</strong> and <strong>Severity label</strong> is <strong>HIGH</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-security-hub-findings.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-security-hub-findings-1024x628.png\" alt=\"Console screenshot.\" width=\"1024\" height=\"628\" /></a></p> \n<p>The first one looks suspicious, so I choose its <strong>Title</strong> (CVE-2020-36223 – openldap). The Security Hub console provides me with information about the corresponding Common Vulnerabilities and Exposures (CVE) ID and where and how it was found. At the bottom, I have the option to <strong>Investigate in Amazon Detective</strong>. I follow the <strong>Investigate finding</strong> link, and the Detective console opens in another browser tab.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-inspector-finding.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-inspector-finding-1024x639.png\" alt=\"Console screenshot.\" width=\"1024\" height=\"639\" /></a></p> \n<p>Here, I see the entities related to this Inspector finding. First, I open the profile of the AWS account to see all the findings associated with this resource, the overall API call volume issued by this resource, and the container clusters in this account.</p> \n<p>For example, I look at the successful and failed API calls to have a better understanding of the impact of this finding.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-api-calls.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/05/05/amazon-detective-api-calls-1024x653.png\" alt=\"Console screenshot.\" width=\"1024\" height=\"653\" /></a></p> \n<p>Then, I open the profile for the container image. There, I see the images that are related to this image (because they have the same repository or registry as this image), the containers running from this image during the scope time (managed by Amazon EKS), and the findings associated with this resource.</p> \n<p>Depending on the finding, Detective helps me correlate information from different sources such as CloudTrail logs, VPC Flow Logs, and EKS audit logs. This information makes it easier to understand the impact of the finding and if the risk has become an incident. For Security Hub, Detective only ingests findings for configuration checks that failed. Because configuration checks that passed have little security value, we’re filtering these outs.</p> \n<p><span><strong>Availability and Pricing<br /> </strong></span><a href=\"https://aws.amazon.com/detective/?trk=45bfbf2b-40fb-4630-a57e-5cb8ce0f6c5f&amp;sc_channel=el\">Amazon Detective</a> investigation support for AWS Security Findings is available today for all existing and new Detective customers in all <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/\">AWS Regions</a> where Detective is available, including the AWS GovCloud (US) Regions. For more information, see the <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/\">AWS Regional Services List</a>.</p> \n<p>Amazon Detective is priced based on the volume of data ingested. By enabling investigation of AWS Security Findings, you can increase the volume of ingested data. For more information, see <a href=\"https://aws.amazon.com/detective/pricing/?trk=7ec743c0-6eb6-405f-aab3-ef9c419ff82b&amp;sc_channel=el\">Amazon Detective pricing</a>.</p> \n<p>When GuardDuty and Security Hub provide a finding, they also suggest the remediation. On top of that, Detective helps me investigate if the vulnerability has been exploited, for example, using logs and network traffic as proof.</p> \n<p>Currently, ﬁndings coming from Security Hub are not included in the <strong>Finding groups</strong> section of the Detective console. Our plan is to expand <strong>Finding groups</strong> to cover the newly integrated AWS security services. Stay tuned!</p> \n<p><a href=\"https://aws.amazon.com/detective/getting-started/?trk=780bb0f0-df47-418c-b96a-ccd9f9a24c23&amp;sc_channel=el\"><strong>Start using Amazon Detective to investigate potential security issues.</strong></a></p> \n<p>— <a href=\"https://twitter.com/danilop\">Danilo</a></p>","author":"Danilo Poccia","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"576253aa84bc184fa87b728d6a6f4b6a1501e799858934208e7d8676b11ab21a","category":"Tech"}