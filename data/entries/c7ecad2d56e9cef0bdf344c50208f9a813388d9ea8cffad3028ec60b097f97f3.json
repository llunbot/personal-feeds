{"title":"ปัญหาที่ควรระวังของ Share  หรือ Reuse Service","link":"https://www.somkiat.cc/problems-from-shared-or-reuse-service/","date":1742022099000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2025/03/share-service-01-150x150.jpeg\" alt=\"\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2025/03/share-service-01-150x150.jpeg 150w, https://www.somkiat.cc/wp-content/uploads/2025/03/share-service-01-75x75.jpeg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/03/share-service-01.jpeg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/03/share-service-01-1024x516.jpeg\" alt=\"\" width=\"595\" height=\"300\" /></a></figure>\n\n\n\n<p>ในการแบ่งระบบงานออกเป็น service ย่อย ๆ  นั้น<br />ไม่ว่าจะแบ่งตามอะไรก็ตาม มักจะมีประเด็นเรื่องของ share หรือ reuse กันทั้งนั้น<br />บ้างก็ว่าเพื่อลดการทำงานลงไป<br />บ้างก็ว่าเพื่อลดค่าใช้จ่ายของการพัฒนาลงไป<br />และมักจะลงท้ายด้วยปัญหาต่าง ๆ  มากมาย<br />ทั้ง service นั้นใหญ่เกินไป<br />ทั้งเมื่อแก้ไขแล้วกระทบส่วนต่าง ๆ  ทั้งรู้และไม่รู้<br />ทำให้การดูแลรักษายาก หรือ เพิ่มสิ่งใหม่ ๆ  ข้าไปก็ยาก<br />ดังนั้นมาดูกันหน่อยว่า มีอะไรควรระวังบ้าง ?<br />เพื่อไม่ให้ซ้ำรอยเดิมกันอีก</p>\n\n\n\n<span></span>\n\n\n\n<p><strong>เรื่องที่เจอบ่อย ๆ คือ การใช้ซ้ำที่มีรูปแบบแตกต่างกัน !!</strong></p>\n\n\n\n<p>ยกตัวอย่างเช่นระบบการส่ง OTP (One Time Password) ไปยัง email ของผู้ใช้งาน<br />ซึ่งการใช้งานจะเป็นแบบ 1:1 เสมอ<br />โดยมีการใช้งานได้ดี</p>\n\n\n\n<p><strong>แต่เมื่อมีระบบ email marketing เข้ามา</strong></p>\n\n\n\n<p>ทีมก็พบว่าเรามีระบบส่ง email อยู่แล้ว จึงน่าจะนำมาใช้งานได้เลย<br />แต่การส่งในแต่ละครั้งมีจำนวนเยอะมาก ๆ  ตั้งแต่หลักร้อยถึงหลักล้าน email ต่อครั้ง<br />ดังนั้นจึงจำเป็นต้องแก้ไข ระบบส่ง email ให้รองรับการส่งจำนวนเยอะ ๆ<br />ทั้งรับข้อมูลแบบ bulk หรือ ครั้งละจำนวนมาก ๆ<br />ทั้งการสร้างระบบ messaging หรือ queue มารองรับการทำงาน<br />ซึ่งทำงานได้ดี</p>\n\n\n\n<p><strong>แต่เมื่อมีการส่ง email marketing จำนวนมาก ๆ  </strong></p>\n\n\n\n<p>จะส่งผลต่อการส่ง OTP ไปยังผู้ใช้งานที่ล่าช้ามาก ๆ<br />ทำให้มีปัญหาต่อระบบงานหลัก<br />เนื่องจากทั้งสองระบบใช้ระบบส่ง email ร่วมกัน<br />นั้นคือ share หรือ reuse service นั่นเอง</p>\n\n\n\n<p><strong>ทำให้ต้องแก้ไขอีกรอบ ยกตัวอย่างเช่น</strong></p>\n\n\n\n<ul>\n<li>กำหนด limit ของการส่ง email marketing ไว้ เพื่อลดผลกระทบ ทั้งจำนวนและเวลาที่ส่ง (Rate limiting)</li>\n\n\n\n<li>ทำการแยก service การส่งออกมา 2  service ตัวแรกส่ง OTP แบบ 1:1 เท่านั้น อีก service สำหรับ email marketing เท่านั้น</li>\n</ul>\n\n\n\n<p>ดังนั้นลองกลับมาดูว่า การแยก service ของระบบงานที่เป็นอยู่นั้น<br />ใช้เหตุผลอะไรในการแบ่ง<br />และผลที่ได้มันส่งผลดีต่อระบบ, development และ business หรือไม่</p>\n\n\n\n<p><strong>หรืออีกเรื่องหนึ่งคือ ขอบเขตหน้าที่รับผิดชอบของ service ต้องชัดเจน</strong></p>\n\n\n\n<p>ไม่ควรนำ knowledge หรือ logic ของ service อื่น ๆ  มาใส่ใน service ด้วย<br />มันทำให้เกิดข้อผูกมัดเยอะมาก ๆ หรือ tight couple<br />ส่งผลให้เมื่อมีการแก้ไข จะกระทบ หรือ แก้ไขเยอะมาก ๆ  <br />แสดงดังรูป</p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/03/Screenshot-2568-03-13-at-13.17.26.png\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/03/Screenshot-2568-03-13-at-13.17.26-1024x690.png\" alt=\"\" width=\"462\" height=\"311\" /></a></figure>\n\n\n\n<p></p>\n\n\n\n<p>ลองนำไปใช้งานกันดูครับ<br />คิดว่าน่าจะพอมีประโยชน์บ้าง</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"c7ecad2d56e9cef0bdf344c50208f9a813388d9ea8cffad3028ec60b097f97f3","category":"Thai"}