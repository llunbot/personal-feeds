{"title":"Introducing Amazon GuardDuty Malware Protection for Amazon S3","link":"https://aws.amazon.com/blogs/aws/introducing-amazon-guardduty-malware-protection-for-amazon-s3/","date":1718113966000,"content":"<p>Today we are announcing the general availability of Amazon GuardDuty Malware Protection for <a href=\"https://aws.amazon.com/s3\">Amazon Simple Storage Service (Amazon S3)</a>, an expansion of GuardDuty Malware Protection to detect malicious file uploads to selected S3 buckets. Previously, GuardDuty Malware Protection provided agentless scanning capabilities to identify malicious files on <a href=\"https://aws.amazon.com/ebs\">Amazon Elastic Block Store (Amazon EBS)</a> volumes attached to <a href=\"https://aws.amazon.com/ec2\">Amazon Elastic Compute Cloud (Amazon EC2)</a> and container workloads.</p> \n<p>Now, you can continuously evaluate new objects uploaded to S3 buckets for malware and take action to isolate or eliminate any malware found. Amazon GuardDuty Malware Protection uses multiple <a href=\"https://aws.amazon.com/\">Amazon Web Services (AWS)</a> developed and industry-leading third-party malware scanning engines to provide malware detection without degrading the scale, latency, and resiliency profile of Amazon S3.</p> \n<p>With GuardDuty Malware Protection for Amazon S3, you can use built-in malware and antivirus protection on your designated S3 buckets to help you remove the operational complexity and cost overhead associated with automating malicious file evaluation at scale. Unlike many existing tools used for malware analysis, this managed solution from GuardDuty does not require you to manage your own isolated data pipelines or compute infrastructure in each AWS account and AWS Region where you want to perform malware analysis.</p> \n<p>Your development and security teams can work together to configure and oversee malware protection throughout your organization for select buckets where new uploaded data from untrusted entities is required to be scanned for malware. You can configure post-scan action in GuardDuty, such as object tagging, to inform downstream processing, or consume the scan status information provided through <a href=\"https://aws.amazon.com/eventbridge\">Amazon EventBridge</a> to implement isolation of malicious uploaded objects.</p> \n<p><strong><u>Getting started with GuardDuty Malware Protection for your S3 bucket</u></strong><br /> To get started, in the <a href=\"https://console.aws.amazon.com/guardduty/home\">GuardDuty console</a>, select <strong>Malware Protection for S3 </strong>and choose <strong>Enable</strong>.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/05/2024-guardduty-s3-malware-detection-1.png\" width=\"2332\" height=\"1208\" /></p> \n<p>Enter the S3 bucket name or choose <strong>Browse S3</strong> to select an S3 bucket name from a list of buckets that belong to the currently selected Region. You can select <strong>All the objects in the S3 bucket </strong>when you want GuardDuty to scan all the newly uploaded objects in the selected bucket. Or you can also select <strong>Objects beginning with a specific prefix </strong>when you want to scan the newly uploaded objects that belong to a specific prefix.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/11/2024-guardduty-s3-malware-detection-2-1.png\" width=\"1106\" height=\"1212\" /></p> \n<p>After scanning a newly uploaded S3 object, GuardDuty can add a predefined tag with the key as <code>GuardDutyMalwareScanStatus</code> and the value as the scan status:</p> \n<ul> \n <li><code>NO_THREATS_FOUND</code> – No threat found in the scanned object.</li> \n <li><code>THREATS_FOUND</code> – Potential threat detected during scan.</li> \n <li><code>UNSUPPORTED</code> – GuardDuty cannot scan this object because of size.</li> \n <li><code>ACCESS_DENIED</code> – GuardDuty cannot access object. Check permissions.</li> \n <li><code>FAILED</code> – GuardDuty could not scan the object.</li> \n</ul> \n<p>When you want GuardDuty to add tags to your scanned S3 objects, select <strong>Tag objects</strong>. If you use tags, you can create policies to prevent objects from being accessed before the malware scan completes and prevent your application from accessing malicious objects.</p> \n<p>Now, you must first create and attach an <a href=\"https://aws.amazon.com/iam\">AWS Identity and Access Management (IAM)</a> role that includes the required permissions:</p> \n<ul> \n <li>EventBridge actions to create and manage the EventBridge managed rule so that Malware Protection for S3 can listen to your <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/EventNotifications.html\">S3 Event Notifications</a>.</li> \n <li>Amazon S3 and EventBridge actions to send S3 Event Notifications to EventBridge for all events in this bucket.</li> \n <li>Amazon S3 actions to access the uploaded S3 object and add a predefined tag to the scanned S3 object.</li> \n <li><a href=\"https://aws.amazon.com/kms/\">AWS Key Management Service (AWS KMS)</a> key actions to access the object before scanning and putting a test object on buckets with the supported DSSE-KMS and SSE-KMS</li> \n</ul> \n<p>To add these permissions, choose <strong>View permissions</strong> and copy the policy template and trust relationship template. These templates include placeholder values that you should replace with the appropriate values associated with your bucket and AWS account. You should also replace the placeholder value for the AWS KMS key ID.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/05/2024-guardduty-s3-malware-detection-3.png\" width=\"1642\" height=\"1060\" /></p> \n<p>Now, choose <strong>Attach permissions</strong>, which opens the IAM console in a new tab. You can choose to create a new IAM role or update an existing IAM role with the permissions from the copied templates. If you want to create or update your IAM role in advance, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/malware-protection-s3-iam-policy-prerequisite.html\">Prerequisite – Create or update IAM PassRole policy</a> in the AWS documentation.</p> \n<p>Finally, go back to the GuardDuty browser tab that has the IAM console open, choose your created or updated IAM role, and choose <strong>Enable</strong>.</p> \n<p>Now, you will see <strong>Active</strong> in the protection <strong>Status</strong> column for this protected bucket.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/05/2024-guardduty-s3-malware-detection-4.png\" width=\"1910\" height=\"1134\" /></p> \n<p>Choose <strong>View all S3 malware findings</strong> to see the generated GuardDuty findings associated with your scanned S3 bucket. If you see the finding type Object:S3/MaliciousFile, GuardDuty has detected the listed S3 object as malicious. Choose the <strong>Threats detected</strong> section in the <strong>Findings</strong> details panel and follow the recommended remediation steps. To learn more, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/compromised-s3object-malware-protection-gdu.html\">Remediating a potentially malicious S3 object</a> in the AWS documentation.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/05/2024-guardduty-s3-malware-detection-5.jpg\" width=\"1900\" height=\"978\" /></p> \n<p><strong><u>Things to know</u></strong><br /> <img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/06/07/2024-guardduty-s3-malware-protection-start.png\" width=\"540\" height=\"442\" />You can set up GuardDuty Malware Protection for your S3 buckets even without GuardDuty enabled for your AWS account. However, if you enable GuardDuty in your account, you can use the full monitoring of <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html\">foundational sources</a>, such as <a href=\"https://aws.amazon.com/cloudtrail/\">AWS CloudTrail</a> management events, <a href=\"https://aws.amazon.com/vpc\">Amazon Virtual Private Cloud (Amazon VPC)</a> Flow Logs, and DNS query logs, as well as malware protection features. You can also have security findings sent to <a href=\"https://aws.amazon.com/security-hub/\">AWS Security Hub</a> and <a href=\"https://aws.amazon.com/detective/\">Amazon Detective</a> for further investigation.</p> \n<p>GuardDuty can scan files belonging to the following synchronous <a href=\"https://aws.amazon.com/s3/storage-classes/\">Amazon S3 storage classes</a>: S3 Standard, S3 Intelligent-Tiering, S3 Standard-IA, S3 One Zone-IA, and Amazon S3 Glacier Instant Retrieval. It will scan the file formats known to be used to spread or contain malware. At the launch, the feature supports file sizes up to 5 GB, including archive files with up to five levels and 1,000 files per level after it is decompressed.</p> \n<p>As I said, GuardDuty will send scan metrics to your EventBridge for each protected S3 bucket. You can set up alarms and define post-scan actions, such as tagging the object or moving the malicious object to a quarantine bucket. To learn more about other monitoring options, such as <a href=\"https://aws.amazon.com/cloudwatch\">Amazon CloudWatch</a> metrics and S3 object tagging, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/monitoring-malware-protection-s3-scans-gdu.html\">Monitoring S3 object scan status</a> in the AWS documentation.</p> \n<p><strong><u>Now available</u></strong><br /> Amazon GuardDuty Malware Protection for Amazon S3 is generally available today in <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_regions.html#gd-regional-feature-availability\">all AWS Regions</a> where GuardDuty is available, excluding China Regions and GovCloud (US) Regions.</p> \n<p>The pricing is based on the GB volume of the objects scanned and number of objects evaluated per month. This feature comes with a limited AWS Free Tier, which includes 1,000 requests and 1 GB each month, pursuant to conditions for the first 12 months of account creation for new AWS accounts, or until June 11, 2025, for existing AWS accounts. To learn more, visit the <a href=\"https://aws.amazon.com/guardduty/pricing/\">Amazon GuardDuty pricing</a> page.</p> \n<p>Give GuardDuty Malware Protection for Amazon S3 a try in the <a href=\"https://console.aws.amazon.com/guardduty/home?#/s3-malware-scans\">GuardDuty console</a>. For more information, visit the <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/gdu-malware-protection-s3.html\">Amazon GuardDuty User Guide</a> and send feedback to <a href=\"https://repost.aws/tags/questions/TAkQ_AMw65SICuEGEmuUXv4g?view=all\">AWS re:Post for Amazon GuardDuty</a> or through your usual AWS support contacts.</p> \n<p>— <a href=\"https://twitter.com/channyun\">Channy</a></p> \n<p><strong>Update on June 11, 2024</strong> – We updated a screenshot to enable malware protection for S3 and links for the AWS documentation.</p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"cb5facabb3d669cdec7bc25330bccd7256195fc2b56597eda83705f300aeb83e","category":"Tech"}