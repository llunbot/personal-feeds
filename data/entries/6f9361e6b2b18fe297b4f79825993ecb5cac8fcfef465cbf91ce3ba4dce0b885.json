{"title":"Apple Says NeuralHash Tech Impacted by 'Hash Collisions' Is Not the Version Used for CSAM Detection","link":"https://www.macrumors.com/2021/08/18/apple-explains-neuralhash-collisions-not-csam-system/","date":1629317620000,"content":"Developer Asuhariet Yvgar this morning said that he had reverse-engineered the NeuralHash algorithm that Apple is using to detect Child Sexual Abuse Materials (CSAM) in <a href=\"https://www.macrumors.com/guide/icloud-photo-library/\">iCloud Photos</a>, <a href=\"https://github.com/AsuharietYgvar/AppleNeuralHash2ONNX\">posting evidence on GitHub</a> and <a href=\"https://www.reddit.com/r/MachineLearning/comments/p6hsoh/p_appleneuralhash2onnx_reverseengineered_apple/\">details on Reddit</a>.\r\n<br />\r\n\r\n<br />\r\n<img src=\"https://images.macrumors.com/article-new/2021/08/Child-Safety-Feature-Blue.jpg\" />\r\n<br />\r\nYvgar said that he reverse-engineered the NeuralHash algorithm from iOS 14.3, where the code was hidden, and he rebuilt it in Python. After he uploaded his findings, another user was able to <a href=\"https://github.com/AsuharietYgvar/AppleNeuralHash2ONNX/issues/1\">create a collision</a>, an issue where two non-matching images share the same hash. Security researchers have warned about this possibility because the potential for collisions could allow the CSAM system to be exploited.\r\n<br />\r\n\r\n<br />\r\nIn a statement to <em><a href=\"https://www.vice.com/en/article/wx5yzq/apple-defends-its-anti-child-abuse-imagery-tech-after-claims-of-hash-collisions\">Motherboard</a></em>, Apple said that the version of the NeuralHash that Yvgar reverse-engineered is not the same as the final implementation that will be used with the CSAM system. Apple also said that it made the algorithm publicly available for security researchers to verify, but there is a second private server-side algorithm that verifies a CSAM match after the threshold is exceeded, along with human verification.\r\n<br />\r\n<blockquote>Apple however told Motherboard in an email that that version analyzed by users on GitHub is a generic version, and not the one final version that will be used for iCloud Photos CSAM detection. Apple said that it also made the algorithm public.\r\n<br />\r\n\r\n<br />\r\n\"The NeuralHash algorithm [... is] included as part of the code of the signed operating system [and] security researchers can verify that it behaves as described,\" one of Apple's pieces of documentation reads. Apple also said that after a user passes the 30 match threshold, a second non-public algorithm that runs on Apple's servers will check the results.</blockquote>\r\n<br />\r\nMatthew Green, who teaches cryptography at Johns Hopkins University and who has been a vocal critic of Apple's CSAM system, told <em>Motherboard</em> that if collisions \"exist for this function,\" then he expects \"they'll exist in the system Apple eventually activates.\"\r\n<br />\r\n\r\n<br />\r\n\"Of course, it's possible that they will re-spin the hash function before they deploy,\" he said. \"But as a proof of concept, this is definitely valid,\" he said of the information shared on GitHub.\r\n<br />\r\n\r\n<br />\r\nBecause of the human element, though, another researcher, Nicholas Weaver, told <em>Motherboard</em> that all people can do with manipulating non-CSAM hashes into CSAM is \"annoy Apple's response team with garbage images until they implement a filter\" to get rid of false positives. Actually fooling Apple's system would also require access to the hashes provided by NCMEC and it would require the production of over 30 colliding images, with the end result not fooling the human oversight.\r\n<br />\r\n\r\n<br />\r\nApple is using its NeuralHash system to match a database of image hashes provided by agencies like the National Center for Missing Children (NCMEC) to images on user devices to search for CSAM. The system is designed to produce exact matches and Apple says there's a one in a trillion chance that an <a href=\"https://www.macrumors.com/guide/icloud/\">iCloud</a> account can be accidentally flagged.\r\n<br />\r\n\r\n<br />\r\nApple is planning to implement the NeuralHash CSAM system in iOS and <a href=\"https://www.macrumors.com/roundup/ipados-15/\">iPadOS 15</a> as part of a suite of child safety features, and it has been a hugely controversial decision with Apple receiving criticism from customers and privacy advocates. Apple has been attempting to reassure customers and security researchers about the implementation of the system with <a href=\"https://www.macrumors.com/2021/08/13/apple-child-safety-features-new-details/\">additional documentation</a> and <a href=\"https://www.macrumors.com/2021/08/13/federighi-confusion-around-child-safety-details/\">executive interviews</a>.<div>Tag: <a href=\"https://www.macrumors.com/guide/apple-child-safety-features/\">Apple child safety features</a></div><br />This article, \"<a href=\"https://www.macrumors.com/2021/08/18/apple-explains-neuralhash-collisions-not-csam-system/\">Apple Says NeuralHash Tech Impacted by 'Hash Collisions' Is Not the Version Used for CSAM Detection</a>\" first appeared on <a href=\"https://www.macrumors.com\">MacRumors.com</a><br /><br /><a href=\"https://forums.macrumors.com/threads/apple-says-neuralhash-tech-impacted-by-hash-collisions-is-not-the-version-used-for-csam-detection.2307964/\">Discuss this article</a> in our forums<br /><br /><div>\r\n<a href=\"http://feeds.macrumors.com/~ff/MacRumors-All?a=azZjc2YMByk:hiVNrUfWbS0:6W8y8wAjSf4\"><img src=\"http://feeds.feedburner.com/~ff/MacRumors-All?d=6W8y8wAjSf4\" /></a> <a href=\"http://feeds.macrumors.com/~ff/MacRumors-All?a=azZjc2YMByk:hiVNrUfWbS0:qj6IDK7rITs\"><img src=\"http://feeds.feedburner.com/~ff/MacRumors-All?d=qj6IDK7rITs\" /></a>\r\n</div><img src=\"http://feeds.feedburner.com/~r/MacRumors-All/~4/azZjc2YMByk\" />","author":"Juli Clover","siteTitle":"MacRumors: Mac News and Rumors - All Stories","siteHash":"4c0f1b1ecc2ed084c9f5be50f1058e33a55cdf9b904dadc33a2071fc2d63e8c1","entryHash":"6f9361e6b2b18fe297b4f79825993ecb5cac8fcfef465cbf91ce3ba4dce0b885","category":"Apple"}