{"title":"การคอนฟิกเราท์เตอร์ Synology ให้เป็น HTTPS และการใช้ Mesh Router","link":"https://www.blognone.com/node/125605","date":1635790183000,"content":"<div><div><div><p>ฟีเจอร์หนึ่งที่เราท์เตอร์ระดับจริงจังไม่ว่าจะเป็นระดับองค์กรหรือสำหรับธุรกิจขนาดเล็กเริ่มรองรับกันมากขึ้นคือการเชื่อมต่อเว็บคอนโซลแบบเข้ารหัส แม้ว่าอุปกรณ์เน็ตเวิร์คเหล่านี้มักรองรับการเข้ารหัสในตัวอยู่แล้ว แต่ก็มักอาศัยใบรับรองแบบ self-signed ที่เบราว์เซอร์ไม่เชื่อถือ</p>\n<p>ก่อนหน้านี้ผมเคยเขียนถึง<a href=\"https://www.blognone.com/node/122609\">เราท์เตอร์ MikroTik ที่รองรับการใส่ใบรับรองจากภายนอก</a>เพื่อให้เชื่อมต่อเข้าไปคอนฟิกได้โดยใช้ URL แบบ HTTPS โดยใช้รับรองจริงจาก HTTPS แต่ในระบบปฎิบัติการ Synology Router Manager (SRM) ที่ Synology ติดตั้งมากับเราท์เตอร์ของบริษัทนั้นรองรับ Let’s Encrypt ในตัวมาตั้งแต่เวอร์ชั่น 1.2.3 ที่ออกตั้งแต่ปี 2019 ทำให้การเซ็ตอัพโดยรวมง่ายกว่ามาก</p>\n<h3>Dynamic DNS ผ่านบริการ Synology Account</h3>\n<p>ตัว SRM รองรับการบริการ dynamic DNS จำนวนมาก แต่ผมพบว่าตัวที่สะดวกที่สุดคือบริการ Synology DDNS เอง เพราะนอกจากสามารถใช้บริการได้ฟรีแล้ว ยังมีโดเมนให้เลือกจำนวนมาก ที่สำคัญคือรองรับการแก้ไขโดเมนแบบ TXT record ซึ่งจำเป็นสำหรับการสร้างใบรับรองเพื่อใช้งานเป็นการภายใน</p>\n<p>ผู้ใช้ที่ต้องการใช้บริการ Synology DDNS ต้อง<a href=\"account.synology.com\">สมัครบริการ Synology Account</a> เสียก่อน และลงทะเบียนอุปกรณ์ที่ต้องการใช้งานด้วยหมายเลข serial ประจำตัวเครื่อง ที่เมนู Control Panel &gt; Device &gt; หน้าจอ System Information</p>\n<p>การตั้ง Dynamic DNS อยู่ใน Network Center &gt; Internet, Quick Connect &amp; DDNS ส่วนของ DDNS นั้นอยู่ครึ่งล่าง กด Add เพื่อเพิ่มชื่อโดเมน ในกล่องเลือก เราท์เตอร์จะถามรหัสผ่านของบัญชี Synology จุดนี้ผมไม่ชอบสักหน่อย ถ้าเป็น device key น่าจะปลอดภัยกว่าในกรณีที่เราท์เตอร์ถูกแฮก แต่บัญชี Synology ก็ไม่ได้เข้ามาควบคุมเราท์เตอร์ตัวอื่นๆ ในบัญชี ทำให้ความเสี่ยงไม่มากนัก</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/9c8e264c6c0cb92892bda14f1dc39278.jpg\" /></p>\n<p>หลังใส่รหัสผ่านแล้วเราสามารถตั้งชื่อโดเมนที่ต้องการได้จากในหน้า Add DDNS ได้โดยตรง และกำหนดไอพีภายในเพื่อใช้งาน ในกรณีของผมกำหนดเป็น 192.168.1.1 เอาไว้ตามปกติ (ผมทดสอบพบว่า SRM บังคับใส่ IPv6 จึงใส่ ::1 ไป) จากนั้นเลือกขอใบรับรองจาก Let’s Encrypt และยอมรับข้อตกลงใช้งาน ตัว SRM นั้นรองรับการขอใบรับรองจาก Let’s Encrypt ทั้งแบบ HTTP-01 และ DNS-01 โดยเราต้องเลือกผู้ให้บริการ DDNS ที่รองรับ TXT record ด้วยตัวเอง ในกรณีนี้ Synology DDNS รองรับอยู่แล้ว เราจึงไม่ต้องเปิดให้เราท์เตอร์ Synology เข้าถึงได้จากอินเทอร์เน็ตแต่อย่างใด</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/8fb6cd4fe9358935897a108d1d391a7c.jpg\" /></p>\n<p>หลังจาก SRM ขอใบรับรองสำเร็จ จะได้ใบรับรองใน Control Panel &gt; Services &gt; Certificates กดเซฟออกไปใช้งานที่อื่นก็ได้เช่นกัน</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/4468297a3668e7fb23498427ec5964b6.jpg\" /></p>\n<p>ตัว SRM นั้นเปิดการเชื่อมต่อแบบ HTTPS อยู่แล้ว เราอาจจะเลือกให้ redirect ไปยัง HTTPS เสมอรวมถึงเปิด HSTS เพื่อป้องกันการถูกดักฟังในอนาคตก็ได้ น่าเสียดายที่ SRM ไม่รองรับการคอนโซลบนพอร์ต 443 ทำให้ต้องใช้พอร์ตไม่มาตรฐานเท่านั้น</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/207e4187acc7722c494ed09f6e55f9c6.jpg\" /></p>\n<p>หลังเซ็ตอัพ HTTPS เรียบร้อยแล้วเราก็สามารถเข้าเว็บคอนโซลแบบ HTTPS โดยไม่ต้องกดยกเลิกแจ้งเตือนจากเบราว์เซอร์อีกต่อไป และแม้แต่ตัวแอป DS Router ของ Synology เองก็มีฟีเจอร์ตรวจสอบใบรับรองการเข้ารหัส ทำให้เรารู้ตัวได้เสมอหากมีความสามารถคั่นกลางการเชื่อมต่อ</p>\n<h3>การเซ็ตอัพ Mesh Router ใน Synology Router</h3>\n<p>อีกฟีเจอร์ที่ผมลองเล่น Synology RT2600ac คือการใช้งาน Mesh Router รุ่น MR2200ac โดยตัว MR2200ac รันซอฟต์แวร์ SRM เช่นกันทำให้สามารถใช้งานเป็นเราท์เตอร์ในตัวเองได้ แม้จะจำกัดกว่า RT2600ac มากโดยเฉพาะพอร์ตแลนที่มีเพียงพอร์ตเดียว</p>\n<p>กระบวนการเซ็ตอัพ MR2200ac นั้นมีสองแบบ คือ เมื่อเปิดเครื่องครั้งแรก หรือ factory reset แล้ว เราท์เตอร์จะปล่อยสัญญาณ Wi-Fi ใน SSID: <code>Synology_[เลข Serial เครื่อง]</code> ออกมา และให้เราล็อกอินเข้าไปเซ็ตอัพแบบเราท์เตอร์ได้</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/1c63c4e59952dd161c9ec6efa24f77ff.jpg\" /></p>\n<p>อีกแบบหนึ่งคือการเซ็ตอัพเพื่อใช้เป็น mesh router นั้นต้องล็อกอินจากเราท์เตอร์หลัก แล้วเข้าเมนู Wi-Fi Connect &gt; Wi-Fi Point &gt; จากนั้นกด Add เพื่อให้เราท์เตอร์หลักค้นหาเราท์เตอร์ mesh จุดที่ต้องระวังคือระบบปฎิบัติการ SRM นั้นไม่รองรับการเพิ่มเราท์เตอร์ mesh ที่เซ็ตอัพไปไปก่อนแล้ว หากเผลอล็อกอินเข้าไปแก้ไขค่าในเราท์เตอร์แล้วต้อง factory reset ใหม่เท่านั้น</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/202b88aba098625239b6ee19fc98c6d7.jpg\" /></p>\n<p>กระบวนการทั้งหมดนับว่าค่อนข้างง่าย เมื่อเราท์เตอร์หลักเชื่อมต่อเรียบร้อยแล้วก็จะรายงานสถานะ, ระดับสัญญาณพร้อมช่องสัญญาณที่ใช้เชื่อมต่อกับเราท์เตอร์ mesh, จำนวนอุปกรณ์ที่เชื่อมต่ออยู่รวมถึงสามารถทดสอบความแรงสัญญาณจากเราท์เตอร์หลักไปยังเราท์เตอร์ mesh เพื่อดูว่าติดตั้งไกลเกินไปหรือไม่</p>\n<h3>ส่งท้าย</h3>\n<p>บทความนี้เป็นบทความที่สองต่อจากฟีเจอร์ Safe Access และ Threat Prevention ของระบบปฎิบัติการ SRM ในเราท์เตอร์ของ Synology แต่ในบทความนี้ฟีเจอร์ Let’s Encrypt และการสร้างเน็ตเวิร์คแบบ mesh นั้นนับว่าค่อนข้างน่าประทับใจ กระบวนการเซ็ตอัพเว็บแบบ HTTPS นั้นเมนูกระจายเกินไปสักหน่อยแต่โดยรวมใช้งานได้ดี นับเป็นความหวังต่อไปว่าอุปกรณ์เครือข่ายในบ้านก็น่าจะรองรับการเชื่อมต่อแบบ HTTPS กันเป็นมาตรฐานในอนาคต</p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/synology\">Synology</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"e8b0e52f59379f12249e7cb6e80faebfb2386466cc3894af78a58a1d1b2477d9","category":"Thai"}