{"title":"New for AWS Backup – Support for VMware and VMware Cloud on AWS","link":"https://aws.amazon.com/blogs/aws/new-for-aws-backup-support-for-vmware-and-vmware-cloud-on-aws/","date":1638316958000,"content":"<p>Today, I am happy to announce <a href=\"https://aws.amazon.com/backup/\">AWS Backup</a> support for VMware, a new capability that enables you to centralize and automate data protection of virtual machines (VMs) running on VMware on premises and <a href=\"https://www.vmware.com/products/vmc-on-aws.html\">VMware Cloud<sup>TM</sup> on AWS</a>. You can now use a single, centrally managed policy in AWS Backup to protect these VMware environments together with 12 AWS compute, storage, and database services already supported by AWS Backup. You can then use AWS Backup to restore VMware workloads to on-premises data centers and VMware Cloud on AWS.</p> \n<p>While doing so, <a href=\"https://aws.amazon.com/blogs/aws/monitor-evaluate-and-demonstrate-backup-compliance-with-aws-backup-audit-manager/\">AWS Backup Audit Manager lets you consistently demonstrate compliance</a> by monitoring backup, copy, and restore operations and generating auditor-ready reports to satisfy your data governance and regulatory requirements.</p> \n<p>Let’s see how this works in practice.</p> \n<p><span><strong>Using AWS Backup Support for VMware<br /> </strong></span>There are three steps to back up VMware virtual machines (VMs) with AWS Backup:</p> \n<ol> \n <li>Create a <strong>gateway</strong> to connect AWS Backup to your hypervisor.</li> \n <li>Connect to your <strong>hypervisor</strong> through the gateway.</li> \n <li>Assign <strong>virtual machines</strong> managed by your hypervisor to a backup plan.</li> \n</ol> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-diagram.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-diagram-1024x481.png\" /></a></p> \n<p>On the left pane of the AWS Backup console, there is a new <strong>External resources</strong> section. There, I choose <strong>Gateways</strong> and then <strong>Create gateway</strong>. This AWS Backup gateway helps with discovery of the on-premises VMware environment and acts as a cloud gateway to send and receive data.</p> \n<p>I download the <a href=\"https://en.wikipedia.org/wiki/Open_Virtualization_Format\">Open Virtualization Format (OVF)</a> file of the AWS Backup gateway and follow the instructions to deploy the gateway using the VMware vSphere client. I am using an internal test and development VMware environment for this walkthrough.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/23/aws-backup-vmware-deploy-gateway-1.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/23/aws-backup-vmware-deploy-gateway-1-1024x330.png\" /></a></p> \n<p>After deploying the gateway in my VMware environment, I come back to the AWS Backup console. I write a name for the gateway (for simplicity, I use the same name of the gateway VM) and the IP address of the gateway VM. Optionally, I can add tags to help organize and track my setup. I go on and create the gateway.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-gateway-create.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-gateway-create-1024x659.png\" /></a></p> \n<p>Now, I choose <strong>Add hypervisor</strong>. I write a name for the hypervisor and the IP address of the VMware vCenter server host.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add-1024x455.png\" /></a></p> \n<p>I enter the username and password of a service account that I created for AWS Backup on the Active Directory domain. The username should include the domain (for example, <code>username@domain</code>). Then, I choose the encryption key to protect the service account credentials. If I don’t choose my own <a href=\"https://aws.amazon.com/kms/\">AWS Key Management Service (KMS)</a> key, AWS Backup encrypts the username and password using a key that AWS owns and manages.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add-account-encryption.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add-account-encryption-1024x546.png\" /></a></p> \n<p>I select the gateway to connect to the hypervisor and choose <strong>Test gateway connection</strong>. This test helps ensure that the gateway can communicate with the hypervisor before I complete the configuration. Optionally, I can add tags to help organize and track my setup. I go on and add the hypervisor.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add-gateway.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-hypervisor-add-gateway-1024x345.png\" /></a></p> \n<p>After a few minutes, the hypervisor is online, and I see the VMs managed by vCenter in the AWS Backup console. I can now use these virtual machines as resources in my backup plans in the same way as the other AWS compute, storage, and database resources supported by AWS Backup.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-vms.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-vms-1024x289.png\" /></a></p> \n<p>I create a new backup plan and start with a template. The rules of the template enforce daily backups with five weeks of retention and monthly backups with one year of retention. I can customize these rules based on my requirements.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-backup-plan.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-backup-plan-1024x637.png\" /></a></p> \n<p>Then, I choose to assign resources to the backup plan, and I select three VMs.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-assign-vms.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-assign-vms-1024x713.png\" /></a></p> \n<p>If you need, you can create an on-demand backup in the <strong>Protected resources</strong> section of the console. For example, here I am starting the on-demand backup for one of the VMs.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-on-demand-vms.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/12/aws-backup-vmware-on-demand-vms-1024x424.png\" /></a></p> \n<p>When a backup is complete, VMs are added to the list of the protected resources, and I can initiate a restore.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/24/aws-backup-vmware-backup-complete.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/24/aws-backup-vmware-backup-complete-1024x237.png\" /></a></p> \n<p>I select the backup and choose <strong>Restore</strong>. Then, I enter the restore location, which can be the same VMware environment I used for the backup or another (for example, on VMware Cloud on AWS). Below, I specify name, path, compute resource name, and datastore to use for the restore. Then, I choose <strong>Restore backup</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/24/aws-backup-vmware-restore.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2021/11/24/aws-backup-vmware-restore-1024x472.png\" /></a></p> \n<p>I monitor the status of my backup and restore jobs from the AWS Backup console. To monitor backup and restore metrics over a period of time, I can use <a href=\"https://aws.amazon.com/cloudwatch/\">Amazon CloudWatch</a> <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/cloudwatch.html\">metrics, logs, and alarms</a>. I can also send events to <a href=\"https://aws.amazon.com/eventbridge\">Amazon EventBridge</a> to <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/eventbridge.html#monitoring-events-in-eventbridge\">receive notifications once a job completes or fails</a>.</p> \n<p><strong><span>Availability and Pricing<br /> </span></strong><a href=\"https://aws.amazon.com/backup/\">AWS Backup</a> support for VMware is available in the US East (N. Virginia, Ohio), US West (N. California, Oregon), GovCloud (US-East, US-West), Canada (Central), Europe (Frankfurt, Ireland, London, Milan, Paris, Stockholm), South America (São Paulo), Asia Pacific (Hong Kong, Mumbai, Seoul, Singapore, Sydney, Tokyo, Osaka), Middle East (Bahrain), and Africa (Cape Town) Regions. Please see the <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/\">AWS Regional Services List</a> for more information.</p> \n<p>AWS Backup supports VMware ESXi 6.7.x and 7.0.x VMs running on NFS, VMFS, and VSAN data stores on premises and in VMware Cloud on AWS. In addition, AWS Backup supports both SCSI Hot-Add and Network Block Device (NBD) transport modes for copying data from source VMs to AWS.</p> \n<p>With AWS Backup support for VMware, you pay using the same dimensions that AWS Backup uses today: backup storage, restore, and cross-region data transfer. For more information, see the <a href=\"https://aws.amazon.com/backup/pricing/\">AWS Backup pricing page</a>.</p> \n<p>Your VM backups are stored in a <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/vaults.html\">backup vault</a>. All backups stored and managed by AWS Backup are replicated to 3 <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/#Availability_Zones\">Availability Zones (AZs)</a> in the Region and designed for 99.999999999 percent (11 9s) durability and 99.99 percent (4 9s) of service availability.</p> \n<p>AWS Backup supports first full, then incremental-forever, backups of VMs that you can create on-demand or via a schedule configured in your backup plan. AWS Backup always does full restores even though backups are stored as incremental, enabling you to benefit from storage efficiency cost savings while easily performing restores.</p> \n<p><a href=\"https://aws.amazon.com/backup/features/vmware/\"><strong>Centrally protect your VMware environments and your AWS compute, storage, and database resources with AWS Backup.</strong></a></p> \n<p>— <a href=\"https://twitter.com/danilop\">Danilo</a></p>","author":"Danilo Poccia","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"660ea37caff45f5122b11ba33588e863c0f626197c8407d60a15277671542e46","category":"Tech"}