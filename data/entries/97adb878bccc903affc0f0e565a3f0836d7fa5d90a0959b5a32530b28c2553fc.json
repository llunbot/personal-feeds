{"title":"Apple Wi-Fi network vulnerability could leak your location in real-time","link":"https://www.macworld.com/article/2343297/apple-wi-fi-network-wps-vulnerability-location-services-leak.html","date":1716482638000,"content":"<p><a href=\"https://www.macworld.com\">Macworld</a></p>\n\n<div>\n<section><div></div></section>\n\n\n\n<p>Apple’s <a href=\"https://apple.sjv.io/c/321564/435031/7613?subid1=1-1-2343297-1-0-0&amp;u=https://www.apple.com/legal/privacy/data/en/location-services/\" target=\"_blank\">location services are handy</a>, with many useful functions such as Find My, maps, routes, and Emergency SOS calls. However, researchers at the <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://www.cs.umd.edu/~dml/papers/wifi-surveillance-sp24.pdf&amp;xcust=1-1-2343297-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">University of Maryland have discovered a crucial vulnerability</a> in the way Apple’s location services work, which could allow an unauthorized person to access data on millions of routers and potentially information on a person’s movements without much effort. </p>\n\n\n\n<p>As reported by <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://krebsonsecurity.com/2024/05/why-your-wi-fi-router-doubles-as-an-apple-airtag/&amp;xcust=1-1-2343297-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">Krebs on Security</a>, Erik Rye and Dave Levin from the University of Maryland have discovered one aspect of Apple’s location services that works strangely.</p>\n\n\n\n<h2>Positioning via WLAN instead of GPS</h2>\n\n\n\n<p>GPS and its constant queries are energy-intensive, so smartphone manufacturers try to use alternatives when available. An economical method of determining a device’s location is to analyze the data from surrounding Wi-Fi networks and calculate location based on the networks detected and the current signal strength. Apple and Google operate their databases with active Wi-Fi network names (Wi-Fi-based Positioning Systems, WPS for short), which make these calculations much easier. </p>\n\n\n\n<p>The researchers discovered an oddity in the way Apple’s WPS works: the system sends the necessary data to the user’s device so that these calculations can be carried out locally. But apparently, Apple’s WPS server sends up to 400 other known Wi-Fi networks that may be in the approximate vicinity of the device as part of its crowdsourcing location database. From this list, the requesting device searches for eight possible variants and calculates its location based on this data. Apple’s WPS system, the iOS device, and the router on which the network is based operate with the so-called <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://de.wikipedia.org/wiki/Service_Set&amp;xcust=1-1-2343297-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">BSSIDs (Basic Service Set Identification)</a> and usually correspond to the MAC address of the device, which is static in most cases. </p>\n\n\n\n<h2>Data from almost 500 million WLAN networks</h2>\n\n\n\n<p>The researchers took advantage of this fact and used a Linux computer (not a Mac) to query Apple’s WPS servers for valid BSSIDs and their locations. They simply created the initial BSSID for the request using a random generator.</p>\n\n\n\n<p>Using the already known lists <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://standards-oui.ieee.org&amp;xcust=1-1-2343297-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">registered with the IEEE</a>, which router manufacturers use for their products, the number of guessed BSSIDs can be narrowed down significantly. For their experiment, the researchers used 16,384 (2^14) randomly generated BSSID parts. The request via Apple’s APIs is free, so Rye and Levin sent 30 requests per second with 100 guessed BSSIDs. </p>\n\n\n<div><figure><img src=\"https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?quality=50&amp;strip=all&amp;w=1200\" alt=\"Flight mode on iOS\" srcset=\"https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?quality=50&amp;strip=all 1600w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=300%2C168&amp;quality=50&amp;strip=all 300w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=768%2C432&amp;quality=50&amp;strip=all 768w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1200%2C675&amp;quality=50&amp;strip=all 1200w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1536%2C864&amp;quality=50&amp;strip=all 1536w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1240%2C697&amp;quality=50&amp;strip=all 1240w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=150%2C84&amp;quality=50&amp;strip=all 150w\" width=\"1200\" height=\"675\" loading=\"lazy\" />\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t<figcaption><p>You can disable Apple’s location services on your network so it won’t be visible to Apple’s database.</p></figcaption>\t\t<div>\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t<div><div><figure><img alt=\"Flight mode on iOS\" srcset=\"https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?quality=50&amp;strip=all 1600w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=300%2C168&amp;quality=50&amp;strip=all 300w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=768%2C432&amp;quality=50&amp;strip=all 768w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1200%2C675&amp;quality=50&amp;strip=all 1200w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1536%2C864&amp;quality=50&amp;strip=all 1536w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1240%2C697&amp;quality=50&amp;strip=all 1240w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=150%2C84&amp;quality=50&amp;strip=all 150w\" width=\"1200\" height=\"675\" loading=\"lazy\" /><figcaption><p>You can disable Apple’s location services on your network so it won’t be visible to Apple’s database.</p></figcaption></figure><p>Martyn Casserly</p></div>\n</div>\n\t\t\t\t<div><div><figure><img alt=\"Flight mode on iOS\" srcset=\"https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?quality=50&amp;strip=all 1600w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=300%2C168&amp;quality=50&amp;strip=all 300w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=768%2C432&amp;quality=50&amp;strip=all 768w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1200%2C675&amp;quality=50&amp;strip=all 1200w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1536%2C864&amp;quality=50&amp;strip=all 1536w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=1240%2C697&amp;quality=50&amp;strip=all 1240w, https://b2c-contenthub.com/wp-content/uploads/2024/05/why-is-my-iphone-in-sos-mode-FLIGHT.jpg?resize=150%2C84&amp;quality=50&amp;strip=all 150w\" width=\"1200\" height=\"675\" loading=\"lazy\" /><figcaption><p>You can disable Apple’s location services on your network so it won’t be visible to Apple’s database.</p></figcaption></figure><p>Martyn Casserly</p></div>\n</div>\n\t\t\t\t<div></div>\n\t\t</div></figure><p>Martyn Casserly</p></div>\n\n\n\n<p>In the experiment, the researchers queried a total of 1,124,663,296 BSSIDs, and around 0.25 percent (2,834,067), were known to Apple. However, due to the way Apple’s location calculation works, the servers also sent additional registered BSSIDs, meaning that the researchers obtained data from a further 488,677,543 Wi-Fi networks. The researchers monitored the data from almost half a billion Wi-Fi routers over the period from November 2022 to November 2023 and used it to make their observations, particularly in crisis regions.</p>\n\n\n\n<p>Using the manufacturer part of the MAC address, Rye and Levin were able to identify around 3,000 Starlink terminals in Ukraine. During the period observed, it was also possible to determine the location of some of them. However, the information on the current static location alone is life-threatening in the wrong hands, as it indicates the location data of the Ukrainian military units.</p>\n\n\n\n<p>In Gaza, the researchers also monitored the development of the number of registered BSSIDs and their movements. After October 7, 2023, and until the end of November 2023, the number of Wi-Fi networks registered in the Gaza Strip decreased by 75 percent, with some moving from north to south.</p>\n\n\n\n<h2>How to exclude your Wi-Fi from Apple’s database</h2>\n\n\n\n<p>The researchers contacted Apple, Google, Starlink, and several other manufacturers with their discovery. It’s not clear if Apple will change the way it handles Wi-Fi networks, but it did <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://support.apple.com/en-us/102515#:~:text=Crowd%2Dsourced%20Wi%2DFi%20and%20cellular%20Location%20Services&amp;xcust=1-1-2343297-1-0-0&amp;sref=https://www.macworld.com/feed\">update a support document</a> to provide a way for anyone to opt out of this data collection.</p>\n\n\n\n<p>To do this, you need to add the character string “_nomap” to the end of the name (SSID) of your network. This also applies to Google and its WPS. With Microsoft, you must enter <a href=\"https://click.linksynergy.com/deeplink?id=*l6kYCuH720&amp;mid=24542&amp;u1=1-1-2343297-1-0-0&amp;murl=https://account.microsoft.com/privacy/location-services-opt-out\" target=\"_blank\">your MAC address in a form</a> so that the manufacturer can add it to a block list in its database. This can take up to five days.</p>\n\nAntivirus, iOS, iPhone, Security Software and Services</div>","author":"","siteTitle":"Macworld","siteHash":"37e84dd5a21fa961d6d6630e269546024dbb7741b2e2fadbe74f47383c70dfbb","entryHash":"97adb878bccc903affc0f0e565a3f0836d7fa5d90a0959b5a32530b28c2553fc","category":"Apple"}