{"title":"Project Zero วิเคราะห์มัลแวร์ของ NSO Group พบสามารถสร้างระบบรันสคริปต์จากตัวบีบอัดภาพ","link":"https://www.blognone.com/node/126338","date":1639593625000,"content":"<div><div><div><p>มัลแวร์ Pegasus ของ NSO Group มีความซับซ้อนสูง และสามารถทะลุระบบป้องกันของบริษัทต่างๆ  ได้อย่างมีประสิทธิภาพจน<a href=\"https://www.blognone.com/node/120227\">บริษัทไอทีจำนวนมาก</a>รวมถึง<a href=\"https://www.blognone.com/node/125978\">แอปเปิล</a>ฟ้อง วันนี้ทาง Project Zero ของกูเกิลก็ออกมาวิเคราะห์ความเก่งกาจของกระบวนการเจาะเข้าไปวางมัลแวร์ในโทรศัพท์</p>\n<p>Project Zero พบว่ากระบวนการแฮกโทรศัพท์แบบไม่ต้องคลิกใดๆ (zero click) ของ NSO Group อาศัยการส่งไฟล์ภาพนามสกุลไฟล์เป็น GIF ที่ iMessage จะพยายามแสดงภาพทันที แต่เนื้อไฟล์ภายในที่จริงแล้วเป็น PDF ที่ตัว iMessage จะรู้เมื่ออ่านเนื้อไฟล์ และพยายามเรนเดอร์ภาพอยู่ดีด้วย CoreGraphics PDF</p>\n<p>แม้ว่าไฟล์ PDF นั้นสามารถใส่จาวาสคริปต์ได้ และเป็นจุดที่แฮกเกอร์มักใช้โจมตีระบบต่างๆ เรื่อยๆ แต่ใน CoreGraphic นั้นไม่ได้รันจาวาสคริปต์ใน PDF ทำให้ NSO หันไปใช้ตัวเข้ารหัสบีบอัดภาพ JBIG2 ที่รับข้อมูลภาพขาวดำที่บีบอัดอย่างหนัก  และกระบวนการขยายข้อมูลกลับเป็นภาพต้องทำตามคำสั่งในไฟล์ภาพค่อนข้างซับซ้อน โดย JBIG2 ได้รับความนิยมในสแกนเนอร์เก่าๆ จำนวนมากเพราะได้ไฟล์เล็ก ตัว PDF นั้นรองรับการใส่ภาพ JBIG2 จนทุกวันนี้</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/13df9f8992dc6b69e445ff6dcfa8be31.jpg\" /></p>\n<p>ความซับซ้อนของฟอร์แมต JBIG2 ทำให้ NSO สามารถควบคุมการทำงานของตัวขยายภาพจนทำงานได้เหมือน logic gate และเมื่อต่อ logic gate จำนวนกว่า 70,000 ชุดก็ได้คอมพิวเตอร์เสมือนขนาดเล็กรันอยู่บนตัวขยายข้อมูลภาพ ทาง NSO สามารถเขียนโปรแกรมบนคอมพิวเตอร์เสมือนนี้เพื่อค้นหาข้อมูลหน่วยความจำ และการรันสคริปต์ได้โดยไม่ต้องอาศัยเอนจินรันสคริปต์เลยก็นับเป็นความเก่งกาจของมัลแวร์ตัวนี้</p>\n<p>การรันสคริปต์จากไฟล์ภาพได้เป็นเพียงจุดเริ่มต้น ทาง Project Zero ระบุว่าจะเล่าถึงกระบวนการเจาะทะลุ sandbox ของตัวขยายข้อมูลภาพต่อไป</p>\n<p>ที่มา - <a href=\"https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html\">Project Zero</a></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/security\">Security</a></div><div><a href=\"/topics/project-zero\">Project Zero</a></div><div><a href=\"/topics/ios\">iOS</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"6fe733b0e7332077a48fa0cc8afdcf61f9d1706e923513fe43a591cbbf17db00","category":"Thai"}