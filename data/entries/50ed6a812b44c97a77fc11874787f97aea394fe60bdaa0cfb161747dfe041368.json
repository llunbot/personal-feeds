{"title":"Introducing new capabilities to AWS CloudTrail Lake to enhance your cloud visibility and investigations","link":"https://aws.amazon.com/blogs/aws/introducing-new-capabilities-to-aws-cloudtrail-lake-to-enhance-your-cloud-visibility-and-investigations/","date":1732224491000,"content":"<p>Today, I’m excited to announce new updates to <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake.html\">AWS CloudTrail Lake</a>, which is a managed data lake you can use to aggregate, immutably store, and query events recorded by <a href=\"https://aws.amazon.com/cloudtrail/\">AWS CloudTrail</a> for auditing, security investigation, and operational troubleshooting.</p> \n<p>The new updates in CloudTrail Lake are:</p> \n<ul> \n <li>Enhanced filtering options for CloudTrail events</li> \n <li>Cross-account sharing of event data stores</li> \n <li>General availability of the generative AI–powered natural language query generation</li> \n <li>AI-powered query results summarization capability in preview</li> \n <li>Comprehensive dashboard capabilities, including a high-level overview dashboard with AI-powered insights (AI-powered insights is in preview), a suite of 14 pre-built dashboards for various use cases, and the ability to create custom dashboards with scheduled refreshes</li> \n</ul> \n<p>Let’s look into the new features one by one.</p> \n<p><span><strong>Enhanced filtering options for CloudTrail events ingested into event data stores</strong></span><br /> Enhanced event filtering capabilities give you greater control over which CloudTrail events are ingested into your event data stores. These enhanced filtering options provide tighter control over your AWS activity data, improving the efficiency and precision of security, compliance, and operational investigations. Additionally, the new filtering options help you reduce your analysis workflow costs by ingesting only the most relevant event data into your CloudTrail Lake event data stores.</p> \n<p>You can filter both management and data events based on attributes such as <code>eventSource</code>, <code>eventType</code>, <code>eventName</code>, <code>userIdentity.arn</code>, and <code>sessionCredentialFromConsole</code>.</p> \n<p>I go to the <a href=\"https://console.aws.amazon.com/cloudtrailv2\">AWS CloudTrail console</a> and choose <strong>Event data stores</strong> under <strong>Lake</strong> in the navigation pane. I choose <strong>Create event data store</strong>. In the first step, I enter a name in the <strong>Event data store name</strong> field. For this demo, I leave other fields as default. You can choose the pricing and retention options that suit your needs. In the next step, I choose <strong>Managements events</strong> and<strong> Data events</strong> under <strong>CloudTrail events</strong>. You can include all the options you need under <strong>CloudTrail events</strong>. You also have the option to choose ingestion options. I choose <strong>Ingest events </strong>to start ingesting when it’s created. There may be scenarios, when you want to deselect the <strong>Ingest events</strong> option to stop an event data store from ingesting events. For example, you may be copying trail events to the event data store and do not want the event data store to collect any future events. You can also choose to enable ingestion for all accounts in your organization or include only the current region in your event data store.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/01-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/01-LaunchMarketingIntake-1386.png\" width=\"1006\" height=\"912\" /></a></p> \n<p>The following example shows an out of the box template for filtering, which excludes any management events that are initiated by an AWS Service. I choose <strong>Advanced event collection</strong> under the <strong>Management events</strong>. I choose <strong>Exclude AWS service-initiated events</strong> from the <strong>Log selector template</strong> dropdown. You can also expand the <strong>JSON view</strong> to see how the filters actually apply.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/02-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/02-LaunchMarketingIntake-1386.png\" width=\"755\" height=\"929\" /></a></p> \n<p>Under the <strong>Data events</strong>, the following example creates a filter to include DynamoDB data events initiated by a certain user, helping me to log events based on an IAM principal. I choose <strong>DynamoDB</strong> as <strong>Resource type</strong>. I choose <strong>Custom</strong> as <strong>Log selector template</strong>. Under the <strong>Advanced event selector</strong>, I choose<b> userIdentity.arn</b> as <strong>Field </strong>and <strong>equals</strong> as <strong>Operator.</strong> I enter the user’s ARN<strong> </strong>as <strong>Value</strong>. I choose <strong>Next</strong> and choose <strong>Create event data store</strong> in the final step.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/15/12-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/15/12-LaunchMarketingIntake-1386.png\" width=\"1752\" height=\"1594\" /></a></p> \n<p>Now, I have my event data store that gives me granular control over the ingested CloudTrail data.</p> \n<p>This expanded set of filtering options helps you to be more selective in capturing only the most relevant events for your security, compliance, and operational needs.</p> \n<p><span><strong>Cross-account sharing of event data stores<br /> </strong></span>You can use the cross-account sharing feature of event data stores to enhance collaborative analysis within organizations. It enables secure sharing of event data stores with selected AWS principals through Resource-Based Policies (RBP). This functionality allows authorized entities to query shared event data stores within the same AWS Region where they were created. <span><strong><br /> </strong></span></p> \n<p>To use this feature, I go to the <a href=\"https://console.aws.amazon.com/cloudtrailv2\">AWS CloudTrail console</a> and choose <strong>Event data stores</strong> under <strong>Lake</strong> in the navigation pane. I choose an event data store from the list and navigate to its details page. I choose <strong>Edit</strong> in the <strong>Resource policy</strong> section. The following example policy includes a statement that allows root users in accounts 111111111111, 222222222222, and 333333333333 to run queries and get query results on the event data store owned by account ID 999999999999. I choose <strong>Save changes </strong>to save the policy.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/15/11a-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/15/11a-LaunchMarketingIntake-1386.png\" width=\"1676\" height=\"701\" /></a></p> \n<p><span><strong>Generative AI–powered natural language query generation in CloudTrail Lake is now generally available<br /> </strong></span>In June, we announced this feature for CloudTrail Lake in <a href=\"https://aws.amazon.com/blogs/aws/simplify-aws-cloudtrail-log-analysis-with-natural-language-query-generation-in-cloudtrail-lake-preview/\">preview</a>. With this launch, you can generate SQL queries using natural language questions to easily explore and analyze AWS activity logs (only management, data, and network activity events) without needing technical SQL expertise. The feature uses generative AI to convert natural language questions into ready-to-use SQL queries you can run directly in the CloudTrail Lake console. This simplifies the process of exploring event data stores and retrieving insights such as error counts, top services used, and the causes of errors. This feature is also accessible through the <a href=\"https://aws.amazon.com/cli/\">AWS Command Line Interface (AWS CLI)</a>, providing additional flexibility for users who prefer command-line operations. <a href=\"https://aws.amazon.com/blogs/aws/simplify-aws-cloudtrail-log-analysis-with-natural-language-query-generation-in-cloudtrail-lake-preview/\">The preview blog post</a> provides step-by-step instructions on how to get started with the natural language query generation feature in CloudTrail Lake.</p> \n<p><span><strong>CloudTrail Lake generative AI–powered query results summarization capability in preview<br /> </strong></span>Building on the capability of natural language query generation, we’re introducing a new AI-powered query results summarization feature in preview to further simplify the process of analyzing AWS account activity. With this feature, you can easily extract valuable insights from your AWS activity logs (only management, data, and network activity events) by automatically summarizing the key points from your query results in natural language, reducing the time and effort required to understand the information.</p> \n<p>To try this feature, I go to the <a href=\"https://console.aws.amazon.com/cloudtrailv2\">AWS CloudTrail console</a> and choose <strong>Query</strong> under <strong>Lake</strong> in the navigation pane. I choose an event data store for my CloudTrail Lake query from the dropdown list in <strong>Event data store</strong>. You can use summarization regardless of whether the query was written manually or generated by generative AI. For this example, I will use the natural language query generation capability. In the <strong>Query generator</strong>, I enter the following prompt in the <strong>Prompt</strong> field using natural language:</p> \n<p><code>How many errors were logged during the past month for each service and what was the cause of each error?</code></p> \n<p>Then, I choose <strong>Generate query</strong>. The following SQL query is automatically generated:</p> \n<pre><code>SELECT eventsource,\n    errorcode,\n    errormessage,\n    count(*) as errorcount\nFROM a0******\nWHERE eventtime &gt;= '2024-10-14 00:00:00'\n    AND eventtime &lt;= '2024-11-14 23:59:59'\n    AND (\n        errorcode IS NOT NULL\n        OR errormessage IS NOT NULL\n    )\nGROUP BY 1,\n    2,\n    3\nORDER BY 4 DESC;</code></pre> \n<p>I choose <strong>Run</strong> to get the results. To use the summarization capability, I choose <strong>Summarize results </strong>in the<strong> Query results </strong>tab. CloudTrail automatically analyzes the query results and provides a natural language summary of the key insights. It’s important to note that there’s a monthly quota of 3 MB for query results that can be summarized.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/04b-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/04b-LaunchMarketingIntake-1386.png\" width=\"1598\" height=\"1655\" /></a></p> \n<p>This new summarization capability can save you time and effort in understanding your AWS activity data by automatically generating meaningful summaries of the key findings.</p> \n<p><span><strong>Comprehensive dashboard capabilities<br /> </strong></span>Lastly, let me tell you about the new dashboard capabilities of CloudTrail Lake to enhance visibility and analysis across your AWS environments.</p> \n<p>The first one is a <strong>Highlights</strong> dashboard that provides you with an easy-to-view summary of the data captured in your CloudTrail Lake management and data events stored in event data stores. This dashboard makes it easier to quickly identify and understand important insights, such as the top failed API calls, trends in failed login attempts, and spikes in resource creation. It surfaces any anomalies or unusual trends in the data.</p> \n<p>I go to the <a href=\"https://console.aws.amazon.com/cloudtrailv2\">AWS CloudTrail console</a> and choose <strong>Dashboard</strong> under <strong>Lake</strong> in the navigation pane to check out the <strong>Highlights</strong> dashboard. First, I enable Highlights dashboard by choosing <strong>Agree and enable Highlights</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/10-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/10-LaunchMarketingIntake-1386.png\" width=\"1813\" height=\"523\" /></a></p> \n<p>I check out the Highlights dashboard once it populates with data.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/05-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/05-LaunchMarketingIntake-1386.png\" width=\"1849\" height=\"866\" /></a></p> \n<p>The second addition to the new dashboard capabilities is a suite of 14 pre-built dashboards. These dashboards are designed for different personas and use cases. For example, the security-focused dashboards help you to track and analyze key security indicators, such as top access denied events, failed console login attempts, and users who have disabled multi-factor authentication (MFA). There are also pre-built dashboards for operational monitoring, highlighting trends in errors and availability issues, such as top APIs with throttling errors and top users with errors. You can also use the dashboards focused on specific AWS services such as Amazon EC2 and <a href=\"https://aws.amazon.com/dynamodb/\">Amazon DynamoDB</a>, which help you identify security risks or operational problems within those particular service environments.</p> \n<p>You can create your own dashboards and optionally set schedules for refreshing them. This level of customization helps you tailor the CloudTrail Lake analysis capabilities to your precise monitoring and investigative needs across your AWS environments.</p> \n<p>I switch to the <strong>Managed and custom dashboards</strong> to observe the custom and pre-built dashboards.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/06-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/06-LaunchMarketingIntake-1386.png\" width=\"1674\" height=\"971\" /></a></p> \n<p>I choose <strong>IAM activity dashboard</strong> pre-built dashboard to observe overall IAM activity. You can choose <strong>Save as new dashboard</strong> to customize this dashboard.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/07-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/07-LaunchMarketingIntake-1386.png\" width=\"1845\" height=\"878\" /></a></p> \n<p>To create a custom dashboard from scratch, I go to <strong>Dashboard</strong> under <strong>Lake</strong> in the navigation pane and choose <strong>Build my own dashboard</strong>. I enter a name in the <strong>Enter a name for the</strong> <b>dashboard</b> field and choose event data stores under <strong>Permissions</strong>, to visualize the events. Next, I choose <strong>Create dashboard</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/08-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/08-LaunchMarketingIntake-1386.png\" width=\"1653\" height=\"841\" /></a></p> \n<p>Now, I can add widgets to my dashboard. You have the flexibility to customize your dashboards in multiple ways. You can select from a list of pre-built sample widgets using <strong>Add sample widget</strong>, or you can create your own custom widgets using <strong>Create new widget</strong>. For each widget, you can choose the type of visualization you prefer, such as a line graph, bar graph, or other options to best represent your data.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/09-LaunchMarketingIntake-1386.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/14/09-LaunchMarketingIntake-1386.png\" width=\"1830\" height=\"867\" /></a></p> \n<p><span><strong>Now available<br /> </strong></span>The new features in <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake.html\">AWS CloudTrail Lake</a> represent a major advancement in providing a comprehensive audit logging and analysis solution. These enhancements provide the ability to gain more profound understanding and conduct investigations more rapidly, assisting with more preventative monitoring and faster incident handling across your entire AWS environments.</p> \n<p>You can now start using generative <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/lake-query-generator.html\">AI–powered natural language query generation</a> in CloudTrail Lake in US East (N. Virginia), US West (Oregon), Asia Pacific (Mumbai), Asia Pacific (Sydney), Asia Pacific (Tokyo), Canada (Central), and Europe (London) <a href=\"https://docs.aws.amazon.com/glossary/latest/reference/glos-chap.html#region\">AWS Regions</a>.</p> \n<p>CloudTrail Lake generative AI–powered query results <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-results-summary.html\">summarization capability</a> is available in preview in US East (N. Virginia), US West (Oregon), and Asia Pacific (Tokyo) Regions.</p> \n<p><a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store-cloudtrail.html\">Enhanced filtering options</a>, <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html#security_iam_resource-based-policy-examples-eds\">cross-account sharing of event data stores</a> and <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/lake-dashboard.html\">dashboards</a> are available in all the Regions where <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake-supported-regions.html\">CloudTrail Lake is available</a>, with the exception of generative AI–powered summarization feature on the Highlights dashboard being available only in US East (N. Virginia), US West (Oregon), and Asia Pacific (Tokyo) Regions.</p> \n<p>Running queries will incur CloudTrail Lake query charges. For more details on pricing, visit <a href=\"https://aws.amazon.com/cloudtrail/pricing/\">AWS CloudTrail pricing</a>.</p> \n<p><a href=\"https://www.linkedin.com/in/esrakayabali/\">— Esra</a></p>","author":"Esra Kayabali","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"50ed6a812b44c97a77fc11874787f97aea394fe60bdaa0cfb161747dfe041368","category":"Tech"}