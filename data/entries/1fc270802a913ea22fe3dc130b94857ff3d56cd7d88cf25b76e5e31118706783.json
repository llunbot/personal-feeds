{"title":"CrowdStrike ออกรายงานวิเคราะห์บั๊กหยุดโลก ใส่พารามิเตอร์ให้ regular expression template ไม่ครบ","link":"https://www.blognone.com/node/141277","date":1722965716000,"content":"<div><div><div><p>CrowdStrike ออกรายงานวิเคราะห์ปัญหา Falcon Sensor <a href=\"https://www.blognone.com/node/140972\">ทำเครื่องคอมพิวเตอร์ทั่วโลกจอฟ้าเมื่อเดือนที่ผ่านมา</a> โดยระบุว่าเป็นปัญหาความไม่ตรงกันของซอฟต์แวร์ที่รัน และข้อมูลที่ต้องการตรวจสอบ</p>\n<p>ภายใน Falcon Sensor นั้นมีระบบหลักคือ Content Interpreter ซึ่งเป็นเอนจิน regular expression สำหร้บตรวจสอบข้อมูลช่องทางต่างๆ เอนจินนี้ทำหน้าที่ดึงข้อมูลจาก channel file ที่ได้รับอัพเดตมาเรื่อยๆ มาตรวจสอบว่าข้อมูลที่วิ่งผ่านช่องทางต่างๆ ตรงกับข้อมูลใน channel file หรือไม่</p>\n<p>ใน Falcon Sensor 7.11 ที่เริ่มใช้งานตั้งแต่เดือนกุมภาพันธ์ที่ผ่านมามีการเพิ่มช่องทางตรวจสอบเพิ่มเติมทาง Windows interprocess communication หรือ IPC เพื่อตรวจสอบการโจมตีผ่านการสื่อสารระหว่างโปรเซส เช่น named pipe ตัว IPC Template นี้ต้องการพารามิเตอร์ 21 รายการ แต่สามารถละรายการที่ 21 ไว้ได้ ถือว่าเป็น wildcard ก่อนหน้านี้ IPC Template ที่ใช้งานมา มีการใส่พารามิเตอร์เพียง 20 รายการเสมอ และโค้ดของ Content Interpreter กลับโค้ดไว้ว่า IPC Template ต้องการพารามิเตอร์ 20 ตัวเท่านั้น แม้จะไม่ตรงกันแต่ก็ทำงานมาได้เรื่อยๆ หลายเดือนเพราะพารามิตเตอร์ที่ 21 ใน template ก่อนหน้านี้เป็น optional</p>\n<p>เมื่อวันที่ 19 กรกฎาคมที่ผ่านมา ทาง CrowdStrike ปล่อย template ใหม่อีกสองตัว โดยตัวหนึ่งต้องการพารามิเตอร์ที่ 21 เสมอ ไม่สามารถละไว้ไม่กำหนดค่าได้ หลังจากคอมพิวเตอร์ที่ได้ channel file นี้พบ IPC notification ตัว Falcon Sensor ก็จะพยายามรัน template เหล่านี้เพื่อตรวจจับการบุกรุก</p>\n<p>จังหวะนี้ตัวเรนเดอร์ template พยายามดึงพารามิเตอร์ 21 ตัวตามที่จำเป็น ขณะที่ Content Interpreter เตรียมพารามิเตอร์ไว้ 20 ตัวเท่านั้น เมื่อดึงข้อมูลเกินจึงกลายเป็น out-of-bound memory ทันที เพราะตัวเรนเดอร์พยายามอ่านข้อมูลเกินพื้นที่ที่เตรียมไว้ และเคอร์เนลก็แครชไปกลายเป็นจอฟ้า</p>\n<p>กระบวนการทดสอบ channel file ก่อนปล่อยสู่ลูกค้านั้นมีการทดสอบหลายมิติ ทั้งระดับการใช้ทรัพยากรเครื่อง และอัตราการตรวจจับ แต่ไม่ได้ตรวจสอบใน Content Interpreter โดยรายงานได้ระบุถึงกระบวนการแก้ไขที่ทำไปแล้วและกำลังทำ เช่น การตรวจสอบว่าไม่มี template ใดๆ มีจำนวนพารามิเตอร์ไม่ตรงกันเช่นนี้อีก, กระบวนการตรวจสอบหลังจากนี้มีการตรวจสอบตรงกับการรันบนเครื่องจริงยิ่งขึ้น</p>\n<p>รายงานนี้ยังระบุว่าจะพยายามย้ายงานต่างๆ ออกจากเคอร์เนลไปรันระบบตรวจสอบบน user space แทนเพื่อลดปัญหาเช่นนี้อีกในอนาคต และจะทำงานร่วมกับไมโครซอฟท์เพื่อเพิ่มฟีเจอร์ที่จำเป็นสำหรับการรันซอฟต์แวร์ความปลอดภัยนอกเคอร์เนล</p>\n<p>ที่มา - <a href=\"https://www.crowdstrike.com/wp-content/uploads/2024/08/Channel-File-291-Incident-Root-Cause-Analysis-08.06.2024.pdf\">CrowdStrike</a></p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/8afbf6df7728cc101d91478193a7ee3c.jpeg\" /></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/crowdstrike\">CrowdStrike</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"1fc270802a913ea22fe3dc130b94857ff3d56cd7d88cf25b76e5e31118706783","category":"Thai"}