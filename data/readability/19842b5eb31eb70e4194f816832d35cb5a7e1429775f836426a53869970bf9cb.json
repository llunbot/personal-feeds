{"title":"Tip :: ทำการใส่ข้อมูลใน binary file สำหรับ Go","link":"https://www.somkiat.cc/tip-go-build-with-ldflags/","date":1638453943000,"content":"<div id=\"readability-page-1\" class=\"page\"><div id=\"page\"><article><div id=\"content_box\"><header><div><p><time>December 2, 2021</time> <span><a href=\"https://www.somkiat.cc/category/programming/\" rel=\"category tag\">Programming</a></span></p></div></header><div><figure><img src=\"https://www.somkiat.cc/wp-content/uploads/2021/11/go-worksapce.jpeg\" alt=\"\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2021/11/go-worksapce.jpeg 880w, https://www.somkiat.cc/wp-content/uploads/2021/11/go-worksapce-300x114.jpeg 300w, https://www.somkiat.cc/wp-content/uploads/2021/11/go-worksapce-768x291.jpeg 768w\" sizes=\"(max-width: 880px) 100vw, 880px\"></figure><p><strong>คำถาม</strong><br>ต้องการกำหนด version ต่าง ๆ ของ binary file<br>ที่ build มาจากภาษา Go จะทำได้ไหม ?</p><p><strong>คำตอบคือ ทำได้</strong><br>แล้วทำอย่างไร ?</p><p>ในการ build binary file ด้วย Go นั้น<br>สามารถส่งข้อมูลเข้าไปผ่าน <strong>parameter –ldflags</strong> เข้าไป<br>เพียงเท่านี้ก็สามารถจัดการได้แล้ว<br>ไม่ต้องไปกำหนดผ่าน environment variable หรือพวก config file ใด ๆ ทั้งสิ้น</p><p>ตัวอย่างดังนี้</p><div itemprop=\"text\" id=\"gist113371120\" translate=\"no\"><template><div data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg> <span>This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. <a href=\"https://github.co/hiddenchars\" target=\"_blank\">Learn more about bidirectional Unicode characters</a></span><div data-view-component=\"true\" class=\"flash-action\"><a href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\">Show hidden characters</a></div></div></template><template><span aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"bidi-line-alert tooltipped tooltipped-e\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg></span></template><table data-tab-size=\"8\" data-paste-markdown-skip=\"\" data-tagsearch-lang=\"Go\" data-tagsearch-path=\"main.go\"><tbody><tr><td id=\"file-main-go-L1\" data-line-number=\"1\"></td><td id=\"file-main-go-LC1\"><span>package</span> main</td></tr><tr><td id=\"file-main-go-L2\" data-line-number=\"2\"></td><td id=\"file-main-go-LC2\"></td></tr><tr><td id=\"file-main-go-L3\" data-line-number=\"3\"></td><td id=\"file-main-go-LC3\"><span>import</span> <span>\"fmt\"</span></td></tr><tr><td id=\"file-main-go-L4\" data-line-number=\"4\"></td><td id=\"file-main-go-LC4\"></td></tr><tr><td id=\"file-main-go-L5\" data-line-number=\"5\"></td><td id=\"file-main-go-LC5\"><span>var</span> (</td></tr><tr><td id=\"file-main-go-L6\" data-line-number=\"6\"></td><td id=\"file-main-go-LC6\"><span>mode</span> <span>=</span> <span>\"n/a\"</span></td></tr><tr><td id=\"file-main-go-L7\" data-line-number=\"7\"></td><td id=\"file-main-go-LC7\"><span>version</span> <span>=</span> <span>\"n/a\"</span></td></tr><tr><td id=\"file-main-go-L8\" data-line-number=\"8\"></td><td id=\"file-main-go-LC8\">)</td></tr><tr><td id=\"file-main-go-L9\" data-line-number=\"9\"></td><td id=\"file-main-go-LC9\"></td></tr><tr><td id=\"file-main-go-L10\" data-line-number=\"10\"></td><td id=\"file-main-go-LC10\"><span>func</span> <span>main</span>() {</td></tr><tr><td id=\"file-main-go-L11\" data-line-number=\"11\"></td><td id=\"file-main-go-LC11\"><span>fmt</span>.<span>Printf</span>(<span>\"mode=%s, version=%s<span>\\n</span>\"</span>, <span>mode</span>, <span>version</span>)</td></tr><tr><td id=\"file-main-go-L12\" data-line-number=\"12\"></td><td id=\"file-main-go-LC12\">}</td></tr></tbody></table></div><p>จากนั้นทำการ build ดังนี้</p><div itemprop=\"text\" id=\"gist113371120\" translate=\"no\"><template><div data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg> <span>This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters. <a href=\"https://github.co/hiddenchars\" target=\"_blank\">Learn more about bidirectional Unicode characters</a></span><div data-view-component=\"true\" class=\"flash-action\"><a href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\">Show hidden characters</a></div></div></template><template><span aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"bidi-line-alert tooltipped tooltipped-e\"><svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"><path fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"></path></svg></span></template><table data-tab-size=\"8\" data-paste-markdown-skip=\"\" data-tagsearch-lang=\"Text\" data-tagsearch-path=\"1.txt\"><tbody><tr><td id=\"file-1-txt-L1\" data-line-number=\"1\"></td><td id=\"file-1-txt-LC1\">// Build without parameter --ldflags</td></tr><tr><td id=\"file-1-txt-L2\" data-line-number=\"2\"></td><td id=\"file-1-txt-LC2\">$go build -o main</td></tr><tr><td id=\"file-1-txt-L3\" data-line-number=\"3\"></td><td id=\"file-1-txt-LC3\">$main</td></tr><tr><td id=\"file-1-txt-L4\" data-line-number=\"4\"></td><td id=\"file-1-txt-LC4\">mode=n/a, version=n/a</td></tr><tr><td id=\"file-1-txt-L5\" data-line-number=\"5\"></td><td id=\"file-1-txt-LC5\"></td></tr><tr><td id=\"file-1-txt-L6\" data-line-number=\"6\"></td><td id=\"file-1-txt-LC6\"></td></tr><tr><td id=\"file-1-txt-L7\" data-line-number=\"7\"></td><td id=\"file-1-txt-LC7\">// Build with parameter --ldflags</td></tr><tr><td id=\"file-1-txt-L8\" data-line-number=\"8\"></td><td id=\"file-1-txt-LC8\">$go build -o main --ldflags \"-X 'main.mode=dev' -X 'main.version=1.0'\"</td></tr><tr><td id=\"file-1-txt-L9\" data-line-number=\"9\"></td><td id=\"file-1-txt-LC9\">$main</td></tr><tr><td id=\"file-1-txt-L10\" data-line-number=\"10\"></td><td id=\"file-1-txt-LC10\">mode=dev, version=1.0</td></tr></tbody></table></div><p>ส่วนใน <a href=\"https://github.com/golang/go/issues/37693\" target=\"_blank\" rel=\"noreferrer noopener\">Go 1.18 สามารถใช้ add version จาก git commit ได้เลย</a></p></div><div><p><img alt=\"\" src=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=90&amp;d=mm&amp;r=g\" srcset=\"https://secure.gravatar.com/avatar/e5cb9aad7bf4f0e43462bd51d6ff7021?s=180&amp;d=mm&amp;r=g 2x\" height=\"90\" width=\"90\"></p><h4>Article by <a href=\"https://www.facebook.com/somkiatspns\">Somkiat Puisungnoen</a></h4><p>To be Craftmanship</p></div></div></article></div></div>","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"19842b5eb31eb70e4194f816832d35cb5a7e1429775f836426a53869970bf9cb","category":"Thai"}