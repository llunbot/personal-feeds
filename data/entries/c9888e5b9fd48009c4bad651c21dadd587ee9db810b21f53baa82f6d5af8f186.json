{"title":"DNS over HTTPS is now available in Amazon Route 53 Resolver","link":"https://aws.amazon.com/blogs/aws/dns-over-https-is-now-available-in-amazon-route-53-resolver/","date":1703096274000,"content":"<p>Starting today, <a href=\"https://aws.amazon.com/route53/resolver/\">Amazon Route 53 Resolver</a> supports using the <a href=\"https://datatracker.ietf.org/doc/html/rfc8484\">DNS over HTTPS (DoH)</a> protocol for both inbound and outbound Resolver endpoints. As the name suggests, DoH supports HTTP or HTTP/2 over TLS to encrypt the data exchanged for Domain Name System (DNS) resolutions.</p> \n<p>Using TLS encryption, DoH increases privacy and security by preventing eavesdropping and manipulation of DNS data as it is exchanged between a DoH client and the DoH-based DNS resolver.</p> \n<p>This helps you implement a zero-trust architecture where no actor, system, network, or service operating outside or within your security perimeter is trusted and all network traffic is encrypted. Using DoH also helps follow recommendations such as those described in <a href=\"https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf\">this memorandum of the US Office of Management and Budget (OMB)</a>.</p> \n<p><span><strong>DNS over HTTPS support in Amazon Route 53 Resolver<br /> </strong></span>You can use Amazon Route 53 Resolver to resolve DNS queries in hybrid cloud environments. For example, it allows AWS services access for DNS requests from anywhere within your hybrid network. To do so, you can set up inbound and outbound Resolver endpoints:</p> \n<ul> \n <li>Inbound Resolver endpoints allow DNS queries to your VPC from your on-premises network or another VPC.<a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/01/route-53-doh-resolver-inbound.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/01/route-53-doh-resolver-inbound.png\" alt=\"Amazon Route 53 Resolver inbound endpoint architecture.\" width=\"1500\" height=\"634\" /></a></li> \n <li>Outbound Resolver endpoints allow DNS queries from your VPC to your on-premises network or another VPC.<a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/01/route-53-doh-resolver-outbound.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/01/route-53-doh-resolver-outbound.png\" alt=\"Amazon Route 53 Resolver outbound endpoint architecture.\" width=\"1500\" height=\"634\" /></a></li> \n</ul> \n<p>After you configure the Resolver endpoints, you can set up rules that specify the name of the domains for which you want to forward DNS queries from your VPC to an on-premises DNS resolver (outbound) and from on-premises to your VPC (inbound).</p> \n<p>Now, when you create or update an inbound or outbound Resolver endpoint, you can specify which protocols to use:</p> \n<ul> \n <li>DNS over port 53 (<strong>Do53</strong>), which is using either UDP or TCP to send the packets.</li> \n <li>DNS over HTTPS (<strong>DoH</strong>), which is using TLS to encrypt the data.</li> \n <li>Both, depending on which one is used by the DNS client.</li> \n <li>For <a href=\"https://aws.amazon.com/compliance/fips/\">FIPS compliance</a>, there is a specific implementation (<strong>DoH-FIPS</strong>) for inbound endpoints.</li> \n</ul> \n<p>Let’s see how this works in practice.</p> \n<p><span><strong>Using DNS over HTTPS with Amazon Route 53 Resolver</strong></span><br /> In the <a href=\"https://console.aws.amazon.com/route53\">Route 53 console</a>, I choose <strong>Inbound endpoints</strong> from the <strong>Resolver</strong> section of the navigation pane. There, I choose <strong>Create inbound endpoint</strong>.</p> \n<p>I enter a name for the endpoint, select the VPC, the security group, and the endpoint type (IPv4, IPv6, or dual-stack). To allow using both encrypted and unencrypted DNS resolutions, I select <strong>Do53</strong>, <strong>DoH</strong>, and <strong>DoH-FIPS</strong> in the <strong>Protocols for this endpoint</strong> option.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/13/route-53-doh-resolver-1.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/12/13/route-53-doh-resolver-1.png\" alt=\"Console screenshot.\" width=\"1582\" height=\"1444\" /></a></p> \n<p>After that, I configure the IP addresses for DNS queries. I select two <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/\">Availability Zones</a> and, for each, a subnet. For this setup, I use the option to have the IP addresses automatically selected from those available in the subnet.</p> \n<p>After I complete the creation of the inbound endpoint, I configure the DNS server in my network to forward requests for the <code>amazonaws.com</code> domain (used by <a href=\"https://docs.aws.amazon.com/general/latest/gr/rande.html\">AWS service endpoints</a>) to the inbound endpoint IP addresses.</p> \n<p>Similarly, I create an outbound Resolver endpoint and and select both <strong>Do53</strong> and <strong>DoH</strong> as protocols. Then, I create forwarding rules that tell for which domains the outbound Resolver endpoint should forward requests to the DNS servers in my network.</p> \n<p>Now, when the DNS clients in my hybrid environment use DNS over HTTPS in their requests, DNS resolutions are encrypted. Optionally, I can enforce encryption and select only <strong>DoH</strong> in the configuration of inbound and outbound endpoints.</p> \n<p><span><strong>Things to know<br /> </strong></span>DNS over HTTPS support for <a href=\"https://aws.amazon.com/route53/resolver/\">Amazon Route 53 Resolver</a> is available today in all <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/\">AWS Regions</a> where Route 53 Resolver is offered, including GovCloud Regions and Regions based in China.</p> \n<p>DNS over port 53 continues to be the default for inbound or outbound Resolver endpoints. In this way, you don’t need to update your existing automation tooling unless you want to adopt DNS over HTTPS.</p> \n<p>There is no additional cost for using DNS over HTTPS with Resolver endpoints. For more information, see <a href=\"https://aws.amazon.com/route53/pricing/\">Route 53 pricing</a>.</p> \n<p><a href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver-getting-started.html\"><strong>Start using DNS over HTTPS with Amazon Route 53 Resolver to increase privacy and security for your hybrid cloud environments.</strong></a></p> \n<p>— <a href=\"https://twitter.com/danilop\">Danilo</a></p>","author":"Danilo Poccia","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"c9888e5b9fd48009c4bad651c21dadd587ee9db810b21f53baa82f6d5af8f186","category":"Tech"}