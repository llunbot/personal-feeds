{"title":"Firewall support for AWS Amplify hosted sites","link":"https://aws.amazon.com/blogs/aws/firewall-support-for-aws-amplify-hosted-sites/","date":1743019515000,"content":"<p>Today, we’re announcing the general availability of the <a href=\"https://aws.amazon.com/waf\">AWS WAF</a> integration with <a href=\"https://aws.amazon.com/amplify/hosting/?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">AWS Amplify Hosting</a>.</p> \n<p>Web application owners are constantly working to protect their applications from a variety of threats. Previously, if you wanted to implement a robust security posture for your Amplify Hosted applications, you needed to create architectures using <a href=\"https://aws.amazon.com/cloudfront/\">Amazon CloudFront</a> distributions with AWS WAF protection, which required additional configuration steps, expertise, and management overhead.</p> \n<p>With the general availability of AWS WAF in Amplify Hosting, you can now directly attach a web application firewall to your <a href=\"https://aws.amazon.com/amplify/?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">AWS Amplify</a> apps through a one-click integration in the <a href=\"https://console.aws.amazon.com/amplify/?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">Amplify console</a> or using infrastructure as code (IaC). This integration gives you access to the full range of AWS WAF capabilities including managed rules, which provide protection against common web exploits and vulnerabilities like SQL injection and cross-site scripting (XSS). You can also create your own custom rules based on your specific application needs.</p> \n<p>This new capability helps you implement defense-in-depth security strategies for your web applications. You can take advantage of AWS WAF rate-based rules to protect against distributed denial of service (DDoS) attacks by limiting the rate of requests from IP addresses. Additionally, you can implement geo-blocking to restrict access to your applications from specific countries, which is particularly valuable if your service is designed for specific geographic regions.</p> \n<p><span><strong>Let’s see how it works<br /> </strong></span>Setting up AWS WAF protection for your Amplify app is straightforward. From the Amplify console, navigate to your app settings, select the <strong>Firewall</strong> tab, and choose the predefined rules you want to apply to your configuration. <a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/10/2025-03-10_14-58-20.png\"><img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/10/2025-03-10_14-58-20-1024x656.png\" alt=\"AWS WAF integration in AWS Amplify Hosting\" width=\"800\" height=\"512\" /></a></p> \n<p>Amplify hosting simplifies configuring firewall rules. You can activate four categories of protection.</p> \n<ul> \n <li><strong>Amplify-recommended firewall protection</strong> – Protect against the most common vulnerabilities found in web applications, block IP addresses from potential threats based on Amazon internal threat intelligence, and protect against malicious actors discovering application vulnerabilities.</li> \n <li><strong>Restrict access to amplifyapp.com</strong> – Restrict access to the default Amplify generated amplifyapp.com domain. This is useful when you add a custom domain to prevent bots and search engines from crawling the domain.</li> \n <li><strong>Enable IP address protection</strong> – Restrict web traffic by allowing or blocking requests from specified IP address ranges.</li> \n <li><strong>Enable country protection</strong> – Restrict access based on specific countries.</li> \n</ul> \n<p>Protections enabled through the Amplify console will create an underlying <a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">web access control list (ACL)</a> in your AWS account. For fine-grained rulesets, you can use the AWS WAF console rule builder.</p> \n<p>After a few minutes, the rules are associated to your app and AWS WAF blocks suspicious requests.</p> \n<p>If you want to see AWS WAF in action, you can simulate an attack and monitor it using the AWS WAF request inspection capabilities. For example, you can send a request with an empty User-Agent value. It will trigger a blocking rule in AWS WAF.</p> \n<p>Let’s first send a valid request to my app.</p> \n<pre><code>curl -v -H \"User-Agent: MyUserAgent\" https://main.d3sk5bt8rx6f9y.amplifyapp.com/\n* Host main.d3sk5bt8rx6f9y.amplifyapp.com:443 was resolved.\n...(redacted for brevity)...\n&gt; GET / HTTP/2\n&gt; Host: main.d3sk5bt8rx6f9y.amplifyapp.com\n&gt; Accept: */*\n&gt; User-Agent: MyUserAgent\n&gt; \n* Request completely sent off\n&lt; HTTP/2 200 \n&lt; content-type: text/html\n&lt; content-length: 0\n&lt; date: Mon, 10 Mar 2025 14:45:26 GMT\n \n</code></pre> \n<p>We can observe that the server returned an HTTP 200 (OK) message.</p> \n<p>Then, send a request with no value associated to the User-Agent HTTP header.</p> \n<pre><code> curl -v -H \"User-Agent: \" https://main.d3sk5bt8rx6f9y.amplifyapp.com/ \n* Host main.d3sk5bt8rx6f9y.amplifyapp.com:443 was resolved.\n... (redacted for brevity) ...\n&gt; GET / HTTP/2\n&gt; Host: main.d3sk5bt8rx6f9y.amplifyapp.com\n&gt; Accept: */*\n&gt; \n* Request completely sent off\n&lt; HTTP/2 403 \n&lt; server: CloudFront\n... (redacted for brevity) ...\n&lt;TITLE&gt;ERROR: The request could not be satisfied&lt;/TITLE&gt;\n&lt;/HEAD&gt;&lt;BODY&gt;\n&lt;H1&gt;403 ERROR&lt;/H1&gt;\n&lt;H2&gt;The request could not be satisfied.&lt;/H2&gt;</code></pre> \n<p>We can observe that the server returned an HTTP 403 (Forbidden) message.</p> \n<p>AWS WAF provide visibility into request patterns, helping you fine-tune your security settings over time. You can access logs through Amplify Hosting or the AWS WAF console to analyze traffic trends and refine security rules as needed.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/10/2025-03-10_15-52-58.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/10/2025-03-10_15-52-58-1024x422.png\" alt=\"AWS WAF integration in AWS Amplify Hosting - Dashboard\" width=\"1024\" height=\"422\" /></a></p> \n<p><span><strong>Availability and pricing<br /> </strong></span>Firewall support is available in all <a href=\"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/\">AWS Regions</a> in which Amplify Hosting operates. This integration falls under an AWS WAF global resource, similar to Amazon CloudFront. Web ACLs can be attached to multiple Amplify Hosting apps, but they must reside in the same Region.</p> \n<p>The pricing for this integration follows the standard <a href=\"https://aws.amazon.com/waf/pricing/?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">AWS WAF pricing model</a>, You pay for the AWS WAF resources you use based on the number of web ACLs, rules, and requests. On top of that, AWS Amplify Hosting adds $15/month when you attach a web application firewall to your application. This is prorated by the hour.</p> \n<p>This new capability brings enterprise-grade security features to all Amplify Hosting customers, from individual developers to large enterprises. You can now build, host, and protect your web applications within the same service, reducing the complexity of your architecture and streamlining your security management.</p> \n<p>To learn more, visit the <a href=\"https://docs.aws.amazon.com/amplify/latest/userguide/WAF-integration.html?trk=4b29643c-e00f-4ab6-ab9c-b1fb47aa1708&amp;sc_channel=el\">AWS WAF integration documentation for Amplify</a> or try it directly in the Amplify console.</p> \n<a href=\"https://linktr.ee/sebsto\">— seb</a> \n<hr /> \n<p>How is the News Blog doing? Take this <a href=\"https://amazonmr.au1.qualtrics.com/jfe/form/SV_eyD5tC5xNGCdCmi\">1 minute survey</a>!</p> \n<p><em>(This <a href=\"https://amazonmr.au1.qualtrics.com/jfe/form/SV_eyD5tC5xNGCdCmi\">survey</a> is hosted by an external company. AWS handles your information as described in the <a href=\"https://aws.amazon.com/privacy/\">AWS Privacy Notice</a>. AWS will own the data gathered via this survey and will not share the information collected with survey respondents.)</em></p>","author":"Sébastien Stormacq","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"d37fffbe0bc470ab0fbf690586fa1544103e626936ace01d48b26be0f5991360","category":"Tech"}