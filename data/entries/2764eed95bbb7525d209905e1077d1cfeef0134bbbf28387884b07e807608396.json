{"title":"Amazon API Gateway now supports dual-stack (IPv4 and IPv6) endpoints","link":"https://aws.amazon.com/blogs/aws/amazon-api-gateway-now-supports-dual-stack-ipv4-and-ipv6-endpoints/","date":1743450602000,"content":"<p>Today, we are launching IPv6 support for <a href=\"https://aws.amazon.com/api-gateway/?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el\">Amazon API Gateway</a> across all endpoint types, custom domains, and management APIs, in all commercial and AWS GovCloud (US) Regions. You can now configure REST, HTTP, and WebSocket APIs, and custom domains, to accept calls from IPv6 clients alongside the existing IPv4 support. You can also call API Gateway management APIs from dual-stack (IPv6 and IPv4) clients. As organizations globally confront growing IPv4 address scarcity and increasing costs, implementing IPv6 becomes critical for future-proofing network infrastructure. This dual-stack approach helps organizations maintain future network compatibility and expand global reach. To learn more about dualstack in the Amazon <a href=\"https://aws.amazon.com/?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el\">Web Services (AWS)</a> environment, see the <a href=\"https://docs.aws.amazon.com/whitepapers/latest/ipv6-on-aws/IPv6-on-AWS.html\">IPv6 on AWS</a> documentation.</p> \n<p><strong><u>Creating new dual-stack resources</u></strong></p> \n<p>This post focuses on two ways to create an API or a domain name with a dualstack IP address type: <a href=\"https://aws.amazon.com/console/?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el\">AWS Management Console</a> and <a href=\"https://aws.amazon.com/cdk/?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el\">AWS Cloud Development Kit (CDK).</a></p> \n<p><strong>AWS Console</strong></p> \n<p>When creating a new API or domain name in the console, select IPv4 only or dualstack (IPv4 and IPv6) for the IP address type.</p> \n<p>As shown in the following image, you can select the dualstack option when creating a new REST API.<a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/create-rest-api.png\"><br /> <img src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/create-rest-api.png\" alt=\"\" width=\"1032\" height=\"752\" /></a>For custom domain names, you can similarly configure dualstack as shown in the next image.<a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/custom-domain-dualstack-create.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/custom-domain-dualstack-create.png\" alt=\"\" width=\"1043\" height=\"719\" /></a></p> \n<p>If you need to revert to IPv4-only for any reason, you can modify the IP address type setting, with no need to redeploy your API for the update to take effect.<br /> <a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/change-to-ipv4.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2025/03/22/change-to-ipv4.png\" alt=\"\" width=\"1035\" height=\"752\" /></a></p> \n<p>REST APIs of all endpoint types (EDGE, REGIONAL and PRIVATE) support dualstack. Private REST APIs only support dualstack configuration.</p> \n<p><strong>AWS CDK </strong></p> \n<p>With AWS CDK, start by configuring a dual-stack REST API and domain name.</p> \n<div> \n <pre><code>const api = new apigateway.RestApi(this, \"Api\", {\n  restApiName: \"MyDualStackAPI\",\n  endpointConfiguration: {ipAddressType: \"dualstack\"}\n});\n\nconst domain_name = new apigateway.DomainName(this, \"DomainName\", {\n  regionalCertificateArn: 'arn:aws:acm:us-east-1:111122223333:certificate/a1b2c3d4-5678-90ab',\n  domainName: 'dualstack.example.com',\n  endpointConfiguration: {\n    types: ['Regional'],\n    ipAddressType: 'dualstack'\n  },\n  securityPolicy: 'TLS_1_2'\n});\n\nconst basepathmapping = new apigateway.BasePathMapping(this, \"BasePathMapping\", {\n  domainName: domain_name,\n  restApi: api\n});</code></pre> \n</div> \n<p><strong><u>IPv6 Source IP and authorization</u></strong></p> \n<p>When your API begins receiving IPv6 traffic, client source IPs will be in IPv6 format. If you use resource policies, Lambda authorizers, or <a href=\"https://aws.amazon.com/iam/?nc2=type_a?trk=d21a4eb6-d91f-4286-843a-d35b2a06a274&amp;sc_channel=el\">AWS Identity and Access Management (IAM)</a> policies that reference source IP addresses, make sure they’re updated to accommodate IPv6 address formats.</p> \n<p>For example, to permit traffic from a specific IPv6 range in a resource policy.</p> \n<div> \n <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": \"*\",\n      \"Action\": \"execute-api:Invoke\",\n      \"Resource\": \"execute-api:stage-name/*\",\n      \"Condition\": {\n        \"IpAddress\": {\n          \"aws:SourceIp\": [\n            \"192.0.2.0/24\",\n            \"2001:db8:1234::/48\"\n          ]\n        }\n      }\n    }\n  ]\n}</code></pre> \n</div> \n<p><strong>Summary</strong></p> \n<p>API Gateway dual-stack support helps manage IPv4 address scarcity and costs, comply with government and industry mandates, and prepare for the future of networking. The dualstack implementation provides a smooth transition path by supporting both IPv4 and IPv6 clients simultaneously.</p> \n<p>To get started with API Gateway dual-stack support, visit the <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-ip-address-type.html\">Amazon API Gateway</a> documentation. You can configure dualstack for new APIs or update existing APIs with minimal configuration changes.</p> \n<p>–<a href=\"http://www.linkedin.com/in/zhengyubin714\">Betty</a></p> \n<p><strong><em>Special thanks to Ellie Frank (elliesf), Anjali Gola (anjaligl), and Pranika Kakkar (pranika) for providing resources, answering questions, and offering valuable feedback during the writing process. This blog post was made possible through the collaborative support of the service and product management teams.</em></strong></p> \n<hr /> \n<p>How is the News Blog doing? Take this <a href=\"https://amazonmr.au1.qualtrics.com/jfe/form/SV_eyD5tC5xNGCdCmi\">1 minute survey</a>!</p> \n<p><em>(This <a href=\"https://amazonmr.au1.qualtrics.com/jfe/form/SV_eyD5tC5xNGCdCmi\">survey</a> is hosted by an external company. AWS handles your information as described in the <a href=\"https://aws.amazon.com/privacy/\">AWS Privacy Notice</a>. AWS will own the data gathered via this survey and will not share the information collected with survey respondents.)</em></p>","author":"Betty Zheng (郑予彬)","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"2764eed95bbb7525d209905e1077d1cfeef0134bbbf28387884b07e807608396","category":"Tech"}