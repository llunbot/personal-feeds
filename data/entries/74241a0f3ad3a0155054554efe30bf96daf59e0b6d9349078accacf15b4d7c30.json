{"title":"PoC :: ลองจัดการรูปแบบข้อมูลชนิด Floating-point","link":"https://www.somkiat.cc/poc-floating-format-with-json/","date":1687954369000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2023/06/go-floating-json-150x150.png\" alt loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2023/06/go-floating-json-150x150.png 150w, https://www.somkiat.cc/wp-content/uploads/2023/06/go-floating-json-75x75.png 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2023/06/go-floating-json.png\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2023/06/go-floating-json-1024x579.png\" alt width=\"694\" height=\"391\" /></a></figure>\n\n\n\n<p>ปัญหาที่เจอคือ <br />ต้องการให้ REST API ทำการ return ข้อมูลในรูปแบบของ JSON<br />โดย property ที่มี data type คือ float<br />ต้องการให้มีหลักหลังจุดทศนิยมตามที่เรากำหนด<br />จะต้องทำอย่างไร</p>\n\n\n\n<span></span>\n\n\n\n<p>ยกตัวอย่างเช่น</p>\n\n\n\n<ul>\n<li>50 =&gt; 50.00</li>\n\n\n\n<li>50.0 =&gt; 50.00</li>\n\n\n\n<li>50.1 =&gt; 50.10</li>\n</ul>\n\n\n\n<p>ตัวอย่างของข้อมูลที่ return จาก REST API เป็นดังนี้</p>\n\n\n\n[gist id=\"c0113fcc8427bc973c639170a65c0fb4\" file=\"1.json\"]\n\n\n\n<p><strong>ดังนั้นจึงต้องเขียน code มาเพื่อแก้ไขปัญหานี้หน่อย</strong></p>\n\n\n\n<p>ปกติถ้าเป็น float นั้น ถ้าเรากำหนดค่า 50.10 ไป ผลที่ได้ใน JSON คือ 50.1 <br />แน่นอนว่า ทำงานไม่เป็นไปตามที่เราต้องการ</p>\n\n\n\n<p>ดังนั้นจึงทำการแก้ไขด้วยการ <a href=\"https://cs.opensource.google/go/go/+/refs/tags/go1.21rc2:src/encoding/json/encode.go\">implement MarshalJSON() จาก interface Marshaler</a><br />สำหรับ type ต่าง ๆ นั่นเอง<br />เพื่อกำหนดรูปแบบของ float นั่นเอง<br />ยกตัวอย่างเช่น</p>\n\n\n\n[gist id=\"c0113fcc8427bc973c639170a65c0fb4\" file=\"2.go\"]\n\n\n\n<p>จากนั้นก็ลองใช้งาน type Amount กันดู แบบง่าย ๆ<br />เพื่อจัดรูปแบบของ float ให้มี 2 ตำแหน่งหลังจุดทศนิยมเสมอ</p>\n\n\n\n[gist id=\"c0113fcc8427bc973c639170a65c0fb4\" file=\"main.go\"]\n\n\n\n<p>เป็นอีกหนึ่งแนวทางง่าย ๆ ที่น่าสนใจ</p>\n\n\n\n<p>ขอให้สนุกกับการ coding ครับ</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"74241a0f3ad3a0155054554efe30bf96daf59e0b6d9349078accacf15b4d7c30","category":"Thai"}