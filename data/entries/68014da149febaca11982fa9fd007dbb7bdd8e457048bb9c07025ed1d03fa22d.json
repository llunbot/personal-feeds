{"title":"Installing HashiCorp tools in Alpine Linux containers","link":"https://www.hashicorp.com/blog/installing-hashicorp-tools-in-alpine-linux-containers","date":1707753600000,"content":"<p>Many container images use <a href=\"https://alpinelinux.org/\">Alpine Linux</a> as their base operating system. When you build your own container image, you include the installation of packages in a Dockerfile (Containerfile). While you can use the <a href=\"https://hub.docker.com/u/hashicorp\">official container images</a> for HashiCorp tools, you may need to build your own container image with additional dependencies to apply HashiCorp Terraform in a CI/CD pipeline, run HashiCorp Vault or Consul on a workload orchestrator, or deploy HashiCorp Boundary in containers.</p>\n\n<p>This post demonstrates how to install the official release binaries for HashiCorp tools on Alpine Linux for container images. We’re sharing these instructions because although HashiCorp supports official repositories for many <a href=\"https://www.hashicorp.com/official-packaging-guide\">operating systems and distributions</a>, including various Linux distributions, Alpine Linux users must download the tools from precompiled binaries on the <a href=\"https://releases.hashicorp.com/\">HashiCorp release site</a>. The binaries are not available through <a href=\"https://docs.alpinelinux.org/user-handbook/0.1a/Working/apk.html\">Alpine Package Keeper</a>.</p>\n\n<h2>Build a container image</h2>\n\n<p>You can download the binary for any HashiCorp tool on the <a href=\"https://releases.hashicorp.com/\">HashiCorp release site</a>. Use the release site to download a specific product and its version for a given operating system and architecture. For Alpine Linux, use the product binary compiled for Linux AMD64:</p>\n<pre><code>FROM alpine:latest\n\nARG PRODUCT\nARG VERSION\n\nRUN apk add --update --virtual .deps --no-cache gnupg &amp;&amp; \\\n    cd /tmp &amp;&amp; \\\n    wget https://releases.hashicorp.com/${PRODUCT}/${VERSION}/${PRODUCT}_${VERSION}_linux_amd64.zip &amp;&amp; \\\n    wget https://releases.hashicorp.com/${PRODUCT}/${VERSION}/${PRODUCT}_${VERSION}_SHA256SUMS &amp;&amp; \\\n    wget https://releases.hashicorp.com/${PRODUCT}/${VERSION}/${PRODUCT}_${VERSION}_SHA256SUMS.sig &amp;&amp; \\\n    wget -qO- https://www.hashicorp.com/.well-known/pgp-key.txt | gpg --import &amp;&amp; \\\n    gpg --verify ${PRODUCT}_${VERSION}_SHA256SUMS.sig ${PRODUCT}_${VERSION}_SHA256SUMS &amp;&amp; \\\n    grep ${PRODUCT}_${VERSION}_linux_amd64.zip ${PRODUCT}_${VERSION}_SHA256SUMS | sha256sum -c &amp;&amp; \\\n    unzip /tmp/${PRODUCT}_${VERSION}_linux_amd64.zip -d /tmp &amp;&amp; \\\n    mv /tmp/${PRODUCT} /usr/local/bin/${PRODUCT} &amp;&amp; \\\n    rm -f /tmp/${PRODUCT}_${VERSION}_linux_amd64.zip ${PRODUCT}_${VERSION}_SHA256SUMS ${VERSION}/${PRODUCT}_${VERSION}_SHA256SUMS.sig &amp;&amp; \\\n    apk del .deps</code></pre><p>The example Dockerfile includes <a href=\"https://docs.docker.com/build/guide/build-args/\">build arguments</a> for the product and version. Use these arguments to install the HashiCorp tool of your choice. For example, you can use this Dockerfile to create an Alpine Linux base image with Terraform version 1.7.2:</p>\n<pre><code>docker build --build-arg PRODUCT=terraform \\\n--build-arg VERSION=1.7.2 \\\n-t joatmon08/terraform:test .</code></pre><p>You can run a container with the new Terraform base image and issue Terraform commands:</p>\n<pre><code>$ docker run -it joatmon08/terraform:test terraform -help\n\nUsage: terraform [global options]  [args]\n\nThe available commands for execution are listed below.\nThe primary workflow commands are given first, followed by\nless common or more advanced commands.\n\nMain commands:\n  init          Prepare your working directory for other commands\n  validate      Check whether the configuration is valid\n  plan          Show changes required by the current configuration\n  apply         Create or update infrastructure\n  destroy       Destroy previously-created infrastructure\n\n## omitted for clarity</code></pre><p>The example Dockerfile includes commands to download the release’s <a href=\"https://www.hashicorp.com/trust/security\">checksum and signature</a>. Use the signature to verify the checksum and the checksum to validate the archive file. This workflow requires the <a href=\"https://pkgs.alpinelinux.org/package/edge/main/ppc64le/gnupg\">gnupg</a> package to verify HashiCorp’s signature on the checksum. The Dockerfile installs gnupg and deletes it after installing the release.</p>\n\n<p>While the example Dockerfile verifies and installs a product’s official release binary, it does not include dependencies to run the binary. For example, HashiCorp Nomad requires additional packages such as <a href=\"https://wiki.alpinelinux.org/wiki/Running_glibc_programs\">gcompat</a>. Be sure to install any additional dependencies that your tools require in your container image before running a container for it.</p>\n\n<h2>Learn more</h2>\n\n<p>If you need to use a HashiCorp tool in your own container, download and unarchive the appropriate release binaries from our release site. Include verification of the signature and a checksum for the download to ensure its integrity. This installation and verification workflow applies to any Linux distribution that does not include HashiCorp software in its package repository.</p>\n\n<p>Refer to <a href=\"https://developer.hashicorp.com/well-architected-framework/operational-excellence/verify-hashicorp-binary\">Verify HashiCorp binary downloads</a> to learn more about downloading and verifying HashiCorp release binaries and building container images with HashiCorp tools.</p>\n\n<p>Review our <a href=\"https://www.hashicorp.com/official-release-channels\">official release channels</a> to download and install HashiCorp products on other platforms and architectures. We release <a href=\"https://hub.docker.com/u/hashicorp\">official container images for each product in DockerHub</a> under the HashiCorp namespace.</p>\n","author":"Rosemary Wang","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"68014da149febaca11982fa9fd007dbb7bdd8e457048bb9c07025ed1d03fa22d","category":"Tech"}