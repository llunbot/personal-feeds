{"title":"Ruby on Rails 7.0 ออกแล้ว ปรับโครงสร้างครั้งใหญ่ ไม่ต้องพึ่งพา Node.js อีกต่อไป","link":"https://www.blognone.com/node/126382","date":1639870935000,"content":"<div><div><div><p>Ruby on Rails ออกเวอร์ชันใหญ่ 7.0 ซึ่งมีการเปลี่ยนแปลงสำคัญ 2 เรื่องคือ ไม่ต้องผูกกับโลกของ Node.js อีกแล้ว และเปลี่ยนระบบ front-end มาเป็นตัวใหม่คือ <a href=\"https://hotwired.dev/\">Hotwire</a></p>\n<p>David Heinemeier Hansson หรือ DHH ผู้สร้าง Rails อธิบายว่าโครงสร้างของภาษา JavaScript ในอดีตเป็นปัญหาของโปรแกรมเมอร์มาก ทางออกจึงเป็นการเขียนภาษาอื่นแล้วแปลงเป็น JavaScript (เรียกว่า <a href=\"https://en.wikipedia.org/wiki/Source-to-source_compiler\">transpiling</a> เช่น CoffeeScript หรือ Babel) ที่ช่วยให้เขียนโค้ดง่ายขึ้น แต่ก็ต้องแลกมาด้วยความซับซ้อนที่เพิ่มขึ้น</p>\n<p>แนวทางของ Rails ช่วงก่อนหน้านี้คือใช้ <a href=\"https://webpack.js.org/\">Webpack</a> (<a href=\"https://github.com/rails/webpacker\">ผ่าน Webpacker</a>) เป็นตัวช่วย bundler โมดูล JavaScript ต่างๆ เข้าด้วยกัน โดยเริ่มจาก Rails 5.2 ในปี 2017 ข้อเสียของแนวทางนี้คือ Webpack โยงอยู่กับ Node.js จึงทำให้ Rails ต้องเรียกใช้ Node.js ตามไปด้วย</p>\n<p>แต่เมื่อเวลาผ่านมา 5 ปี สถานการณ์เปลี่ยนไปมาก เพราะเว็บเบราว์เซอร์ทุกตัวรองรับภาษา ECMAScript 6 (ES6) ที่เปลี่ยนโครงสร้างของ JavaScript ไปมากแล้ว (เหลือแต่ IE11 และ<a href=\"https://www.blognone.com/node/122762\">ไมโครซอฟท์ก็ฆ่าทิ้งเรียบร้อยแล้ว</a>) ทำให้เราสามารถเขียนโค้ด ES6 ตรงๆ ได้เลย</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/b6ccaf61781c4c7449ccd1c0ba05c520.png\" /></p>\n<p>เทคโนโลยีอีกตัวที่เปลี่ยนโลกของการพัฒนาเว็บคือ <a href=\"https://www.blognone.com/node/112422\">HTTP2 ที่หนึ่งการเชื่อมต่อสามารถส่งไฟล์ได้หลายไฟล์พร้อมกัน</a> ทำให้การมัดรวมไฟล์ JavaScript เป็นไฟล์เดียวไม่มีประโยชน์เพิ่มขึ้นมากเหมือนในอดีต เราจึงไม่ต้องมี bundler อีกแล้ว เพราะเสียเวลาประมวลผล และแก้ไขข้อมูลภายหลังได้ยาก</p>\n<p>เทคโนโลยีตัวที่สามคือ <a href=\"https://wicg.github.io/import-maps/\">import maps</a> ซึ่งเปลี่ยนวิธีการอิมพอร์ตไฟล์ JavaScript จากการระบุชื่อไฟล์ตรงๆ (ถ้าไฟล์เปลี่ยนชื่อ ต้องจัดการแคชของเบราว์เซอร์ใหม่) มาเป็นการ mapping แทนซึ่งเป็น logical มีความยืดหยุ่นสูงกว่า (<a href=\"https://chromestatus.com/feature/5315286962012160\">ฟีเจอร์นี้ใช้ได้แล้วกับเบราว์เซอร์ตระกูล Chromium</a>)</p>\n<p>เทคโนโลยีทั้งสามตัวทำให้ Rails ไม่จำเป็นต้องพึ่งพาเครื่องมือสาย JavaScript ที่ซับซ้อนอีกต่อไป สามารถเขียน JavaScript (ES6) ตรงๆ แล้วสื่อสารกับเบราว์เซอร์ได้เลย การเปลี่ยนแปลงสำคัญของ Rails 7.0 จึงเป็นการถอด Webpacker ออก (ทำให้ไม่จำเป็นต้องพึ่งพา Node.js) โดยยังสามารถใช้ bundler ได้ถ้าต้องการ และเลือกใช้ตัวใดก็ได้ไม่ว่าจะเป็น esbuild, rollup.js หรือแม้แต่ Webpack เหมือนเดิม เช่นเดียวกับ CSS bundler ที่เลือกใช้ตัวใดก็ได้ เช่น Tailwind, Bootstrap, Sass, PostCSS โดยไม่ต้องผูกกับ Node.js</p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/037d7f736269d6202d997eae6069d04f.png\" /></p>\n<p>ส่วนฝั่ง front-end เปลี่ยนมาใช้ <a href=\"https://hotwired.dev/\">Hotwire</a> ซึ่งพัฒนาโดยบริษัท Basecamp เช่นกัน แนวคิดของ Hotwire คือส่งข้อมูลไปยังเบราว์เซอร์เป็น HTML แทน JSON (HTML-over-the-wire) เพื่อให้การเรนเดอร์เทมเพลตอยู่ที่ฝั่งเซิร์ฟเวอร์ เพจโหลดเร็วขึ้น และลดความซับซ้อนลง ถูกนำมาใช้แทนระบบ front-end เดิมของ Rails ที่เป็น Turbolinks และ Rails UJS</p>\n<p>การเปลี่ยนแปลงทั้งสองส่วนทำให้ Rails 7 เรียบง่ายขึ้นกว่าเดิมมากๆ ซึ่ง DHH เชื่อว่านี่คือสิ่งที่การพัฒนาเว็บควรจะมุ่งไป และตอนนี้บริษัท Basecamp ของเขาก็พัฒนา<a href=\"https://www.blognone.com/node/116958\">เว็บเมล Hey</a> ด้วยเฟรมเวิร์คตัวใหม่นี้อยู่</p>\n<p>ที่มา - <a href=\"https://rubyonrails.org/2021/12/15/Rails-7-fulfilling-a-vision\">Ruby on Rails 7.0</a>, <a href=\"https://world.hey.com/dhh/modern-web-apps-without-javascript-bundling-or-transpiling-a20f2755\">David Heinemeier Hansson</a></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/ruby\">Ruby</a></div><div><a href=\"/topics/rails\">Rails</a></div><div><a href=\"/topics/nodejs\">Node.js</a></div><div><a href=\"/topics/development\">Development</a></div><div><a href=\"/topics/javascript\">JavaScript</a></div></div></div>","author":"mk","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"ebb3f5808309b7769973476452de00cfe3da2a7a2e98c43df7f7c63652362dd7","category":"Thai"}