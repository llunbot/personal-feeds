{"title":"Creating An Interactive Gantt Chart Component With Vanilla JavaScript","link":"https://smashingmagazine.com/2021/08/interactive-gantt-chart-component-vanilla-javascript/","date":1629273600000,"content":"<p>If you work with time data in your app, a graphical visualization as a calendar or Gantt chart is often very useful. At first glance, developing your own chart component seems quite complicated. Therefore, in this article, I will develop the foundation for a <strong>Gantt chart component</strong> whose appearance and functionality you can customize for any use case.</p>\n<p>These are the <strong>basic features of the Gantt chart</strong> that I would like to implement:</p>\n<ul>\n<li>The user can choose between two views: year/month or month/day.</li>\n<li>The user can define the planning horizon by selecting a start date and an end date.</li>\n<li>The chart renders a given list of jobs that can be moved by drag and drop. The changes are reflected in the state of the objects.</li>\n<li>Below you can see the resulting Gantt chart in both views. In the monthly version, I have included three jobs as an example.</li>\n</ul>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/9d1f6492-473b-4bff-b5fd-625f2b31251a/1-interactive-gantt-chart-component-vanillajs.jpg\" /></p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/be156828-3af2-4885-a520-4c62b1c71356/2-interactive-gantt-chart-component-vanillajs.PNG\" /></p>\n<p>Below you can see the resulting Gantt chart in both views. In the monthly version, I have included three jobs as an example.</p>\n<h3>Sample Files And Instructions For Running The Code</h3>\n<p>You can find the <strong>full code snippets</strong> of this article in the following files:</p>\n<ul>\n<li><a href=\"https://drive.google.com/file/d/1_sU8iuB6e8Dvp2wfeBFSlj_klW9Avmh9/view?usp=sharing\">index.html</a></li>\n<li><a href=\"https://drive.google.com/file/d/1qCTn3-2AV78frvkd_pASu0v-SYgLIy7U/view?usp=sharing\">index.js</a></li>\n<li><a href=\"https://drive.google.com/file/d/1KVKT7AA65wmF5l68MHPsKPCy31Kj4RVZ/view?usp=sharing\">VanillaGanttChart.js</a></li>\n<li><a href=\"https://drive.google.com/file/d/10N0EV_-5PO2FbupE3mn18xTWiRIKaKP3/view?usp=sharing\">YearMonthRenderer.js</a></li>\n<li><a href=\"https://drive.google.com/file/d/1k_TYNzg9NJmAcDI8YCGJ166SIqp4OTDs/view?usp=sharing\">DateTimeRenderer.js</a>.</li>\n</ul>\n<p>Since the code contains JavaScript modules, you can only run the example from an <strong>HTTP server</strong> and not from the local file system. For testing on your local PC, I’d recommend the module <a href=\"https://www.npmjs.com/package/live-server\">live-server</a>, which you can install via npm. </p>\n<p>Alternatively, you can <a href=\"https://blaustern.eu/gantt-chart/\">try out the example here directly in your browser</a> without installation.</p>\nBasic Structure Of The Web Component\n<p>I decided to implement the Gantt chart as a web component. This allows us to create a <strong>custom HTML element</strong>, in my case <code>&lt;gantt-chart&gt;&lt;/gantt-chart&gt;</code>, which we can easily reuse anywhere on any HTML page.</p>\n<p>You can find some basic information about developing web components in the <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components\">MDN Web Docs</a>. The following listing shows the structure of the component. It is inspired by the “counter” example from <a href=\"https://alligator.io/web-components/attributes-properties/\">Alligator.io</a>.</p>\n<p>The component defines a <strong>template</strong> containing the HTML code needed to display the Gantt chart. For the complete CSS specifications, please refer to the sample files. The specific selection fields for year, month or date cannot be defined here yet, as they depend on the selected level of the view.</p>\n<p>The selection elements are projected in by one of the two <strong>renderer classes</strong> instead. The same applies to the rendering of the actual Gantt chart into the element with the ID <code>gantt-container</code>, which is also handled by the responsible renderer class.</p>\n<p>The class <code>VanillaGanttChart</code> now describes the behavior of our new HTML element. In the constructor, we first define our rough template as the <a href=\"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM\">shadow DOM</a> of the element.</p>\n<p>The component must be initialized with <strong>two arrays</strong>, <code>jobs</code>, and <code>resources</code>. The <code>jobs</code> array contains the tasks that are displayed in the chart as movable green bars. The <code>resources</code> array defines the individual rows in the chart where tasks can be assigned. In the screenshots above, for example, we have 4 resources labeled <em>Task 1</em> to <em>Task 4</em>. The resources can therefore represent the individual tasks, but also people, vehicles, and other physical resources, allowing for a variety of use cases.</p>\n<p>Currently, the <code>YearMonthRenderer</code> is used as the <strong>default renderer</strong>. As soon as the user selects a different level, the renderer is changed in the <code>changeLevel</code> method: First, the renderer-specific DOM elements and listeners are deleted from the Shadow DOM using the <code>clear</code> method of the old renderer. Then the new renderer is initialized with the existing jobs and resources and the rendering is started.</p>\n<pre><code>import {YearMonthRenderer} from './YearMonthRenderer.js';\nimport {DateTimeRenderer} from './DateTimeRenderer.js';\n\nconst template = document.createElement('template');\n\ntemplate.innerHTML = \n `&lt;style&gt; … &lt;/style&gt;\n\n  &lt;div id=\"gantt-settings\"&gt;\n\n    &lt;select name=\"select-level\" id=\"select-level\"&gt;\n      &lt;option value=\"year-month\"&gt;Month / Day&lt;/option&gt;\n      &lt;option value=\"day\"&gt;Day / Time&lt;/option&gt;\n    &lt;/select&gt;\n\n    &lt;fieldset id=\"select-from\"&gt;\n      &lt;legend&gt;From&lt;/legend&gt;\n    &lt;/fieldset&gt;\n\n    &lt;fieldset id=\"select-to\"&gt;\n      &lt;legend&gt;To&lt;/legend&gt;\n    &lt;/fieldset&gt;\n  &lt;/div&gt;\n\n  &lt;div id=\"gantt-container\"&gt;\n  &lt;/div&gt;`;\n\nexport default class VanillaGanttChart extends HTMLElement {\n\n    constructor() {\n      super();\n      this.attachShadow({ mode: 'open' });\n      this.shadowRoot.appendChild(template.content.cloneNode(true));\n      this.levelSelect = this.shadowRoot.querySelector('#select-level');\n    }\n\n    _resources = [];\n    _jobs = [];\n    _renderer;\n\n    set resources(list){…}\n    get resources(){…}\n    set jobs(list){…}\n    get jobs(){…}\n    get level() {…}\n    set level(newValue) {…} \n    get renderer(){…}\n    set renderer(r){…}\n\n    connectedCallback() {\n      this.changeLevel = this.changeLevel.bind(this);\n\n      this.levelSelect.addEventListener('change', this.changeLevel);\n      this.level = \"year-month\";   \n\n      this.renderer = new YearMonthRenderer(this.shadowRoot);\n      this.renderer.dateFrom = new Date(2021,5,1);\n      this.renderer.dateTo = new Date(2021,5,24);\n      this.renderer.render();\n    }\n\n    disconnectedCallback() {  \n      if(this.levelSelect)\n        this.levelSelect.removeEventListener('change', this.changeLevel);\n      if(this.renderer)\n        this.renderer.clear();\n    }\n\n    changeLevel(){\n      if(this.renderer)\n        this.renderer.clear();\n\n      var r;   \n\n      if(this.level == \"year-month\"){\n        r = new YearMonthRenderer(this.shadowRoot);    \n      }else{\n        r = new DateTimeRenderer(this.shadowRoot);\n      }\n\n      r.dateFrom = new Date(2021,5,1);\n      r.dateTo = new Date(2021,5,24);\n      r.resources = this.resources;\n      r.jobs = this.jobs;\n      r.render();\n      this.renderer = r;\n    }\n  }\n\n  window.customElements.define('gantt-chart', VanillaGanttChart);</code></pre>\n\n<p>Before we get deeper into the rendering process, I would like to give you an overview of the connections between the different scripts:</p>\n<ul>\n<li><strong>index.html</strong> is your web page where you can use the tag <code>&lt;gantt-chart&gt;&lt;/gantt-chart&gt;</code></li>\n<li><strong>index.js</strong> is a script in which you initialize the instance of the web component that is associated with the Gantt chart used in index.html with the appropriate jobs and resources (of course you can also use multiple Gantt charts and thus multiple instances of the web component)</li>\n<li>The component <strong><code>VanillaGanttChart</code></strong> delegates rendering to the two renderer classes <code>YearMonthRenderer</code> and <code>DateTimeRenderer</code>.</li>\n</ul>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/5f80bf86-6f3c-4e82-83c3-d944018be93a/3-interactive-gantt-chart-component-vanillajs.jpg\" /></p>\nRendering Of The Gantt chart With JavaScript And CSS Grid\n<p>In the following, we discuss the <strong>rendering process</strong> using the <code>YearMonthRenderer</code> as an example. Please note that I have used a so-called <a href=\"https://www.javascripttutorial.net/javascript-constructor-function/\">constructor function</a> instead of the <code>class</code> keyword to define the class. This allows me to distinguish between public properties (<code>this.render</code> and <code>this.clear</code>) and private variables (defined with <code>var</code>).</p>\n<p>The rendering of the chart is broken down into several sub-steps:</p>\n<ol>\n<li><code>initSettings</code><br />Rendering of the controls which are used to define the planning horizon.</li>\n<li><code>initGantt</code><br />Rendering of the Gantt chart, basically in four steps: <ul>\n<li><code>initFirstRow</code> (draws 1 row with month names)</li>\n<li><code>initSecondRow</code> (draws 1 row with days of the month)</li>\n<li><code>initGanttRows</code> (draws 1 row for each resource with grid cells for each day of the month)</li>\n<li><code>initJobs</code> (positions the draggable jobs in the chart)</li>\n</ul>\n</li>\n</ol>\n<pre><code>export function YearMonthRenderer(root){\n\n    var shadowRoot = root;\n    var names = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];    \n\n    this.resources=[];\n    this.jobs = [];\n\n    this.dateFrom = new Date();\n    this.dateTo = new Date();\n\n    //select elements\n    var monthSelectFrom;\n    var yearSelectFrom;\n    var monthSelectTo;\n    var yearSelectTo;\n\n    var getYearFrom = function() {…}\n    var setYearFrom = function(newValue) {…}\n\n    var getYearTo = function() {…}\n    var setYearTo = function(newValue) {…}\n\n    var getMonthFrom = function() {…}\n    var setMonthFrom = function(newValue) {…}\n\n    var getMonthTo = function() {…}\n    var setMonthTo = function(newValue) {…}  \n\n    this.render = function(){\n      this.clear();\n      initSettings();\n      initGantt();\n    }\n\n    //remove select elements and listeners, clear gantt-container \n    this.clear = function(){…}\n\n    //add HTML code for the settings area (select elements) to the shadow root, initialize associated DOM elements and assign them to the properties monthSelectFrom, monthSelectTo etc., initialize listeners for the select elements\n    var initSettings = function(){…}\n\n    //add HTML code for the gantt chart area to the shadow root, position draggable jobs in the chart\n    var initGantt = function(){…}\n\n    //used by initGantt: draw time axis of the chart, month names\n    var initFirstRow = function(){…}\n\n    //used by initGantt: draw time axis of the chart, days of month\n    var initSecondRow = function(){…}\n\n    //used by initGantt: draw the remaining grid of the chart\n    var initGanttRows = function(){…}.bind(this);\n\n    //used by initGantt: position draggable jobs in the chart cells\n    var initJobs = function(){…}.bind(this);    \n\n   //drop event listener for jobs\n   var onJobDrop = function(ev){…}.bind(this);\n\n   //helper functions, see example files\n   ...\n}</code></pre>\n\n<h3>Rendering The Grid</h3>\n<p>I recommend CSS Grid for drawing the diagram area because it makes it very easy to create <strong>multi-column layouts</strong> that adapt dynamically to the screen size. </p>\n<p>In the first step, we have to determine the <strong>number of columns</strong> of the grid. In doing so, we refer to the first row of the chart which (in the case of the <code>YearMonthRenderer</code>) represents the individual months. </p>\n<p>Consequently, we need:</p>\n<ul>\n<li>one column for the names of the resources, e.g. with a fixed width of 100px.</li>\n<li>one column for each month, of the same size and using the full space available.</li>\n</ul>\n<p>This can be achieved with the setting <code>100px repeat(${n_months}, 1fr)</code> for the property <code>gridTemplateColumns</code> of the chart container. </p>\n<p>This is the initial part of the <code>initGantt</code> method:</p>\n<pre><code>var container = shadowRoot.querySelector(\"#gantt-container\");\ncontainer.innerHTML = \"\";\n\nvar first_month = new Date(getYearFrom(), getMonthFrom(), 1);\nvar last_month = new Date(getYearTo(), getMonthTo(), 1);\n\n//monthDiff is defined as a helper function at the end of the file\nvar n_months =  monthDiff(first_month, last_month)+1;\n\ncontainer.style.gridTemplateColumns = `100px repeat(${n_months},1fr)`;</code></pre>\n\n<p>In the following picture you can see a chart for two months with <code>n_months=2</code>:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/73076bcc-a5f7-4bdd-943a-66f37bcb8034/chart-2-months.png\" /></p>\n<p>After we have defined the outer columns, we can start <strong>filling the grid</strong>. Let's stay with the example from the picture above. In the first row, I insert 3 <code>div</code>s with the classes <code>gantt-row-resource</code> and <code>gantt-row-period</code>. You can find them in the following snippet from the DOM inspector. </p>\n<p>In the second row, I use the same three <code>div</code>s to keep the vertical alignment. However, the month <code>div</code>s get child elements for the individual days of the month.</p>\n<pre><code>&lt;div id=\"gantt-container\"\n  style=\"grid-template-columns: 100px repeat(2, 1fr);\"&gt;\n  &lt;div class=\"gantt-row-resource\"&gt;&lt;/div&gt;\n  &lt;div class=\"gantt-row-period\"&gt;Jun 2021&lt;/div&gt;\n  &lt;div class=\"gantt-row-period\"&gt;Jul 2021&lt;/div&gt;\n  &lt;div class=\"gantt-row-resource\"&gt;&lt;/div&gt;\n  &lt;div class=\"gantt-row-period\"&gt;\n    &lt;div class=\"gantt-row-period\"&gt;1&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;2&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;3&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;4&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;5&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;6&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;7&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;8&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;9&lt;/div&gt;\n    &lt;div class=\"gantt-row-period\"&gt;10&lt;/div&gt;\n  ...\n  &lt;/div&gt;\n  ...\n&lt;/div&gt;\n</code></pre>  \n\n<p>For the child elements to be arranged horizontally as well, we need the setting <code>display: grid</code> for the class <code>gantt-row-period</code>. In addition, we do not know exactly how many columns are required for the individual months (28, 30, or 31). Therefore, I use the setting <code>grid-auto-columns</code>. With the value <code>minmax(20px, 1fr);</code> I can ensure that a minimum width of 20px is maintained and that otherwise the available space is fully utilized:</p>\n<pre><code>#gantt-container {\n  display: grid;\n}\n\n.gantt-row-resource {\n  background-color: whitesmoke;\n  color: rgba(0, 0, 0, 0.726);\n  border: 1px solid rgb(133, 129, 129);\n  text-align: center;\n}\n\n.gantt-row-period {\n  display: grid;\n  grid-auto-flow: column;\n  grid-auto-columns: minmax(20px, 1fr);\n  background-color: whitesmoke;\n  color: rgba(0, 0, 0, 0.726);\n  border: 1px solid rgb(133, 129, 129);\n  text-align: center;\n}</code></pre>\n\n<p>The remaining rows are generated according to the second row, however as <strong>empty cells</strong>.</p>\n<p>Here is the JavaScript code for generating the individual grid cells of the first row. The methods <code>initSecondRow</code> and <code>initGanttRows</code> have a similar structure.</p>\n<pre><code>var initFirstRow = function(){\n\n  if(checkElements()){\n        var container = shadowRoot.querySelector(\"#gantt-container\");\n\n        var first_month = new Date(getYearFrom(), getMonthFrom(), 1);\n        var last_month = new Date(getYearTo(), getMonthTo(), 1);\n\n        var resource = document.createElement(\"div\");\n        resource.className = \"gantt-row-resource\";\n        container.appendChild(resource);   \n\n        var month = new Date(first_month);\n\n        for(month; month &lt;= last_month; month.setMonth(month.getMonth()+1)){    \n          var period = document.createElement(\"div\");\n          period.className = \"gantt-row-period\";\n          period.innerHTML = names[month.getMonth()] + \" \" + month.getFullYear();\n          container.appendChild(period);\n        }\n  }\n}</code></pre>\n\n<h3>Rendering The Jobs</h3>\n<p>Now each <code>job</code> has to be drawn into the diagram at the <strong>correct position</strong>. For this I make use of the HTML data attributes: every grid cell in the main chart area is associated with the two attributes <code>data-resource</code> and <code>data-date</code> indicating the position on the horizontal and vertical axis of the chart (see function <code>initGanttRows</code> in the files <code>YearMonthRenderer.js</code> and <code>DateTimeRenderer.js</code>).</p>\n<p>As an example, let's look at the <strong>first four grid cells</strong> in the first row of the chart (we are still using the same example as in the pictures above):</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/e8eaf9c3-f594-41e2-afa0-1a4ed3ee10a9/6-interactive-gantt-chart-component-vanillajs.PNG\" /></p>\n<p>In the DOM inspector you can see the values of the data attributes that I have assigned to the individual cells:</p>\n<p><img src=\"https://cloud.netlifyusercontent.com/assets/344dbf88-fdf9-42bb-adb4-46f01eedd629/06e65da7-ef17-4f28-aa4b-dbba36acb02f/7-interactive-gantt-chart-component-vanillajs.PNG\" /></p>\n<p>Let's now see what this means for the function <code>initJobs</code>. With the help of the function <code>querySelector</code>, it is now quite easy to find the grid cell into which a job should be placed.</p>\n<p>The next challenge is to determine the correct width for a <code>job</code> element. Depending on the selected view, each grid cell represents a <strong>unit of one day</strong> (level <code>month/day</code>) or one hour (level <code>day/time</code>). Since each job is the child element of a cell, the <code>job</code> duration of 1 unit (day or hour) corresponds to a width of <code>1*100%</code>, the duration of 2 units corresponds to a width of <code>2*100%</code>, and so on. This makes it possible to use the CSS <code>calc</code> function to <strong>dynamically set the width of a <code>job</code> element</strong>, as shown in the following listing.</p>\n<pre><code>var initJobs = function(){\n\n    this.jobs.forEach(job =&gt; {\n\n        var date_string = formatDate(job.start);\n\n        var ganttElement = shadowRoot.querySelector(`div[data-resource=\"${job.resource}\"][data-date=\"${date_string}\"]`);\n\n        if(ganttElement){\n\n          var jobElement = document.createElement(\"div\");\n          jobElement.className=\"job\";\n          jobElement.id = job.id;\n\n          //helper function dayDiff - get difference between start and end in days\n          var d = dayDiff(job.start, job.end);           \n\n          //d --&gt; number of grid cells covered by job + sum of borderWidths\n          jobElement.style.width = \"calc(\"+(d*100)+\"% + \"+ d+\"px)\";\n          jobElement.draggable = \"true\";\n\n          jobElement.ondragstart = function(ev){\n              //the id is used to identify the job when it is dropped\n              ev.dataTransfer.setData(\"job\", ev.target.id); \n          };\n\n          ganttElement.appendChild(jobElement);\n        }\n    });\n  }.bind(this);</code></pre>\n\n<p>In order to make a <code>job</code> <strong>draggable</strong>, there are three steps required:</p>\n<ul>\n<li>Set the property <code>draggable</code> of the job element to <code>true</code> (see listing above).</li>\n<li>Define an event handler for the event <code>ondragstart</code> of the job element (see listing above).</li>\n<li>Define an event handler for the event <code>ondrop</code> for the grid cells of the Gantt chart, which are the possible drop targets of the job element (see function <code>initGanttRows</code> in the file <code>YearMonthRenderer.js</code>).</li>\n</ul>\n<p>The event handler for the event <code>ondrop</code> is defined as follows:</p>\n<pre><code>var onJobDrop = function(ev){\n\n      // basic null checks\n      if (checkElements()) {\n\n        ev.preventDefault(); \n\n        // drop target = grid cell, where the job is about to be dropped\n        var gantt_item = ev.target;\n\n        // prevent that a job is appended to another job and not to a grid cell\n        if (ev.target.classList.contains(\"job\")) {\n          gantt_item = ev.target.parentNode;\n        }\n\n        // identify the dragged job\n        var data = ev.dataTransfer.getData(\"job\");               \n        var jobElement = shadowRoot.getElementById(data);  \n\n        // drop the job\n        gantt_item.appendChild(jobElement);\n\n        // update the properties of the job object\n        var job = this.jobs.find(j =&gt; j.id == data );\n\n        var start = new Date(gantt_item.getAttribute(\"data-date\"));\n        var end = new Date(start);\n        end.setDate(start.getDate()+dayDiff(job.start, job.end));\n\n        job.start = start;\n        job.end = end;\n        job.resource = gantt_item.getAttribute(\"data-resource\");\n      }\n    }.bind(this);</code></pre>\n\n<p> All changes to the job data made by drag and drop are thus reflected in the list <code>jobs</code> of the Gantt chart component.</p>\nIntegrating The Gantt Chart Component In Your Application\n<p>You can use the tag <code>&lt;gantt-chart&gt;&lt;/gantt-chart&gt;</code> anywhere in the HTML files of your application (in my case in the file <code>index.html</code>) under the following conditions: </p>\n<ul>\n<li>The script <code>VanillaGanttChart.js</code> must be integrated as a module so that the tag is interpreted correctly.</li>\n<li>You need a separate script in which the Gantt chart is initialized with <code>jobs</code> and <code>resources</code> (in my case the file <code>index.js</code>).</li>\n</ul>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n &lt;head&gt;\n   &lt;meta charset=\"UTF-8\"/&gt;\n   &lt;title&gt;Gantt chart - Vanilla JS&lt;/title&gt;\n   &lt;script type=\"module\" src=\"VanillaGanttChart.js\"&gt;&lt;/script&gt;   \n &lt;/head&gt;\n\n &lt;body&gt;\n\n  &lt;gantt-chart id=\"g1\"&gt;&lt;/gantt-chart&gt; \n\n  &lt;script type=\"module\" src=\"index.js\"&gt;&lt;/script&gt;\n &lt;/body&gt; \n&lt;/html&gt;</code></pre>\n\n<p>For example, in my case the file <code>index.js</code> looks as follows:</p>\n<pre><code>import VanillaGanttChart from \"./VanillaGanttChart.js\";\n\nvar chart = document.querySelector(\"#g1\");\n\nchart.jobs = [\n    {id: \"j1\", start: new Date(\"2021/6/1\"), end: new Date(\"2021/6/4\"), resource: 1},\n    {id: \"j2\", start: new Date(\"2021/6/4\"), end: new Date(\"2021/6/13\"), resource: 2},\n    {id: \"j3\", start: new Date(\"2021/6/13\"), end: new Date(\"2021/6/21\"), resource: 3},\n];\n\nchart.resources = [{id:1, name: \"Task 1\"}, {id:2, name: \"Task 2\"}, {id:3, name: \"Task 3\"}, {id:4, name: \"Task 4\"}];\n</code></pre>\n\n<p>However, there is still one requirement open: when the user makes changes by dragging jobs in the Gantt chart, the respective changes in the property values of the jobs should be reflected in the list <em>outside</em> the component.</p>\n<p>We can achieve this with the use of <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy\">JavaScript Proxy Objects</a>: Each <code>job</code> is nested in a <strong>proxy object</strong>, which we provide with a so-called <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy#validation\">validator</a>. It becomes active as soon as a property of the object is changed (function <code>set</code> of the validator) or retrieved (function <code>get</code> of the validator). In the set function of the validator, we can store code that is executed whenever the start time or the resource of a task is changed.</p>\n<p>The following listing shows a different version of the file <code>index.js</code>. Now a list of proxy objects is assigned to the Gantt chart component instead of the original jobs. In the validator <code>set</code> I use a simple console output to show that I have been notified of a property change.</p>\n<pre><code>import VanillaGanttChart from \"./VanillaGanttChart.js\";\n\nvar chart = document.querySelector(\"#g1\");\n\nvar jobs = [\n    {id: \"j1\", start: new Date(\"2021/6/1\"), end: new Date(\"2021/6/4\"), resource: 1},\n    {id: \"j2\", start: new Date(\"2021/6/4\"), end: new Date(\"2021/6/13\"), resource: 2},\n    {id: \"j3\", start: new Date(\"2021/6/13\"), end: new Date(\"2021/6/21\"), resource: 3},\n];\nvar p_jobs = [];\n\nchart.resources = [{id:1, name: \"Task 1\"}, {id:2, name: \"Task 2\"}, {id:3, name: \"Task 3\"}, {id:4, name: \"Task 4\"}];\n\njobs.forEach(job =&gt; {\n\n    var validator = {\n        set: function(obj, prop, value) {\n\n          console.log(\"Job \" + obj.id + \": \" + prop + \" was changed to \" + value);\n          console.log();\n\n          obj[prop] = value;\n          return true;\n        },\n\n        get: function(obj, prop){\n\n            return obj[prop];\n        }\n    };\n\n    var p_job = new Proxy(job, validator);\n    p_jobs.push(p_job);\n});\n\nchart.jobs = p_jobs;</code></pre>\n\nOutlook\n<p>The Gantt chart is an example that shows how you can use the technologies of Web Components, CSS Grid, and JavaScript Proxy to develop a <strong>custom HTML element</strong> with a somewhat more complex graphical interface. You are welcome to develop the project further and/or use it in your own projects together with other JavaScript frameworks.</p>\n<p>Again, you can find <a href=\"#sample-files-and-instructions-for-running-the-code\">all sample files and instructions</a> at the top of the article.</p>","author":"","siteTitle":"Articles on Smashing Magazine — For Web Designers And Developers","siteHash":"ab069ca35bf300e9db0da36f49701f66485a5b0d2db0471dfeee07cef6204939","entryHash":"d3a555352376eac4c0e8bedaca49e3594ebdc5f077e9c16a7d27b02f483617bb","category":"Tech"}