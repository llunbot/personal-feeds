{"title":"Amazon ECS supports a native integration with Amazon EBS volumes for data-intensive workloads","link":"https://aws.amazon.com/blogs/aws/amazon-ecs-supports-a-native-integration-with-amazon-ebs-volumes-for-data-intensive-workloads/","date":1705012573000,"content":"<p>Today we are announcing that <a href=\"https://aws.amazon.com/ecs\">Amazon Elastic Container Service (Amazon ECS)</a> supports an integration with <a href=\"https://aws.amazon.com/ebs\">Amazon Elastic Block Store (Amazon EBS)</a>, making it easier to run a wider range of data processing workloads. You can provision Amazon EBS storage for your ECS tasks running on <a href=\"https://aws.amazon.com/fargate\">AWS Fargate</a> and <a href=\"https://aws.amazon.com/ec2\">Amazon Elastic Compute Cloud (Amazon EC2)</a> without needing to manage storage or compute.</p> \n<p>Many organizations choose to deploy their applications as containerized packages, and with the introduction of Amazon ECS integration with Amazon EBS, organizations can now run more types of workloads than before.</p> \n<p>You can run data workloads requiring storage that supports high transaction volumes and throughput, such as extract, transform, and load (ETL) jobs for big data, which need to fetch existing data, perform processing, and store this processed data for downstream use. Because the storage lifecycle is fully managed by Amazon ECS, you don’t need to build any additional scaffolding to manage infrastructure updates, and as a result, your data processing workloads are now more resilient while simultaneously requiring less effort to manage.</p> \n<p>Now you can choose from a variety of storage options for your containerized applications running on Amazon ECS:</p> \n<ul> \n <li>Your Fargate tasks get 20 GiB of <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/fargate-task-storage.html\">ephemeral storage</a> by default. For applications that need additional storage space to download large container images or for scratch work, you can configure up to 200 GiB of ephemeral storage for your Fargate tasks.</li> \n <li>For applications that span many tasks that need concurrent access to a shared dataset, you can configure Amazon ECS to mount the <a href=\"https://aws.amazon.com/efs\">Amazon Elastic File System (Amazon EFS)</a> file system to your ECS tasks running on both EC2 and Fargate. Common examples of such workloads include web applications such as content management systems, internal DevOps tools, and machine learning (ML) frameworks. Amazon EFS is designed to be available across a Region and can be simultaneously attached to many tasks.</li> \n <li>For applications that need high-performance, low-cost storage that does not need to be shared across tasks, you can configure Amazon ECS to provision and attach Amazon EBS storage to your tasks running on both Amazon EC2 and Fargate. Amazon EBS is designed to provide block storage with low latency and high performance within an Availability Zone.</li> \n</ul> \n<p>To learn more, see <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_data_volumes.html\">Using data volumes in Amazon ECS tasks</a> and <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/bestpracticesguide/storage.html\">persistent storage best practices</a> in the AWS documentation.</p> \n<p><strong><u>Getting started with EBS volume integration to your ECS tasks</u></strong><br /> You can configure the volume mount point for your container in the task definition and pass Amazon EBS storage requirements for your Amazon ECS task at runtime. For most use cases, you can get started by simply providing the size of the volume needed for the task. Optionally, you can configure all EBS volume attributes and the file system you want the volume formatted with.</p> \n<p><strong> 1. Create a task definition</strong><br /> Go to the <a href=\"https://console.aws.amazon.com/ecs/v2/task-definitions\">Amazon ECS console</a>, navigate to <strong>Task definitions</strong>, and choose <strong>Create new task definition</strong>.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-1-ecs-home.jpg\" width=\"2100\" height=\"742\" /></p> \n<p>In the <strong>Storage</strong> section, choose <strong>Configure at deployment</strong> to set EBS volume as a new configuration type. You can provision and attach one volume per task for Linux file systems.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-2-task-definition.jpg\" width=\"1700\" height=\"1361\" /></p> \n<p>When you choose <strong>Configure at task definition creation</strong>, you can configure existing storage options such as bind mounts, Docker volumes, EFS volumes, <a href=\"https://aws.amazon.com/fsx/windows/\">Amazon FSx for Windows File Server</a> volumes, or Fargate ephemeral storage.</p> \n<p>Now you can select a container in the task definition, the source EBS volume, and provide a mount path where the volume will be mounted in the task.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-2-task-definition-2.jpg\" width=\"1700\" height=\"647\" /></p> \n<p>You can also use <code>$aws ecs register-task-definition --cli-input-json file://example.json</code> command line to register a task definition to add an EBS volume. The following snippet is a sample, and task definitions are saved in JSON format.</p> \n<pre><code>{\n    \"family\": \"nginx\"\n    ...\n    \"containerDefinitions\": [\n        {\n            ...\n            \"mountPoints\": [\n                \"containerPath\": \"/foo\",\n                \"sourceVolume\": \"new-ebs-volume\"\n            ],\n            \"name\": \"nginx\",\n            \"image\": \"nginx\"\n        }\n    ],\n    \"volumes\": [\n       {\n           \"name\": \"/foo\",\n           \"configuredAtRuntime\": true\n       }\n    ]\n}</code></pre> \n<p><strong>2. Deploy and run your task with EBS volume</strong><br /> Go to your ECS cluster and choose <strong>Run new task</strong>. Note that you can select the compute options, the launch type, and your task definition.</p> \n<p>Note: While this example goes through deploying a standalone task with an attached EBS volume, you can also configure a new or existing ECS service to use EBS volumes with the desired configuration.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-3-tasks.jpg\" width=\"2100\" height=\"1183\" /></p> \n<p>You have a new <strong>Volume</strong> section where you can configure the additional storage. The volume name, type, and mount points are those that you defined in your task definition. Choose your <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html\">EBS volume types</a>, sizes (GiB), IOPS, and the desired throughput.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-4-volumes-1.jpg\" width=\"1700\" height=\"1612\" /></p> \n<p>You cannot attach an existing EBS volume to an ECS task. But if you want to create a volume from an existing snapshot, you have the option to choose your snapshot ID. If you want to create a new volume, then you can leave this field empty. You can choose the file system type: ext3, ext4, or xfs file systems on Linux.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-4-volumes-2.jpg\" width=\"1700\" height=\"883\" /></p> \n<p>By default, when a task is terminated, Amazon ECS deletes the attached volume. If you need the data in the EBS volume to be retained after the task exits, uncheck <strong>Delete on termination</strong>. Also, you need to create an <a href=\"https://aws.amazon.com/iam/\">AWS Identity and Access Management (IAM)</a> role for volume management that contains the relevant permissions to allow Amazon ECS to make API calls on your behalf. For more information on this policy, see <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/instance_IAM_role.html\">infrastructure role</a> in the AWS documentation.</p> \n<p>You can also configure encryption by default on your EBS volumes using either Amazon managed keys and customer managed keys. To learn more about the options, see our <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html\">Amazon EBS encryption</a> in the AWS documentation.</p> \n<p>After configuring all task settings, choose <strong>Create</strong> to start your task.</p> \n<p><strong>3. Deploy and run your task with EBS volume</strong><br /> Once your task has started, you can see the volume information on the task details page. Choose a task and select the <strong>Volumes </strong>tab to find your created EBS volume details.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/01/11/2024-ecs-integrations-with-ebs-5-tasks.jpg\" width=\"1716\" height=\"922\" /></p> \n<p>Your team can organize the development and operations of EBS volumes more efficiently. For example, application developers can configure the path where your application expects storage to be available in the task definition, and DevOps engineers can configure the actual EBS volume attributes at runtime when the application is deployed.</p> \n<p>This allows DevOps engineers to deploy the same task definition to different environments with differing EBS volume configurations, for example, gp3 volumes in the development environments and io2 volumes in production.</p> \n<p><strong><u>Now available</u></strong><br /> Amazon ECS integration with Amazon EBS is available in nine AWS Regions: US East (Ohio), US East (N. Virginia), US West (Oregon), Asia Pacific (Singapore), Asia Pacific (Sydney), Asia Pacific (Tokyo), Europe (Frankfurt), Europe (Ireland), and Europe (Stockholm). You only pay for what you use, including EBS volumes and snapshots. To learn more, see the <a href=\"https://aws.amazon.com/ebs/pricing/\">Amazon EBS pricing page</a> and <a href=\"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ebs-volumes.html\">Amazon EBS volumes in ECS</a> in the AWS documentation.</p> \n<p>Give it a try now and send feedback to <a href=\"https://github.com/aws/containers-roadmap/projects/1\">our public roadmap</a>, <a href=\"https://repost.aws/tags/TAefn4YSprR-uCBYmbofOpHw/amazon-elastic-container-service\">AWS re:Post for Amazon ECS</a>, or through your usual AWS Support contacts.</p> \n<p>— <a href=\"https://twitter.com/channyun\">Channy</a></p> \n<p><em>P.S. Special thanks to <a href=\"https://www.linkedin.com/in/maish/\">Maish Saidel-Keesing</a>, a senior enterprise developer advocate at AWS for his contribution in writing this blog post.</em></p>\n<em> </em>\n<p><em><strong>A correction was made on January 12, 2024</strong>: An earlier version of this post misstated: I changed 1) from “either ext3 or ext4” to “ext3, ext4, or xfs”, 2) from “check Delete on termination” to “uncheck Delete on termination”, 3) from “configure encryption”, “by default configure encryption”, and 4) from “task definition details page” to “task details page”.<br /> </em></p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"e7227457da83a3da778183b79bd533a22f2d5b42b82bac0f5ed8c17084f272e0","category":"Tech"}