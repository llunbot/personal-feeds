{"title":"ฝึกออกแบบ key-value ใน redis สำหรับเก็บข้อมูลการค้นหา","link":"https://www.somkiat.cc/try-design-key-value-in-redis-01/","date":1771334202000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2026/02/redis-design-sorted-set-150x150.jpg\" alt=\"\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2026/02/redis-design-sorted-set-150x150.jpg 150w, https://www.somkiat.cc/wp-content/uploads/2026/02/redis-design-sorted-set-75x75.jpg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2026/02/redis-design-sorted-set.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2026/02/redis-design-sorted-set-1024x571.jpg\" alt=\"\" width=\"624\" height=\"347\" /></a></figure>\n\n\n\n<p>ปัญหาที่น่าสนใจเกี่ยวกับการเก็บข้อมูลการค้นหา<br />ว่าในแต่ละวันมีการค้นหาคำไหน จำนวนเท่าไร<br />จึงลองฝึกออกแบบ <strong><a href=\"https://redis.io/\" target=\"_blank\">key-value ใน redis</a></strong> ดูหน่อย ว่าต้องทำอย่างไรบ้าง ?<br />โดยมีเป้าหมายเพื่อ</p>\n\n\n\n<ul>\n<li>เก็บข้อมูลแบบง่าย ๆ</li>\n\n\n\n<li>ดึงข้อมูลมาดูได้เลย รายวัน แต่ละวันเรียงตามจำนวนมากไปน้อย</li>\n</ul>\n\n\n\n<p>มาเริ่มออกแบบเล่น ๆ กันหน่อย</p>\n\n\n\n<span></span>\n\n\n\n<p>ระหว่างรอขึ้นเครื่องกลับบ้าน<br />ทำการออกแบบเล่นรอดีกว่า</p>\n\n\n\n<p><strong>เริ่มจากการเลือกก่อนว่าจะใช้ data structure อะไรในการเก็บข้อมูล ?</strong></p>\n\n\n\n<p>ข้อมูลในแต่ละวัน ข้อมูลการค้นหานับเพิ่มเมื่อซ้ำ  ไม่ซ้ำก็เพิ่มไป<br />เรียงข้อมูลตามจำนวนการค้นหาซ้ำ<br />ดังนั้น data structure ที่น่าจะเหมาะสมคือ <a href=\"https://redis.io/docs/latest/develop/data-types/sorted-sets/\" target=\"_blank\">Sorted Set</a> นั่นเอง</p>\n\n\n\n<p><strong>ตัวอย่างของการออกแบบ</strong></p>\n\n\n\n<ul>\n<li>รูปแบบของ key เช่น <strong>search:freq:{YYYY-MM-DD}</strong></li>\n\n\n\n<li>member หรือ สมาชิก ประกอบไปด้วย คำค้นหาต่าง ๆ เช่น word1, word2 เป็นต้น</li>\n\n\n\n<li>ทำการเพิ่ม score หรือ คะแนนครั้งละ 1</li>\n\n\n\n<li>ดูข้อมูลในแต่ละวัน</li>\n\n\n\n<li>ดูข้อมูลตามคำค้นหา</li>\n</ul>\n\n\n\n[gist id=\"0c9dc3fcf76f6478e6c86f0a2a57281d\" file=\"1.txt\"]\n\n\n\n<p>เพียงเท่านี้ก็ใช้งานได้แล้ว<br />แต่ปัญหาที่ตามมาคือ เรื่อง memory ที่ใช้งาน<br />ต้องจัดการ expire time และ จะใช้งาน bloom filter เข้ามาแทนได้<br />ได้เวลาขึ้นเครื่องแล้ว !!!</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"e4064a984b0aaf4b4dbea2e2a6087295e32a6478dfb9c963e116bf810ba0d2e0","category":"Thai"}