{"title":"Announcing Consul-Terraform-Sync 0.4 for Terraform Cloud","link":"https://www.hashicorp.com/blog/announcing-consul-terraform-sync-0-4-for-terraform-cloud","date":1634223600000,"content":"<p>We are pleased to announce the general availability of Consul-Terraform-Sync (CTS) 0.4, which supports HashiCorp Terraform Cloud (<a href=\"https://releases.hashicorp.com/consul-terraform-sync/0.4.0+ent/\">binaries here</a>). This release marks another step in the maturity of our larger <a href=\"https://www.consul.io/docs/nia\">Network Infrastructure Automation (NIA)</a> solution. The focus for CTS is on automating Day 2 networking tasks and reducing the burden on operators caused by manual ticketing systems.</p>\n<p>This post will highlight the new features in CTS 0.4, including changes to trigger tasks in Consul KV and the extension of policy and governance functionality from the previous release into the Terraform Cloud integration. We’ll also discuss the benefits of Terraform Cloud integration and share an exciting new integration with Oracle Cloud Infrastructure. CTS 0.4 is <a href=\"https://releases.hashicorp.com/consul-terraform-sync/\">available for download on our release page</a>. But, before we dive into what’s new in CTS 0.4, let’s take a look at how CTS has progressed over the past few releases.</p>\n<h2><a href=\"#cts-0-1-through-0-3\">»</a><a></a>CTS 0.1 Through 0.3</h2>\n<p>The <a href=\"https://releases.hashicorp.com/consul-terraform-sync/0.1.0/\">0.1</a> and <a href=\"https://releases.hashicorp.com/consul-terraform-sync/0.2.0/\">0.2</a> CTS releases enabled a publisher-subscriber (pub-sub) paradigm for updating your network infrastructure based on changes in the <a href=\"https://www.consul.io/api-docs/catalog\">HashiCorp Consul catalog</a>, leveraging the Terraform CLI on the local node. These releases focused on establishing core networking use cases for practitioners, including applying firewall policies, updating load-balancer member pools, and more.</p>\n<p>The <a href=\"https://releases.hashicorp.com/consul-terraform-sync/0.3.0+ent/\">0.3</a> release of Consul-Terraform-Sync featured regex support for service triggers and Terraform Enterprise integration. The integration allowed organizations to dynamically manage their Day 2 applications’ networking delivery lifecycle and oversee infrastructure with governance and security functionality.</p>\n<h2><a href=\"#cts-integration-with-terraform-cloud\">»</a><a></a>CTS Integration with Terraform Cloud</h2>\n<p>CTS integration with Terraform Cloud is a Consul Enterprise-only feature available through the CTS Cloud binary. To get started, operators require a valid Consul Enterprise license that supports a new CTS network driver named <a href=\"https://www.consul.io/docs/nia/network-drivers/terraform-cloud\">Terraform Cloud driver</a>:</p><pre><code>driver \"terraform-cloud\" {\n  hostname     = \"app.terraform.io\"\n  organization = \"my-org\"\n  token        = \"\"\n  // Optionally set the token to be securely queried from Vault instead of\n  // written directly to the configuration file.\n  // token = \"{{ with secret \\\"secret/my/path\\\" }}{{ .Data.data.foo }}{{ end }}\"\n\n  required_providers {\n    myprovider = {\n      source = \"namespace/myprovider\"\n      version = \"1.3.0\"\n    }\n  }\n}</code></pre><p><em><a href=\"https://www.consul.io/docs/nia/tasks\">Tasks</a></em> are the heart of Consul-Terraform-Sync’s automation capabilities. The Terraform Cloud driver enables the creation and management of Terraform Cloud workspaces for all tasks defined in CTS configuration using the <a href=\"https://www.terraform.io/docs/cloud/run/api.html\">API-driven run workflow</a>.</p><img src=\"https://www.datocms-assets.com/2885/1630516110-tasks-in-tfe.png\" /><p><em>A Terraform Cloud workspace created and managed by CTS.</em></p>\n<p>Users of the CTS integration with Terraform Cloud can do a number of useful things, including:</p>\n<ul>\n<li><strong>Scale resources:</strong> Reduce dependency on ticketing systems traditionally handled by networking and security teams, allowing them to <a href=\"https://www.consul.io/docs/nia\">optimize their workflows</a> to match the velocity of development teams.</li>\n<li><strong>Reduce risk:</strong> Provide teams with <a href=\"https://www.terraform.io/docs/cloud/workspaces/state.html\">distinct workspaces</a> that clearly define users’ privileges to access and manipulate resources. Restricting access to sensitive information can reduce human-driven misconfiguration errors and potential data leakage.</li>\n<li><strong>Improve automation controls:</strong> Choose the desired level of automation with approval workflows. While end-to-end automation may be the end goal, many organizations opt for an incremental approach. Set <a href=\"https://www.terraform.io/docs/cloud/workspaces/notifications.html\">notification triggers </a>to inform a team member when a predetermined event occurs. They can review a plan quickly to verify that the configuration is as expected and apply the changes with just a few clicks.</li>\n<li><strong>Simplify auditing:</strong> Automatically <a href=\"https://www.terraform.io/docs/enterprise/admin/logging.html\">catalog every change</a> made to the environment. Provide a comprehensive forensic trail to keep compliance teams in the loop and analyze issues as they arise.</li>\n<li><strong>Apply compliance policies:</strong> <a href=\"https://www.terraform.io/docs/cloud/sentinel/index.html\">Policy as code with Sentinel</a> allows organizations to define, manage, and enforce key policies to safeguard against potentially dangerous actions and encourage efficient use of resources.</li>\n</ul>\n<h2><a href=\"#trigger-tasks-on-consul-kv-changes\">»</a><a></a>Trigger Tasks on Consul KV Changes</h2>\n<p>In addition to securing network traffic and providing service discovery and integrated health checking, Consul includes a key-value (KV) store, which you can use to dynamically configure applications and coordinate services, along with a myriad of other uses.</p>\n<p>With the 0.4 release, CTS now allows users to subscribe to a Consul KV prefix and automatically trigger a task whenever the prefix is created, deleted, or updated. Potential workflows that can be enabled through this CTS capability include blue/green deployments, which shift traffic from one load balancer to another by populating the appropriate backend pool members to avoid downtime.</p>\n<p>Available for both CTS OSS and Enterprise binaries, this capability can be configured for a single Consul KV entry or for any Consul KV entries that are prefixed with a given path:</p><pre><code>task {\n  name = \"consul_kv_condition_task\"\n  description = \"execute on changes to Consul KV entry\"\n  source = \"path/to/consul-kv-module\"\n  providers = [\"my-provider\"]\n  services = [\"web-api\"]\n\n  condition \"consul-kv\" {\n\tpath            \t= \"my-key\"\n\trecurse         \t= false\n\tdatacenter      \t= \"dc1\"\n\tnamespace       \t= \"default\"\n\tsource_includes_var = false\n  }\n}</code></pre><h2><a href=\"#cts-for-terraform-cloud-partnership-with-oracle-cloud-infrastructure\">»</a><a></a>CTS for Terraform Cloud Partnership with Oracle Cloud Infrastructure</h2>\n<p>The partner ecosystem is at the core of CTS for Terraform Cloud. That’s why we are pleased to announce a new integration with Oracle, allowing Oracle Cloud Infrastructure (OCI) customers to automate Day 2 networking operations across hybrid and multi-cloud environments. Our friends at Oracle shared a few words about the value of this integration in helping workloads scale to alleviate network outages caused by sudden load spikes:</p>\n<p><strong>Oracle Cloud Infrastructure: Consul-Terraform-Sync Sample Solution</strong></p>\n<blockquote>\n<p>“Oracle is pleased to announce a sample Consul-Terraform-Sync (CTS) solution that updates Oracle Cloud Infrastructure (OCI) Load Balancer (LB) Backend servers dynamically, based upon changes to a Consul service.  While this is a very simple solution, it highlights how easy it is for customers to build their own solutions leveraging CTS to rapidly scale their OCI infrastructure.  Oracle and HashiCorp are working together to help ensure that users have the automated workflows required to achieve a repeatable application deployment lifecycle in a compliance centric manner.  Our mutual customers are able to create their own CTS-based solutions that allow them to push out OCI infrastructure changes in a matter of minutes based on dynamic changes to application services, reducing operational complexity, reducing overhead, and enhancing performance.” — Tim Clegg, DevSecOps, Developer Relations, Oracle</p>\n</blockquote>\n<h2><a href=\"#learn-more-and-get-started\">»</a><a></a>Learn More and Get Started</h2>\n<p>CTS supports an integration with Terraform Cloud to let organizations manage their application networking delivery lifecycle in a more dynamic way, while providing governance and security oversight. This capability is delivered as an enterprise feature through the CTS for Terraform Cloud binary.</p>\n<p>To learn more about Consul-Terraform-Sync for Terraform Cloud please check out our <a href=\"https://www.consul.io/docs/nia\">documentation</a> and our tutoials on HashiCorp Learn.</p><p>Feel free to try out CTS 0.4 and give us feedback in the <a href=\"https://github.com/hashicorp/consul-terraform-sync/issues\">issue tracker</a>. You can also stay up to date on CTS by following our <a href=\"https://github.com/hashicorp/consul-terraform-sync/projects/1\">public roadmap</a> or checking the <a href=\"https://github.com/hashicorp/consul-terraform-sync/blob/master/CHANGELOG.md\">changelog</a>. For more information about Consul, please visit our <a href=\"https://www.hashicorp.com/products/consul\">product page</a>.</p>","author":"Devarshi Shah","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"69076634228a4c797354d7b41eed43e16bd78f4a1cde43a8388c76ca196f89cf","category":"Tech"}