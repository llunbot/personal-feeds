{"title":"EC2-Classic is Retiring – Here’s How to Prepare","link":"https://aws.amazon.com/blogs/aws/ec2-classic-is-retiring-heres-how-to-prepare/","date":1627502242000,"content":"<p>Let’s go back to the summer of 2006 and the <a href=\"https://aws.amazon.com/blogs/aws/amazon_ec2_beta/\">launch of EC2</a>. We started out with one instance type (the venerable <a href=\"https://aws.amazon.com/blogs/aws/amazon_ec2_beta/\"><strong>m1.small</strong></a>), security groups, and the venerable <span>US East (N. Virginia)</span> Region. The <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html\">EC2-Classic</a> network model was <a href=\"https://en.wikipedia.org/wiki/Flat_network\">flat</a>, with public IP addresses that were assigned at launch time.</p> \n<p><img src=\"https://media.amazonwebservices.com/blog/2021/ec2_platforms_2.png\" />Our initial customers saw the value right away and started to put EC2 to use in many different ways. We hosted web sites, <a href=\"https://aws.amazon.com/blogs/aws/amazon-ec2-help/\">supported the launch</a> of Justin.TV, and <a href=\"https://aws.amazon.com/blogs/aws/animoto-scali/\">helped Animoto</a> to scale to a then-amazing 3400 instances when their Facebook app went viral.</p> \n<p>Some of the early enhancements to EC2 focused on networking. For example, we added <a href=\"https://aws.amazon.com/blogs/aws/new-ec2-feature/\">Elastic IP addresses</a> in early 2008 so that addresses could be long-lived and associated with different instances over time if necessary. After that we added <a href=\"https://aws.amazon.com/blogs/aws/new-aws-load-balancing-automatic-scaling-and-cloud-monitoring-services/\">Auto Scaling, Load Balancing, and CloudWatch</a> to help you to build highly scalable applications.</p> \n<p>Early customers wanted to connect their EC2 instances to their corporate networks, exercise additional control over IP address ranges, and to construct more sophisticated network topologies. We launched <a href=\"https://aws.amazon.com/blogs/aws/introducing-amazon-virtual-private-cloud-vpc/\">Amazon Virtual Private Cloud</a> in 2009, and in 2013 we made the VPC model essentially transparent with <a href=\"https://aws.amazon.com/blogs/aws/amazon-ec2-update-virtual-private-clouds-for-everyone/\">Virtual Private Clouds for Everyone</a>.</p> \n<p><span><strong>Retiring EC2-Classic</strong></span><br /> EC2-Classic has served us well, but we’re going to give it a gold watch and a well-deserved sendoff! This post will tell you what you need to know, what you need to do, and when you need to do it.</p> \n<p>Before I dive in, rest assured that we are going to make this as smooth and as non-disruptive as possible. We are not planning to disrupt any workloads and we are giving you plenty of lead time so that you can plan, test, and perform your migration. In addition to this blog post, we have tools, documentation, and people that are all designed to help.</p> \n<p><span><strong>Timing</strong></span><br /> We are already notifying the remaining EC2-Classic customers via their account teams, and will soon start to issue notices in the Personal Health Dashboard. Here are the important dates for your calendar:</p> \n<ul> \n <li>All AWS accounts created after <strong>December 4, 2013</strong> are already VPC-only, unless EC2-Classic was enabled as a result of a support request.</li> \n <li><strong>On October 30, 2021</strong> we will disable EC2-Classic in Regions for AWS accounts that have no active EC2-Classic resources in the Region, as listed below. We will also stop selling 1-year and 3-year Reserved Instances for EC2-Classic.</li> \n <li>On <strong>August 15, 2022</strong> we expect all migrations to be complete, with no remaining EC2-Classic resources present in any AWS account.</li> \n</ul> \n<p>Again, we don’t plan to disrupt any workloads and will do our best to help you to meet these dates.</p> \n<p><span><strong>Affected Resources</strong></span><br /> In order to fully migrate from EC2-Classic to VPC, you need to find, examine, and migrate all of the following resources:</p> \n<ul> \n <li>Running or stopped EC2 instances.</li> \n <li>Running or stopped RDS database instances.</li> \n <li>Elastic IP addresses – You can use the <a href=\"https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/move-address-to-vpc.html\"><code>move-address-to-vpc</code></a> command.</li> \n <li>Classic Load Balancers – <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/migrate-classic-load-balancer.html#migrate-step-by-step-classiclink\">Migrate Your Classic Load Balancer</a>.</li> \n <li>Redshift clusters – <a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/move-redshift-cluster-vpcs/\">How do I Move my Amazon Redshift Cluster</a>.</li> \n <li>Elastic Beanstalk environments – <a href=\"https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/vpc-ec2migration.html\">Migrating Elastic Beanstalk environments from EC2-Classic to a VPC</a>.</li> \n <li>EMR clusters – <a href=\"https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-vpc-subnet.html\">Configure EMR Networking</a>.</li> \n <li>AWS Data Pipelines pipelines – <a href=\"https://docs.aws.amazon.com/datapipeline/latest/DeveloperGuide/dp-resources-vpc.html\">Launching Resources for Your Pipeline into a VPC</a>.</li> \n <li>ElastiCache clusters – <a href=\"https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/VPCs.EC.html\">Understanding ElastiCache and Amazon VPCs</a>.</li> \n <li>Reserved Instances – You can modify these as described in the <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ri-modifying.html#ri-modification-limits\">User Guide</a>.</li> \n <li>Spot Requests.</li> \n <li>Capacity Reservations.</li> \n</ul> \n<p>In preparation for your migration, be sure to read <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/vpc-migrate.html\">Migrate from EC2-Classic to a VPC</a>.</p> \n<p>You may need to create (or re-create, if you deleted it) the default VPC for your account. To learn how to do this, read <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/default-vpc.html#create-default-vpc\">Creating a Default VPC</a>.</p> \n<p>In some cases you will be able to modify the existing resources; in others you will need to create new and equivalent resources in a VPC.</p> \n<p><span><strong>Finding EC2-Classic Resources</strong></span><br /> Use the <a href=\"https://github.com/aws-samples/ec2-classic-resource-finder\">EC2 Classic Resource Finder</a> script to find all of the EC2-Classic resources in your account. You can run this directly in a single AWS account, or you can use the included <code>multi-account-wrapper</code> to run it against each account of an AWS Organization. The Resource Finder visits each AWS Region, looks for specific resources, and generates a set of CSV files. Here’s the first part of the output from my run:</p> \n<p><img src=\"https://media.amazonwebservices.com/blog/2021/bye_bye_classic_finder_out_1.png\" /></p> \n<p>The script takes a few minutes to run. I inspect the list of CSV files to get a sense of how much work I need to do:</p> \n<p><img src=\"https://media.amazonwebservices.com/blog/2021/bye_bye_classic_finder_csvs_1.png\" /></p> \n<p>And then I take a look inside to learn more:</p> \n<p><img src=\"https://media.amazonwebservices.com/blog/2021/bye_bye_classic_finder_ops_1.png\" /></p> \n<p>Turns out that I have some stopped OpsWorks Stacks that I can either migrate or delete:</p> \n<p><img src=\"https://media.amazonwebservices.com/blog/2021/bye_bye_classic_ops_stacks_1.png\" /></p> \n<p><span><strong>Migration Tools</strong></span><br /> Here’s an overview of the migration tools that you can use to migrate your AWS resources:</p> \n<p><strong>AWS Application Migration Service</strong> – Use <a href=\"https://aws.amazon.com/application-migration-service/\">AWS MGN</a> to migrate your instances and your databases from EC2-Classic to VPC with minimal downtime. This service uses block-level replication and runs on multiple versions of Linux and Windows (read <a href=\"https://aws.amazon.com/blogs/aws/how-to-use-the-new-aws-application-migration-service-for-lift-and-shift-migrations/\">How to Use the New AWS Application Migration Service for Lift-and-Shift Migrations</a> to learn more). The first 90 days of replication are free for each server that you migrate; see the <a href=\"https://aws.amazon.com/application-migration-service/pricing/\">AWS Application Service Pricing</a> page for more information.</p> \n<p><strong>Support Automation Workflow</strong> – This workflow supports simple, instance-level migration. It converts the source instance to an AMI, creates mirrors of the security groups, and launches new instances in the destination VPC.</p> \n<p>After you have migrated all of the resources within a particular region, you can disable EC2-Classic by creating a support case. You can do this if you want to avoid accidentally creating new EC2-Classic resources in the region, but it is definitely not required.</p> \n<p>Disabling EC2-Classic in a region is intended to be a one-way door, but you can contact AWS Support if you run it and then find that you need to re-enable EC2-Classic for a region. Be sure to run the Resource Finder that mentioned earlier and make sure that you have not left any resources behind. These resources will continue to run and to accrue charges even after the account status has been changed.</p> \n<p><strong>IP Address Migration</strong> – If you are migrating an EC2 instance and any Elastic IP addresses associated with the instance, you can use <code>move-address-to-vpc</code> then attach the Elastic IP to the migrated instance. This will allow you to continue to reference the instance by the original DNS name.</p> \n<p><strong>Classic Load Balancers</strong> – If you plan to migrate a Classic Load Balancer and need to preserve the original DNS names, please contact AWS Support or your AWS account team.</p> \n<p><span><strong>Updating Instance Types</strong></span><br /> All of the instance types that are available in EC2-Classic are also available in VPC. However, many newer instance types are available only in VPC, and you may want to consider an update as part of your overall migration plan. Here’s a map to get you started:</p> \n<table> \n <tbody> \n  <tr> \n   <td><strong>EC2-Classic</strong></td> \n   <td><strong>VPC</strong></td> \n  </tr> \n  <tr> \n   <td>M1, T1</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/low-cost-burstable-ec2-instances/\">T2</a></td> \n  </tr> \n  <tr> \n   <td>M3</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/m5-the-next-generation-of-general-purpose-ec2-instances/\">M5</a></td> \n  </tr> \n  <tr> \n   <td>C1, C3</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/now-available-compute-intensive-c5-instances-for-amazon-ec2/\">C5</a></td> \n  </tr> \n  <tr> \n   <td>CC2</td> \n   <td><a href=\"https://aws.amazon.com/hpc/parallelcluster/\">AWS ParallelCluster</a></td> \n  </tr> \n  <tr> \n   <td>CR1, M2, R3</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/new-next-generation-r4-memory-optimized-ec2-instances/\">R4</a></td> \n  </tr> \n  <tr> \n   <td>D2</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/ec2-update-d3-d3en-dense-storage-instances/\">D3</a></td> \n  </tr> \n  <tr> \n   <td>HS1</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/next-generation-of-dense-storage-instances-for-ec2/\">D2</a></td> \n  </tr> \n  <tr> \n   <td>I2</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/now-available-i3-instances-for-demanding-io-intensive-applications/\">I3</a></td> \n  </tr> \n  <tr> \n   <td>G2</td> \n   <td><a href=\"https://aws.amazon.com/blogs/aws/new-next-generation-gpu-powered-ec2-instances-g3/\">G3</a></td> \n  </tr> \n </tbody> \n</table> \n<p><span><strong>Count on Us</strong></span><br /> My colleagues in AWS Support are ready to help you with your migration to VPC. I am also planning to update this post with additional information and other migration resources as soon as they become available.</p> \n<p>— <a href=\"https://twitter.com/jeffbarr\">Jeff</a>;</p> \n<p> </p>","author":"Jeff Barr","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"8ab989f211eff1ea7dbf3a3103e0a3291455126ed308a52d961ea135f8227292","category":"Tech"}