{"title":"Before you build agentic AI, understand the confused deputy problem","link":"https://www.hashicorp.com/blog/before-you-build-agentic-ai-understand-the-confused-deputy-problem","date":1747670400000,"content":"<p>We are seeing a lot of internal, assistance-based AI use cases for:</p>\n\n<ul>\n<li>Topic research</li>\n<li>R&amp;D</li>\n<li>Code generation</li>\n<li>Data analysis</li>\n<li>Marketing</li>\n<li>and other tasks</li>\n</ul>\n\n<p>What we are not seeing (yet) is a plethora of external, customer-facing use cases (beyond chatbots), where customers are engaging directly with AI.</p>\n\n<p>But this is about to change ... and fast.</p>\n\n<p>In his <a href=\"https://www.ibm.com/think/videos/think-keynotes/enterprise-ai-value\">keynote address</a> at <a href=\"https://www.ibm.com/events/think\">Think 2025</a>, Arvind Krishna, IBM Chairman and CEO, said the time of AI experimentation is over, and organizations are moving quickly to deliver business value through AI.</p>\n\n<p>AI generally is a challenge within the enterprise. Its usefulness is directly correlated with access to data and its ability to predict answers (provide what we view as intelligence). The challenge is that the language models available to the generative AI will need to include sensitive information as we pivot to more enterprise use cases. GenAI does not have much power on its own, but when we grant it access to applications that it can act on and through, we begin to see real power through automation. </p>\n\n<p><a href=\"https://hbr.org/2024/12/what-is-agentic-ai-and-how-will-it-change-work\">Agentic AI</a> is a new pattern where a series of AIs work together to produce a result. Multi-agent generative AI workflows offer even more power by orchestrating fine-grained control on complex tasks. Where straight(er)forward GenAI provides broad leverage of data to support a human actor (generally), Agentic flows support humans, but leverage each other in progressively more complex ways.</p>\n\n<p>Organizations need to be ready to mitigate a number of risks that come with this new wave of AI. This post will explain how a well-known problem in InfoSec — the confused deputy problem — can help you think about risks in the agentic AI era.</p>\n\n<h2>Risks in agentic AI</h2>\n\n<p>Up to now, organizations have been cautious about deploying AI externally, and for good reasons. AI is incredibly powerful, but it is not perfect. Mistakes can leave a customer dissatisfied with their experience. And there is a risk that a bad actor can take advantage of what the AI system is doing.</p>\n\n<h3>The confused deputy problem</h3>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Confused_deputy_problem\">confused deputy problem</a> is a good illustration. This occurs when a user, application, or machine tricks a higher-privileged entity (system) into exposing sensitive data, performing a damaging action, or allowing unauthorized access to restricted functions. This risk is way more obvious in GenAI work. Not only is GenAI effective at gaining access to <a href=\"https://www.tomshardware.com/news/ai-cracks-most-common-passwords-in-less-than-a-minute\">passwords</a> (basic hacking stuff), but AI loves to be helpful. Imagine a demo where we import an email archive to an OpenAI engine, and in minutes, the AI helps us to isolate cloud credentials in the archive. This is a compelling example of how I can ‘confuse my AI deputy’ into showing me risky information. </p>\n\n<p>The risk associated with confused deputy attacks is especially high in multi-agent generative AI systems as more agents = more applications = more data and a chain of systems calls that are often using their own permissions (not the user who requested).</p>\n<img src=\"https://www.datocms-assets.com/2885/1747668486-single-and-multi-agent-architectures.png\" alt=\"Comparison\" /><h3>Multi-agent generative AI and its risks</h3>\n\n<p>Think about how multi-agent generative AI works. Let’s use software development as an example. I can create an agentic pattern where… </p>\n\n<ol>\n<li>One agent writes code</li>\n<li>Another agent critiques the code for errors</li>\n<li>A third agent analyzes the code for best practice coding standards</li>\n</ol>\n\n<p>In this scenario, two agents check up on another agent’s work. This is a fairly safe usage as a human gets involved to test, approve, and promote the code. As the developer, I buffer for any mistakes this AI chain might make. This can be very productive and low-risk.</p>\n\n<p>But what about another example, such as financial trades? I can create an agentic pattern where…</p>\n\n<ol>\n<li>An AI agent recommends a trade</li>\n<li>Another agent critiques it</li>\n<li>A third checks for SEC violations, etc. </li>\n</ol>\n\n<p>… and finally, an algorithmic trading decision is executed. It’s very productive but very high risk because there’s no human in the loop. (Humans are also very risky, but that is for another dialogue.) In this example, as an institutional trading firm, I am way more likely to stay with human traders managing an AI assistant due to the overwhelming risk a mistake imposes on profitability.</p>\n\n<p>These multi-agent patterns are interconnected and complex — one AI calling another AI, calling another AI, and so on. Each step in the workflow increases the attack surface. All a bad actor needs to do is convince one agent to give them rights that they shouldn’t have, and now, potentially, I have a cascading set of vulnerabilities.</p>\n\n<h2>Laying a more secure foundation</h2>\n\n<p>With agentic AI systems, credentials are used everywhere to grant and restrict privileges. They are used for every API call to a third-party application. There are credentials for every user and application, an AI agent interacting with an AI agent. It is a complex process which, if not managed well, could lead to a sprawling estate of secrets.</p>\n\n<p>To prepare for this, organizations need dynamic environments. This way, if a problem is discovered—i.e., an AI agent is misused, a confused deputy scenario occurs, or sensitive data is exposed—organizations can quickly take action to tear down and destroy environments and build them up again, this time with tighter controls.</p>\n\n<p>This requires automation. When the delivery of systems is automated from end-to-end using predefined workflows, <a href=\"https://www.hashicorp.com/en/resources/what-is-infrastructure-as-code\">infrastructure as code</a>, and <a href=\"https://developer.hashicorp.com/vault/docs/concepts/identity\">identity-based security</a>, organizations can easily shut down, move, destroy, and build environments while also adding policies and credentials without requiring a lot of human involvement. Attack surfaces are not necessarily reduced, but risk is mitigated. Mean time to resolve (MTTR) is significantly improved and easier to measure through automation.</p>\n\n<p>Consider an AI support aid for customer service representatives. I would like to have the ability to build the environment with the latest trained models, but I would also like to cascade the appropriate user permissions through the agentic chain as data (RAG, databases, archives, other) is being requested so as to prevent the unauthorized data from even being available to the AIs in question. This kind of guardrail is a more ‘first principle’ style of proactivity that will yield tremendous downstream benefits by improving the cost and risk profile of everything that you do with AI.</p>\n\n<p>The world is becoming more dynamic, not less. If organizations aren’t already using dynamic infrastructure unlocked with <a href=\"https://www.hashicorp.com/en/blog/why-we-need-short-lived-credentials-and-how-to-adopt-them\">dynamic secrets</a>, they risk falling behind. The agentic AI push is going to continue at pace, and if we want to use it experimentally and get value from it, we need to be able to control the risks surrounding it.</p>\n\n<h2>Prepare for the AI era</h2>\n\n<p><a href=\"https://www.hashicorp.com/en/infrastructure-cloud\">The Infrastructure Cloud</a> from HashiCorp is a unified platform that helps organizations make the most of cloud investments and prepare for mitigating the security risks associated with AI. It lets you manage the full lifecycle of your infrastructure and security resources through infrastructure as code, policy as code, and dynamic secrets management, and automated workflows to create safe, dynamic environments. </p>\n\n<p>If you’re tired of technology and process fragmentation in your organization, learn how a platform-based approach to security and infrastructure automation can transform your teams for the better. Read <a href=\"https://www.hashicorp.com/en/on-demand/infrastructure-cloud-whitepaper?utm_source=hashicorp.com&amp;utm_medium=referral&amp;utm_campaign=26Q2_WW_BDM_RISK_confused-deputy&amp;utm_content=learn-more-conclusion&amp;utm_offer=whitepaper\">Do cloud right with The Infrastructure Cloud</a>.</p>\n","author":"Michael Wood","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"9614a1634b01d613f12d500804a5fbc6df35998302f05d4a90d6033df2468178","category":"Tech"}