{"title":"New – Amazon EC2 P5 Instances Powered by NVIDIA H100 Tensor Core GPUs for Accelerating Generative AI and HPC Applications","link":"https://aws.amazon.com/blogs/aws/new-amazon-ec2-p5-instances-powered-by-nvidia-h100-tensor-core-gpus-for-accelerating-generative-ai-and-hpc-applications/","date":1690387947000,"content":"<p>In March 2023, AWS and NVIDIA <a href=\"https://press.aboutamazon.com/2023/3/aws-and-nvidia-collaborate-on-next-generation-infrastructure-for-training-large-machine-learning-models-and-building-generative-ai-applications\">announced a multipart collaboration</a> focused on building the most scalable, on-demand artificial intelligence (AI) infrastructure optimized for training increasingly complex large language models (LLMs) and developing generative AI applications.</p> \n<p>We preannounced <a href=\"https://aws.amazon.com/ec2/?trk=9d4767e6-9ba4-4d8b-9993-6863113035cd&amp;sc_channel=el\">Amazon Elastic Compute Cloud</a> (Amazon EC2) P5 instances powered by NVIDIA H100 Tensor Core GPUs and AWS’s latest networking and scalability that will deliver up to 20 exaflops of compute performance for building and training the largest machine learning (ML) models. This announcement is the product of more than a decade of collaboration between <a href=\"https://aws.amazon.com/nvidia/\">AWS and NVIDIA</a>, delivering the visual computing, AI, and high performance computing (HPC) clusters across the <a href=\"https://aws.amazon.com/blogs/aws/new-ec2-instance-type-the-cluster-gpu-instance/\">Cluster GPU</a> (cg1) instances (2010), <a href=\"https://aws.amazon.com/blogs/aws/build-3d-streaming-applications-with-ec2s-new-g2-instance-type/\">G2</a> (2013), <a href=\"https://aws.amazon.com/blogs/aws/new-p2-instance-type-for-amazon-ec2-up-to-16-gpus/\">P2</a> (2016), <a href=\"https://aws.amazon.com/blogs/aws/new-amazon-ec2-instances-with-up-to-8-nvidia-tesla-v100-gpus-p3/\">P3</a> (2017), <a href=\"https://aws.amazon.com/blogs/aws/new-next-generation-gpu-powered-ec2-instances-g3/\">G3</a> (2017), <a href=\"https://aws.amazon.com/blogs/aws/new-ec2-p3dn-gpu-instances-with-100-gbps-networking-local-nvme-storage-for-faster-machine-learning-p3-price-reduction/\">P3dn</a> (2018), <a href=\"https://aws.amazon.com/blogs/aws/now-available-ec2-instances-g4-with-nvidia-t4-tensor-core-gpus/\">G4</a> (2019), <a href=\"https://aws.amazon.com/blogs/aws/new-gpu-equipped-ec2-p4-instances-for-machine-learning-hpc/\">P4</a> (2020), <a href=\"https://aws.amazon.com/blogs/aws/new-ec2-instances-g5-with-nvidia-a10g-tensor-core-gpus/\">G5</a> (2021), and <a href=\"https://aws.amazon.com/about-aws/whats-new/2022/05/amazon-ec2-p4de-gpu-instances-ml-training-hpc/\">P4de instances</a> (2022).</p> \n<p>Most notably, ML model sizes are now reaching trillions of parameters. But this complexity has increased customers’ time to train, where the latest LLMs are now trained over the course of multiple months. HPC customers also exhibit similar trends. With the fidelity of HPC customer data collection increasing and data sets reaching exabyte scale, customers are looking for ways to enable faster time to solution across increasingly complex applications.</p> \n<p><strong><u>Introducing EC2 P5 Instances</u></strong><br /> Today, we are announcing the general availability of <a href=\"https://aws.amazon.com/ec2/instance-types/p5/?trk=51dd90cd-4bb6-46ef-9b65-d7c6ef3705af&amp;sc_channel=el\"><strong>Amazon EC2 P5 instances</strong></a>, the next-generation GPU instances to address those customer needs for high performance and scalability in AI/ML and HPC workloads. P5 instances are powered by the latest NVIDIA H100 Tensor Core GPUs and will provide a reduction of up to 6 times in training time (from days to hours) compared to previous generation GPU-based instances. This performance increase will enable customers to see up to 40 percent lower training costs.</p> \n<p>P5 instances provide 8 x NVIDIA H100 Tensor Core GPUs with 640 GB of high bandwidth GPU memory, 3rd Gen AMD EPYC processors, 2 TB of system memory, and 30 TB of local NVMe storage. P5 instances also provide 3200 Gbps of aggregate network bandwidth with support for GPUDirect RDMA, enabling lower latency and efficient scale-out performance by bypassing the CPU on internode communication.</p> \n<p>Here are the specs for these instances:</p> \n<table> \n <tbody> \n  <tr> \n   <td><strong>Instance<br /> Size</strong></td> \n   <td><strong>vCPUs</strong></td> \n   <td><strong>Memory<br /> (GiB)</strong></td> \n   <td><strong>GPUs<br /> (H100)</strong></td> \n   <td><strong>Network Bandwidth<br /> (Gbps)</strong></td> \n   <td><strong>EBS Bandwidth<br /> (Gbps)</strong></td> \n   <td><strong>Local Storage<br /> (TB)</strong></td> \n  </tr> \n  <tr> \n   <td><strong>P5.48xlarge</strong></td> \n   <td>192</td> \n   <td>2048</td> \n   <td>8</td> \n   <td>3200</td> \n   <td>80</td> \n   <td>8 x 3.84</td> \n  </tr> \n </tbody> \n</table> \n<p>Here’s a quick infographic that shows you how the P5 instances and NVIDIA H100 Tensor Core GPUs compare to previous instances and processors:</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/07/25/2023-ec2-p5-instances-infographic.jpg\" alt width=\"1270\" height=\"664\" /></p> \n<p>P5 instances are ideal for training and running inference for increasingly complex LLMs and computer vision models behind the most demanding and compute-intensive generative AI applications, including question answering, code generation, video and image generation, speech recognition, and more. P5 will provide up to 6 times lower time to train compared with previous generation GPU-based instances across those applications. Customers who can use lower precision FP8 data types in their workloads, common in many language models that use a transformer model backbone, will see further benefit at up to 6 times performance increase through support for the NVIDIA transformer engine.</p> \n<p>HPC customers using P5 instances can deploy demanding applications at greater scale in pharmaceutical discovery, seismic analysis, weather forecasting, and financial modeling. Customers using dynamic programming (DP) algorithms for applications like genome sequencing or accelerated data analytics will also see further benefit from P5 through support for a new DPX instruction set.</p> \n<p>This enables customers to explore problem spaces that previously seemed unreachable, iterate on their solutions at a faster clip, and get to market more quickly.</p> \n<p>You can see the detail of instance specifications along with comparisons of instance types between <strong>p4d.24xlarge</strong> and new <strong>p5.48xlarge</strong> below:</p> \n<table> \n <tbody> \n  <tr> \n   <td><strong>Feature</strong></td> \n   <td><strong>p4d.24xlarge</strong></td> \n   <td><strong>p5.48xlarge</strong></td> \n   <td><strong>Comparision</strong></td> \n  </tr> \n  <tr> \n   <td>Number &amp; Type of Accelerators</td> \n   <td>8 x NVIDIA A100</td> \n   <td>8 x NVIDIA H100</td> \n   <td>–</td> \n  </tr> \n  <tr> \n   <td>FP8 TFLOPS per Server</td> \n   <td>–</td> \n   <td>16,000</td> \n   <td>640% vs.A100 FP16</td> \n  </tr> \n  <tr> \n   <td>FP16 TFLOPS per Server</td> \n   <td>2,496</td> \n   <td>8,000</td> \n  </tr> \n  <tr> \n   <td>GPU Memory</td> \n   <td>40 GB</td> \n   <td>80 GB</td> \n   <td>200%</td> \n  </tr> \n  <tr> \n   <td>GPU Memory Bandwidth</td> \n   <td>12.8 TB/s</td> \n   <td>26.8 TB/s</td> \n   <td>200%</td> \n  </tr> \n  <tr> \n   <td>CPU Family</td> \n   <td>Intel Cascade Lake</td> \n   <td>AMD Milan</td> \n   <td>–</td> \n  </tr> \n  <tr> \n   <td>vCPUs</td> \n   <td>96</td> \n   <td> 192</td> \n   <td>200%</td> \n  </tr> \n  <tr> \n   <td>Total System Memory</td> \n   <td>1152 GB</td> \n   <td>2048 GB</td> \n   <td>200%</td> \n  </tr> \n  <tr> \n   <td>Networking Throughput</td> \n   <td>400 Gbps</td> \n   <td>3200 Gbps</td> \n   <td>800%</td> \n  </tr> \n  <tr> \n   <td>EBS Throughput</td> \n   <td>19 Gbps</td> \n   <td>80 Gbps</td> \n   <td>400%</td> \n  </tr> \n  <tr> \n   <td>Local Instance Storage</td> \n   <td>8 TBs NVMe</td> \n   <td>30 TBs NVMe</td> \n   <td>375%</td> \n  </tr> \n  <tr> \n   <td>GPU to GPU Interconnect</td> \n   <td>600 GB/s</td> \n   <td>900 GB/s</td> \n   <td>150%</td> \n  </tr> \n </tbody> \n</table> \n<p><strong><u>Second-generation Amazon EC2 UltraClusters and Elastic Fabric Adaptor</u></strong><br /> P5 instances provide market-leading scale-out capability for multi-node distributed training and tightly coupled HPC workloads. They offer up to 3,200 Gbps of networking using the second-generation <a href=\"https://aws.amazon.com/hpc/efa/\">Elastic Fabric Adaptor</a> (EFA) technology, 8 times compared with P4d instances.</p> \n<p>To address customer needs for large-scale and low latency, P5 instances are deployed in the second-generation EC2 UltraClusters, which now provide customers with lower latency across up to 20,000+ NVIDIA H100 Tensor Core GPUs. Providing the largest scale of ML infrastructure in the cloud, P5 instances in EC2 UltraClusters deliver up to 20 exaflops of aggregate compute capability.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/07/25/2023-ec2-p5-instances-ultracluster.jpg\" alt width=\"1754\" height=\"852\" /></p> \n<p>EC2 UltraClusters use <a href=\"https://aws.amazon.com/fsx/lustre/\">Amazon FSx for Lustre</a>, fully managed shared storage built on the most popular high-performance parallel file system. With FSx for Lustre, you can quickly process massive datasets on demand and at scale and deliver sub-millisecond latencies. The low-latency and high-throughput characteristics of FSx for Lustre are optimized for deep learning, generative AI, and HPC workloads on EC2 UltraClusters.</p> \n<p>FSx for Lustre keeps the GPUs and ML accelerators in EC2 UltraClusters fed with data, accelerating the most demanding workloads. These workloads include LLM training, generative AI inferencing, and HPC workloads, such as genomics and financial risk modeling.</p> \n<p><strong><u>Getting Started with EC2 P5 Instances</u></strong><br /> To get started, you can use P5 instances in the US East (N. Virginia) and US West (Oregon) Region.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2023/07/25/2023-ec2-p5-instances-console.jpg\" alt width=\"2454\" height=\"1300\" /></p> \n<p>When launching P5 instances, you will choose <a href=\"https://aws.amazon.com/machine-learning/amis/\">AWS Deep Learning AMIs</a> (DLAMIs) to support P5 instances. DLAMI provides ML practitioners and researchers with the infrastructure and tools to quickly build scalable, secure distributed ML applications in preconfigured environments.</p> \n<p>You will be able to run containerized applications on P5 instances with <a href=\"https://aws.amazon.com/machine-learning/containers/\">AWS Deep Learning Containers</a> using libraries for <a href=\"https://aws.amazon.com/ecs\">Amazon Elastic Container Service</a> (Amazon ECS) or <a href=\"https://aws.amazon.com/eks\">Amazon Elastic Kubernetes Service</a>  (Amazon EKS).  For a more managed experience, you can also use P5 instances via <a href=\"https://aws.amazon.com/sagemaker\">Amazon SageMaker</a>, which helps developers and data scientists easily scale to tens, hundreds, or thousands of GPUs to train a model quickly at any scale without worrying about setting up clusters and data pipelines. HPC customers can leverage <a href=\"https://aws.amazon.com/batch\">AWS Batch</a> and <a href=\"https://aws.amazon.com/hpc/parallelcluster/\">ParallelCluster</a> with P5 to help orchestrate jobs and clusters efficiently.</p> \n<p>Existing P4 customers will need to update their AMIs to use P5 instances. Specifically, you will need to update your AMIs to include the latest NVIDIA driver with support for NVIDIA H100 Tensor Core GPUs. They will also need to install the latest CUDA version (CUDA 12), CuDNN version, framework versions (e.g., PyTorch, Tensorflow), and EFA driver with updated topology files. To make this process easy for you, we will provide new DLAMIs and Deep Learning Containers that come prepackaged with all the needed software and frameworks to use P5 instances out of the box.</p> \n<p><strong><u>Now Available</u></strong><br /> Amazon EC2 P5 instances are available today in AWS Regions: US East (N. Virginia) and US West (Oregon). For more information, see the <a href=\"https://aws.amazon.com/ec2/pricing/?trk=041463df-8f24-4805-a5e7-9b0b508feb53&amp;sc_channel=el\">Amazon EC2 pricing page</a>. To learn more, visit our <a href=\"https://aws.amazon.com/ec2/instance-types/p5/?trk=51dd90cd-4bb6-46ef-9b65-d7c6ef3705af&amp;sc_channel=el\">P5 instance page</a> and explore <a href=\"https://repost.aws/tags/TAO-wqN9fYRoyrpdULLa5y7g/amazon-ec-2\">AWS re:Post for EC2</a> or through your usual AWS Support contacts.</p> \n<p>You can choose a <a href=\"https://aws.amazon.com/blogs/machine-learning/announcing-new-tools-for-building-with-generative-ai-on-aws/\">broad range of AWS services</a> that have generative AI built in, all running on the most cost-effective cloud infrastructure for generative AI. To learn more, visit <a href=\"https://aws.amazon.com/generative-ai/\">Generative AI</a> on AWS to innovate faster and reinvent your applications.</p> \n<p>— <a href=\"https://twitter.com/channyun\">Channy</a></p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"29631c501d46752bd2242ee7f4b491c2ea7df77452a333f09cc2f35f288a6f35","category":"Tech"}