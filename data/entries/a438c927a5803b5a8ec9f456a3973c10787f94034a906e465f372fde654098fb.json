{"title":"[Thingsboard] ทำ IoT Platform ด้วย Thingsboard + PostgreSQL","link":"https://thanapon.info/docker-thingsboard-postgresql/","date":1627218026000,"content":"<p>Thingsboard คือ IoT platform ตัวหนึ่งที่เป็น open-source (จริงๆก็มีเสียเงินนะ ชื่อว่า PE หรือ Professional edition และ onCloud service) รองรับการเชื่อมต่อของ Devices ผ่าน MQTT CoAP และ HTTP อีกทั้งยังสามารถ integrate service พวก AWS IoT, Azure IoT และอื่นๆเข้ามาใช้งานได้ด้วยเช่นกัน ในส่วนของการติดตั้งก็จะ support ตั้งแต่ Raspberry Pi ไปจนถึงรันบน Kube ที่เป็น Container orchestration เลย</p>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/Screen-Shot-2564-07-25-at-19.33.11-1024x502.png\" /></figure></div>\n\n\n\n<h3>สิ่งที่ต้องมีนะครับ</h3>\n\n\n\n<ul><li><strong>Docker engine</strong> and <strong>Docker-compose</strong></li></ul>\n\n\n\n<h3>เริ่มกันเลย</h3>\n\n\n\n<ul><li>สร้างไฟล์ <strong>docker-compose.yml</strong> กันก่อน</li></ul>\n\n\n\n<div><pre><code>version: '3.4'\n\nservices:\n  thingsboard:\n    container_name: thingsboard\n    image: thingsboard/tb-postgres\n    ports: \n      - 9090:9090\n      - 1883:1883\n      - 5683:5683/udp\n    restart: always\n    depends_on: \n        - postgresql\n    environment:\n      DATABASE_ENTITIES_TYPE: sql\n      DATABASE_TS_TYPE: sql\n      SPRING_JPA_DATABASE_PLATFORM: org.hibernate.dialect.PostgreSQLDialect\n      SPRING_DRIVER_CLASS_NAME: org.postgresql.Driver\n      SPRING_DATASOURCE_MAXIMUM_POOL_SIZE: 5\n      SQL_POSTGRES_TS_KV_PARTITIONING: MONTHS\n      SPRING_DATASOURCE_URL: jdbc:postgresql://postgresql:5432/thingsboard\n      SPRING_DATASOURCE_USERNAME: postgres\n      SPRING_DATASOURCE_PASSWORD: postgresPassword\n\n  postgresql:\n    container_name: postgresql\n    image: postgres:11.5-alpine\n    restart: always\n    environment:\n      POSTGRES_PASSWORD: postgresPassword\n      POSTGRES_USER: postgres\n      POSTGRES_DB: thingsboard\n    ports:\n      - 5432:5432</code></pre></div>\n\n\n\n<blockquote><p>thingsboard/tb-postgres: เป็น docker image ของ Thingsboard ที่เชื่อมต่อเข้ากับ PostgreSQL database โดยจะมี port ที่ถูก expose ออกมาเป็น <strong>9090</strong> ซึ่งจะเป็นหน้า Web UI ของ Thingsboard, <strong>1883</strong> เป็น Port สำหรับ MQTT และ <strong>5683</strong> สำหรับ CoAP</p><p>postgres:11.5-alpine: เป็น image ของ PostgreSQL ซึ่งจะมี port 5432 สำหรับให้ service อื่นๆเข้ามาเชื่อมต่อได้</p></blockquote>\n\n\n\n<ul><li>จากนั้นก็ทำการรัน docker-compose ขึ้นมาเลยโดยที่เราจะต้องอยู่ใน folder เดียวกันกับไฟล์ <strong>docker-compose.yml</strong> ข้างบนนะครับ</li></ul>\n\n\n\n<div><pre><code>docker-compose up -d</code></pre></div>\n\n\n\n<ul><li>แล้วก็จะได้หน้าตาแบบนี้ครับ รอให้ docker มัน pull image ลงมาสักครู่</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/image-1024x702.png\" /></figure></div>\n\n\n\n<ul><li>หลังจากที่เรารัน docker-compose เรียบร้อยแล้วมาลองดูว่า container ของเรานั้นทำงานอยู่ไหมโดยใช้คำสั่ง</li></ul>\n\n\n\n<div><pre><code>docker ps -a</code></pre></div>\n\n\n\n<ul><li>ก็จะได้หน้าตาแบบนี้ ว่า container ของเรากำลังรันอยู่นะจ๊ะ…</li></ul>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/image-1-1024x129.png\" /></figure></div>\n\n\n\n<h4>ทดสอบเข้า Web browser แล้วไปที่ http://localhost:9090 กันดูนะครับ</h4>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/image-2-1024x640.png\" /></figure></div>\n\n\n\n<blockquote><p><strong>Systen Administrator</strong>: sysadmin@thingsboard.org / sysadmin คือ role ที่ใหญ่ที่สุดสามารถกำหนด tenant admin ได้จัดการระบบต่างๆได้</p><p><strong>Tenant Administrator</strong>: tenant@thingsboard.org / tenant เป็น admin ที่จะมีไว้สำหรับสร้าง Asset, Device, Dashboard หรือการกำหนด rule engine </p><p><strong>Customer User</strong>: customer@thingsboard.org / customer คือ end-user</p></blockquote>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/Screen-Shot-2564-07-25-at-19.23.47-1-1024x640.png\" /></figure></div>\n\n\n\n<div><figure><img src=\"https://thanapon.info/wp-content/uploads/2021/07/image-3-1024x640.png\" /></figure></div>\n\n\n\n<p><strong>เสร็จเรียบร้อยครับ</strong> ส่วนที่เหลือก็อยู่ที่แต่ละคนละเอาไปประยุกต์ใช้กันต่อไปแล้ว เบื้องต้นสำหรับผม ถ้าเรากำลังจะทำระบบ IoT ขึ้นมาสักตัวหนึ่ง ส่วนตัวคิดว่าการใช้ docker-compose ร่วมกัน Thingsboard Platform น่าจะเป็นวิธีที่ง่ายที่สุดและเร็วที่สุด แต่จริงๆทางฝั่ง Thingboard เขาก็มี Cloud service ให้บริการอยู่เหมือนกันข้อดีก็คือเราไม่จำเป็นต้องมา Maintain ระบบแค่มีหน้าที่ส่งข้อมูลกับนำข้อมูลมาวิเคราะห์หรือแสดงผลเท่านั้นก็พอ ก็อาจจะเป็นอีก IoT Platform หนึ่งให้เราเลือกใช้ในอนาคตต่อไปนะครับ</p>\n\n\n\n<h3>สำหรับวันนี้ขอบคุณและสวัสดีครับ <img src=\"https://s.w.org/images/core/emoji/13.1.0/72x72/1f642.png\" /></h3>\n\n\n\n<blockquote><p><a href=\"https://hub.docker.com/r/thingsboard/tb-postgres\" target=\"_blank\">tb-postgres</a></p><cite>ThingsBoard is an open-source IoT platform for data collection, processing, visualization, and device management.</cite></blockquote>\n\n\n\n<blockquote><p><a href=\"https://hub.docker.com/_/postgres\" target=\"_blank\">postgres</a></p><cite>The PostgreSQL object-relational database system provides reliability and data integrity.</cite></blockquote>\n\n\n\n<blockquote><p><a href=\"https://thingsboard.io/docs/\" target=\"_blank\">https://thingsboard.io/docs/</a></p><cite>The ThingsBoard documentation can help you set up ThingsBoard, learn about the platform and get your IoT projects running on ThingsBoard.</cite></blockquote>\n<p>The post <a href=\"https://thanapon.info/docker-thingsboard-postgresql/\">[Thingsboard] ทำ IoT Platform ด้วย Thingsboard + PostgreSQL</a> appeared first on <a href=\"https://thanapon.info\">Thanapon</a>.</p>","author":"thanapon.tap","siteTitle":"Thanapon","siteHash":"6a039c2f54d76e4c49227d80968f2a30de5427cc57525c047c383ea3563cde5f","entryHash":"a438c927a5803b5a8ec9f456a3973c10787f94034a906e465f372fde654098fb","category":"Thai"}