{"title":"Amazon GuardDuty EC2 Runtime Monitoring is now generally available","link":"https://aws.amazon.com/blogs/aws/amazon-guardduty-ec2-runtime-monitoring-is-now-generally-available/","date":1711743744000,"content":"<p><a href=\"https://aws.amazon.com/guardduty/\">Amazon GuardDuty</a> is a machine learning (ML)-based security monitoring and intelligent threat detection service that analyzes and processes <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_data-sources.html\">various AWS data sources</a>, continuously monitors your AWS accounts and workloads for malicious activity, and delivers detailed security findings for visibility and remediation.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/26/2024-guardduty-ec2-runtime-monitoring-1-diagram-new.jpg\" width=\"1800\" height=\"766\" /></p> \n<p>I love the feature of <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html\">GuardDuty Runtime Monitoring</a> that analyzes operating system (OS)-level, network, and file events to detect potential runtime threats for specific AWS workloads in your environment. I <a href=\"https://aws.amazon.com/blogs/aws/amazon-guardduty-now-supports-amazon-eks-runtime-monitoring/\">first introduced</a> the general availability of this feature for <a href=\"https://aws.amazon.com/eks\">Amazon Elastic Kubernetes Service (Amazon EKS)</a> resources in March 2023. Seb <a href=\"https://aws.amazon.com/blogs/aws/introducing-amazon-guardduty-ecs-runtime-monitoring-including-aws-fargate/\">wrote about the expansion</a> of the Runtime Monitoring feature to provide threat detection for <a href=\"https://aws.amazon.com/ecs\">Amazon Elastic Container Service (Amazon ECS)</a> and <a href=\"https://aws.amazon.com/fargate\">AWS Fargate</a> as well as the <a href=\"https://aws.amazon.com/about-aws/whats-new/2023/11/amazon-guardduty-runtime-monitoring-amazon-ec2-preview/\">preview</a> for <a href=\"https://aws.amazon.com/ec2\">Amazon Elastic Compute Cloud (Amazon EC2)</a> workloads in Nov 2023.</p> \n<p>Today, we are announcing the general availability of <strong>Amazon GuardDuty EC2 Runtime Monitoring</strong> to expand threat detection coverage for EC2 instances at runtime and complement the anomaly detection that GuardDuty already provides by continuously monitoring VPC Flow Logs, DNS query logs, and <a href=\"https://aws.amazon.com/cloudtrail\">AWS CloudTrail</a> management events. You now have visibility into on-host, OS-level activities and container-level context into detected threats.</p> \n<p>With GuardDuty EC2 Runtime Monitoring, you can identify and respond to potential threats that might target the compute resources within your EC2 workloads. Threats to EC2 workloads often involve remote code execution that leads to the download and execution of malware. This could include instances or self-managed containers in your AWS environment that are connecting to IP addresses associated with cryptocurrency-related activity or to malware command-and-control related IP addresses.</p> \n<p>GuardDuty Runtime Monitoring provides visibility into suspicious commands that involve malicious file downloads and execution across each step, which can help you discover threats during initial compromise and before they become business-impacting events. You can also centrally enable runtime threat detection coverage for accounts and workloads across the organization using <a href=\"https://aws.amazon.com/organizations\">AWS Organizations</a> to simplify your security coverage.</p> \n<p><strong><u>Configure EC2 Runtime Monitoring in GuardDuty</u></strong><br /> With a few clicks, you can enable GuardDuty EC2 Runtime Monitoring in the <a href=\"https://console.aws.amazon.com/guardduty/home#/runtime-monitoring\">GuardDuty console</a>. For your first use, you need to enable Runtime Monitoring.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-2-enable.jpg\" width=\"1800\" height=\"952\" /></p> \n<p>Any customers that are new to the EC2 Runtime Monitoring feature can try it for <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring-free-trial-works.html\">free for 30 days</a> and gain access to all features and detection findings. The GuardDuty console shows how many days are left in the free trial.</p> \n<p>Now, you can set up the GuardDuty security agent for the individual EC2 instances for which you want to monitor the runtime behavior. You can choose to deploy the GuardDuty security agent either automatically or manually. At GA, you can enable <strong>Automated agent configuration</strong>, which is a preferred option for most customers as it allows GuardDuty to manage the security agent on their behalf.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-2-enable-ec2.jpg\" width=\"1352\" height=\"362\" /></p> \n<p>The agent will be deployed on EC2 instances with <a href=\"https://aws.amazon.com/systems-manager/\">AWS Systems Manager</a> and uses an <a href=\"https://aws.amazon.com/vpc\">Amazon Virtual Private Cloud (Amazon VPC)</a> endpoint to receive the runtime events associated with your resource. If you want to manage the GuardDuty security agent manually, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/managing-gdu-agent-ec2-manually.html\">Managing the security agent Amazon EC2 instance manually</a> in the AWS documentation. In multiple-account environments, delegated GuardDuty administrator accounts manage their member accounts using AWS Organizations. For more information, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_accounts.html\">Managing multiple accounts</a> in the AWS documentation.</p> \n<p>When you enable EC2 Runtime Monitoring, you can find the covered EC2 instances list, account ID, and coverage status, and whether the agent is able to receive runtime events from the corresponding resource in the <strong>EC2 instance runtime coverage </strong>tab.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/26/2024-guardduty-ec2-runtime-monitoring-2-coverage-1.jpg\" width=\"1800\" height=\"1400\" /></p> \n<p>Even when the coverage status is <strong>Unhealthy</strong>, meaning it is not currently able to receive runtime findings, you still have defense in depth for your EC2 instance. GuardDuty continues to provide threat detection to the EC2 instance by monitoring CloudTrail, VPC flow, and DNS logs associated with it.</p> \n<p><strong><u>Check out GuardDuty EC2 Runtime security findings</u></strong><br /> When GuardDuty detects a potential threat and generates security findings, you can view the details of the healthy information.</p> \n<p>Choose <strong>Findings</strong> in the left pane if you want to find security findings specific to Amazon EC2 resources. You can use the filter bar to filter the findings table by specific criteria, such as a <strong>Resource type</strong> of <code>Instance</code>. The severity and details of the findings differ based on the resource role, which indicates whether the EC2 resource was the target of suspicious activity or the actor performing the activity.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-3-findings.jpg\" width=\"1800\" height=\"856\" /></p> \n<p>With todayâ€™s launch, we support over 30 runtime security findings for EC2 instances, such as detecting abused domains, backdoors, cryptocurrency-related activity, and unauthorized communications. For the full list, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/findings-runtime-monitoring.html\">Runtime Monitoring finding types</a> in the AWS documentation.</p> \n<p><strong><u>Resolve your EC2 security findings</u></strong><br /> Choose each EC2 security finding to know more details. You can find all the information associated with the finding and examine the resource in question to determine if it is behaving in an expected manner.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-3-findings-ec2-runtime.jpg\" width=\"1800\" height=\"952\" /></p> \n<p>If the activity is authorized, you can use <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/findings_suppression-rule.html\">suppression rules</a> or <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_upload-lists.html\">trusted IP lists</a> to prevent false positive notifications for that resource. If the activity is unexpected, the security best practice is to assume the instance has been compromised and take the actions detailed in <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/compromised-ec2.html\">Remediating a potentially compromised Amazon EC2 instance</a> in the AWS documentation.</p> \n<p>You can integrate GuardDuty EC2 Runtime Monitoring with other AWS security services, such as <a href=\"https://aws.amazon.com/security-hub/\">AWS Security Hub</a> or <a href=\"https://aws.amazon.com/detective/\">Amazon Detective</a>. Or you can use <a href=\"https://aws.amazon.com/eventbridge/\">Amazon EventBridge</a>, allowing you to use integrations with security event management or workflow systems, such as Splunk, Jira, and ServiceNow, or trigger automated and semi-automated responses such as isolating a workload for investigation.</p> \n<p>When you choose <strong>Investigate with Detective</strong>, you can find Detective-created visualizations for AWS resources to quickly and easily investigate security issues. To learn more, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/detective-integration.html\">Integration with Amazon Detective</a> in the AWS documentation.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-3-detective.jpg\" width=\"1800\" height=\"688\" /></p> \n<p><strong><u>Things to know</u></strong><br /> GuardDuty EC2 Runtime Monitoring support is now available for EC2 instances running <a href=\"https://aws.amazon.com/amazon-linux-2/\">Amazon Linux 2</a> or <a href=\"https://aws.amazon.com/linux/amazon-linux-2023/\">Amazon Linux 2023</a>. You have the option to configure maximum CPU and memory limits for the agent. To learn more and for future updates, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/prereq-runtime-monitoring-ec2-support.html\">Prerequisites for Amazon EC2 instance support</a> in the AWS documentation.</p> \n<p>To estimate the daily average usage costs for GuardDuty, choose <strong>Usage</strong> in the left pane. During the 30-day free trial period, you can estimate what your costs will be after the trial period. At the end of the trial period, we charge you per vCPU hours tracked monthly for the monitoring agents. To learn more, visit the <a href=\"https://aws.amazon.com/guardduty/pricing/\">Amazon GuardDuty pricing</a> page.</p> \n<p><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/03/21/2024-guardduty-ec2-runtime-monitoring-4-usage.jpg\" width=\"2560\" height=\"1313\" /></p> \n<p>Enabling EC2 Runtime Monitoring also allows for a cost-saving opportunity on your GuardDuty cost. When the feature is enabled, you wonâ€™t be charged for GuardDuty foundational protection VPC Flow Logs sourced from the EC2 instances running the security agent. This is due to similar, but more contextual, network data available from the security agent. Additionally, GuardDuty would still process VPC Flow Logs and generate relevant findings so you will continue to get network-level security coverage even if the agent experiences downtime.</p> \n<p><strong><u>Now available</u></strong><br /> Amazon GuardDuty EC2 Runtime Monitoring is now available in all AWS Regions where GuardDuty is available, excluding AWS GovCloud (US) Regions and AWS China Regions. For a full list of Regions where EC2 Runtime Monitoring is available, visit <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_regions.html#gd-regional-feature-availability\">Region-specific feature availability</a>.</p> \n<p>Give GuardDuty EC2 Runtime Monitoring a try in the <a href=\"https://console.aws.amazon.com/guardduty/home#/runtime-monitoring\">GuardDuty console</a>. For more information, visit the <a href=\"https://docs.aws.amazon.com/guardduty/latest/ug/runtime-monitoring.html\">Amazon GuardDuty User Guide</a> and send feedback to <a href=\"https://repost.aws/tags/questions/TAkQ_AMw65SICuEGEmuUXv4g?view=all\">AWS re:Post for Amazon GuardDuty</a> or through your usual AWS support contacts.</p> \n<p>â€” <a href=\"https://twitter.com/channyun\">Channy</a></p>","author":"Channy Yun","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"adcb503f612479aea20eaf16e01dd5fb1612ae68aaa995b7ac197d6d43c6b4e9","category":"Tech"}