{"title":"‘aCropalypse’: Android and Windows Bugs Allow Cropped-Out Content From Screenshots to Be Recovered","link":"https://twitter.com/ItsSimonTime/status/1636857478263750656","date":1679444953000,"content":"\n<p>Simon Aarons:</p>\n\n<blockquote>\n  <p>Introducing acropalypse: a serious privacy vulnerability in the\nGoogle Pixel’s inbuilt screenshot editing tool, Markup, enabling\npartial recovery of the original, unedited image data of a cropped\nand/or redacted screenshot. Huge thanks to <a href=\"https://twitter.com/David3141593\">@David3141593</a>\nfor his help throughout!</p>\n</blockquote>\n\n<p><a href=\"https://www.da.vidbuchanan.co.uk/blog/exploiting-acropalypse.html\">David Buchanan</a>:</p>\n\n<blockquote>\n  <p>The bug lies in closed-source Google-proprietary code so it’s a\nbit hard to inspect, but after some patch-diffing I concluded that\nthe root cause was due to this horrible bit of API “design”:\n<a href=\"https://issuetracker.google.com/issues/180526528\">https://issuetracker.google.com/issues/180526528</a>.</p>\n\n<p>Google was passing <code>\"w\"</code> to a call to <code>parseMode()</code>, when they\nshould’ve been passing <code>\"wt\"</code> (the t stands for truncation). This\nis an easy mistake, since similar APIs (like POSIX <a href=\"https://man7.org/linux/man-pages/man3/fopen.3.html\">fopen</a>)\nwill truncate by default when you simply pass <code>\"w\"</code>. Not only\nthat, but previous Android releases had <code>parseMode(\"w\")</code> truncate\nby default too! This change wasn’t even documented until some time\nafter the aforementioned <a href=\"https://issuetracker.google.com/issues/180526528\">bug report</a> was made.</p>\n\n<p>The end result is that the image file is opened <em>without</em> the\n<code>O_TRUNC</code> flag, so that when the cropped image is written, the\noriginal image is not truncated. If the new image file is smaller,\nthe end of the original is left behind.</p>\n</blockquote>\n\n<p>I ran a few cropped screenshots from my Pixel 4 running Android 13 through <a href=\"https://acropalypse.app/\">their proof-of-concept tool</a>, and some of them revealed quite a bit of cropped-out content.</p>\n\n<p>And it’s not just Android: <a href=\"https://twitter.com/David3141593/status/1638222624084951040\">Buchanan today discovered that Windows 11 and 10 have a similar bug</a>.</p>\n\n<div>\n<a href=\"https://daringfireball.net/linked/2023/03/21/acropalypse-screenshot-bug\"> ★ </a>\n</div>\n\n\t","author":"John Gruber","siteTitle":"Daring Fireball","siteHash":"fc569638025dadf22a867470f8215f38855cf50e975782a6c989909474292a36","entryHash":"e0a6c95211796a523829f1f85eb5b78618a688dde2fddfbba046d779bed7ce50","category":"Tech"}