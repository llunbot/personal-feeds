{"title":"Okta พบบั๊กผู้ใช้ล็อกอินโดยไม่ต้องรู้ password บางกรณีหาก username ยาวเกิน 52 ตัว","link":"https://www.blognone.com/node/142901","date":1730519353000,"content":"<div><div><div><p>Okta รายงานช่องโหว่ซอฟต์แวร์ Okta AD/LDAP DelAuth ที่เชื่อม Okta เข้ากับซอฟต์แวร์ Active Directory หรือ LDAP ที่ใช้ล็อกอินภายในองค์กร โดยผู้ใช้ที่ username ยาวเกิน 52 ตัว</p>\n<p>ปัญหาที่เกิดขึ้นเพราะระบบแคชของ DelAuth ที่ใช้<a href=\"https://en.wikipedia.org/wiki/Bcrypt\">ฟังก์ชั่น bcrypt</a> ที่รองรับอินพุตสำหรับการแฮชได้เพียง 72 ตัวอักษรเท่านั้น การสร้างแคชคีย์ของ DelAuth นั้นเรียก <code>bcrypt(userID+username+password)</code> เมื่อชื่อผู้ใช้ยาวเกินไปทำให้มีเพียง userID  และ username ที่ถูกแฮช ทาง Okta แก้ช่องโหว่นี้ด้วยการเปลี่ยนไปใช้ PBKDF2 ที่ไม่มีข้อจำกัดความยาวอินพุต เพราะข้อมูลถูกแฮชก่อนเสมอ</p>\n<p>การโจมตีช่องโหว่นี้ ผู้ใช้ต้องเคยล็อกอินผ่าน DelAuth มาก่อนเพื่อให้เกิดแคช จากนั้นอาจจะล็อกอินสำเร็จ หาก agent ไม่ทำงานหรือระบบมีการล็อกอินจำนวนมาก ทำให้ระบบเลือกใช้ข้อมูลแคชก่อน</p>\n<p>ทาง Okta พบปัญหานี้ด้วยตัวเอง และแก้ไขเรียบร้อยแล้ว</p>\n<p>ที่มา - <a href=\"https://trust.okta.com/security-advisories/okta-ad-ldap-delegated-authentication-username/\">Okta</a></p>\n<p><img src=\"https://www.blognone.com/sites/default/files/externals/17a8f53bd0f44553f7562bd03de6ebe1.png\" /></p>\n</div></div></div><div><div>Topics: </div><div><div><a href=\"/topics/okta\">Okta</a></div><div><a href=\"/topics/security\">Security</a></div></div></div>","author":"lew","siteTitle":"Blognone","siteHash":"ededadcf18490b3937e7dd89ebe8c00dc129addbdf1ebe4aff1f458146693da0","entryHash":"babfc927e8976b1b11262ea67e10ba585e781f0418890a4733bad98fdbfa64c0","category":"Thai"}