{"title":"Playwright :: ทำ Dashboard แสดงผลการทดสอบใน Grafana","link":"https://www.somkiat.cc/playwright-test-report-in-grafana-dashboard/","date":1738826779000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-01-150x150.jpg\" alt=\"\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-01-150x150.jpg 150w, https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-01-75x75.jpg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-01.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-01.jpg\" alt=\"\" width=\"519\" height=\"291\" /></a></figure>\n\n\n\n<p>จากคำถามในการแบ่งปันเรื่อง Full Stack Testing ที่ Skooldio มานั้น<br />มีคำถามที่น่าสนใจคือ<br />ในการทดสอบระบบงานด้วย Playwright นั้น<br />ถ้าเราต้องการสร้าง dashboard กลางด้วย Grafana<br />เพื่อแสดงผลการทดสอบ จะทำได้หรือไม่ อย่างไรบ้าง ?<br />มาดูหนึ่งในแนวทางกัน</p>\n\n\n\n<span></span>\n\n\n\n<p><strong>โครงสร้างของแนวทางเป็นดังรูป</strong></p>\n\n\n\n<ul>\n<li>ทำการส่งข้อมูลผลการทดสอบไปยัง Prometheus Pushgateway ด้วย <a href=\"https://www.npmjs.com/package/@pumpo5.dev/playwright-prometheus-reporter\" target=\"_blank\">Playwright Prometheus Reporter</a></li>\n\n\n\n<li>จากนั้นทำการเก็บข้อมูลทั้งหมดไว้ที่ Promethus ซึ่งเป็น metric time-serie database</li>\n\n\n\n<li>สุดท้ายสร้าง dashboard ใน Grafana และกำหนด datasource ไปที่ Prometheus นั่นเอง</li>\n</ul>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-02.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-02.jpg\" alt=\"\" width=\"795\" height=\"350\" /></a></figure>\n\n\n\n<p><strong>โดยใน Playwright ให้ทำการ config ดังนี้</strong></p>\n\n\n\n<p>ในไฟล์ playwright.config.ts ให้เปลี่ยน report ไปยัง Promethus reporter<br />ตัวอย่าง</p>\n\n\n\n[gist id=\"09b30efeb0eed0a529b043a297e4f736\" file=\"playwright.config.ts\"]\n\n\n\n<p>จากนั้นใน folder ที่เก็บชุดการทดสอบต่าง ๆ ให้ทำการสร้างไฟล์ <strong>config.conf</strong> ขึ้นมา<br />เพื่อทำการ config การจัดเก็บข้อมูลของ report จากขั้นแรก เช่น</p>\n\n\n\n[gist id=\"09b30efeb0eed0a529b043a297e4f736\" file=\"config.conf\"]\n\n\n\n<p><strong>เมื่อทุกอย่างเรียนร้อยก็ทำการ setup ระบบจัดเก็บข้อมูลทั้ง 3 ส่วน คือ</strong></p>\n\n\n\n<ul>\n<li><a href=\"https://github.com/prometheus/pushgateway\" target=\"_blank\">Prometheus Pushgateway</a></li>\n\n\n\n<li><a href=\"https://prometheus.io/\" target=\"_blank\">Prometheus server</a></li>\n\n\n\n<li><a href=\"https://grafana.com/\" target=\"_blank\">Grafana</a></li>\n</ul>\n\n\n\n<p><strong>ทำการ run test ปกติ จะได้ผลดังนี้</strong></p>\n\n\n\n[gist id=\"09b30efeb0eed0a529b043a297e4f736\" file=\"1.txt\"]\n\n\n\n<p><strong>ให้ทำการตรวจสอบผลการทดสอบและ report ต่าง ๆ ใน Prometheus ได้</strong><br />ตาม key เหล่านี้</p>\n\n\n\n<ul>\n<li>suite_execution_total</li>\n\n\n\n<li>suite_execution_failed</li>\n\n\n\n<li>test_execution_total</li>\n</ul>\n\n\n\n<p>แสดงตัวอย่างดังรูป</p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-03.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-03.jpg\" alt=\"\" width=\"660\" height=\"354\" /></a></figure>\n\n\n\n<p><strong>และทำการสร้าง dashboard ใน Grafana ต่อไป แสดงตัวอย่าง ดังรูป</strong></p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-04.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/02/playwright-report-04.jpg\" alt=\"\" width=\"641\" height=\"260\" /></a></figure>\n\n\n\n<p>ลองใช้งานกันดูครับ<br />ตัวอย่าง source code และการติดตั้งอยู่ที่ <a href=\"https://github.com/up1/workshop-playwright-2025/tree/main/monitor-test\" target=\"_blank\">GitHub::Up1</a></p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"b531bdf1b82c75f429b908117cef1cb40f817f91dfc8b9ebe587b36a9dfe0921","category":"Thai"}