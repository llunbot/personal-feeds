{"title":"Vault 1.13 adds Kubernetes Operator, MFA improvements, and more","link":"https://www.hashicorp.com/blog/vault-1-13-adds-kubernetes-operator-mfa-improvements-and-more","date":1678118400000,"content":"<p>HashiCorp is pleased to announce the general availability of <a href=\"https://developer.hashicorp.com/vault/downloads?ajs_aid=394e8f6e-fd1c-40af-94aa-a8d4979c22ca&amp;_gl=1*1s1vrvb*_ga*MjA2ODcwOTIxNi4xNjczNDY0Nzcx*_ga_P7S46ZYEKW*MTY3NzcwMjkzOS4zMC4xLjE2Nzc3MDI5NTAuMC4wLjA.&amp;product_intent=vault\">Vault 1.13</a>. Vault provides secrets management, data encryption, and identity management for any application on any infrastructure.</p>\n\n<p>Vault 1.13 focuses on Vault’s core secrets workflows as well as team workflows, integrations, and visibility. The key features in this release include improvements to:</p>\n\n<ul>\n<li>Multi-namespace access workflows</li>\n<li>Azure auth method</li>\n<li>Google Cloud secrets engine</li>\n<li>KMIP secrets engine</li>\n<li>MFA login</li>\n<li>Vault Agent</li>\n<li>Certificate revocation for cross-cluster management</li>\n</ul>\n\n<p>Additional new features include:</p>\n\n<ul>\n<li>Event-based notifications (alpha)</li>\n<li>Vault Operator (beta)</li>\n<li>HCP link for self-managed Vault (private beta)</li>\n<li>PKI health checks</li>\n<li>Managed Transit keys</li>\n</ul>\n\n<h2>Multi-namespace access improvements</h2>\n\n<p>When customers have secrets distributed across multiple (independent) namespaces, their applications need to authenticate multiple times to Vault, creating an unnecessary burden. Additionally, customers using <a href=\"https://www.hashicorp.com/blog/why-use-the-vault-agent-for-secrets-management\">Vault Agent</a> need to run separate Vault Agent instances to talk to each namespace. Vault 1.13 includes namespace improvements to alleviate these challenges by enabling a single agent instance to be able to fetch secrets across <a href=\"https://developer.hashicorp.com/vault/docs/enterprise/namespaces#vault-enterprise-namespaces\">multiple namespaces</a>.</p>\n<img src=\"https://www.datocms-assets.com/2885/1678118292-namespace.jpg\" alt=\"Cross-namespace\" /><h2>Microsoft Azure auth improvements</h2>\n\n<p>Prior to Vault 1.13, only Microsoft Azure virtual machines could leverage the<a href=\"https://developer.hashicorp.com/vault/docs/auth/azure\"> Azure auth method</a> to authenticate to Vault. Vault 1.13 introduces the ability to authenticate to <a href=\"https://learn.microsoft.com/en-us/azure/azure-functions/\">Azure Functions</a> and the<a href=\"https://azure.microsoft.com/en-us/products/app-service\"> Azure App Service</a>.</p>\n\n<h2>Google Cloud secrets engine improvements</h2>\n\n<p>To avoid exhausting Google Cloud’s 10-key limit when the same service account is used with 10 or more Vault roles, Vault 1.13 improves the <a href=\"https://developer.hashicorp.com/vault/docs/secrets/gcp\">Google Cloud secrets engine</a> integration by using its own service account with Google Cloud’s account impersonation feature to generate access tokens.</p>\n\n<h2>Event-based notifications (alpha)</h2>\n\n<p>Vault 1.13 introduces an alpha release of a lightweight <a href=\"https://developer.hashicorp.com/vault/docs/concepts/events\">event-based notification feature</a> that can be used to notify downstream applications of changes to Vault secrets. Applications and external entities can subscribe to events via a websockets API.</p>\n\n<h2>Undo logs</h2>\n\n<p>We identified a race condition associated with Vault’s replication that is triggered when frequent updates to a set of keys can occasionally result in a <a href=\"https://developer.hashicorp.com/vault/tutorials/monitoring/monitor-replication#on-the-secondary\">merkle diff</a> or sync loop. This condition was corrected in Vault 1.12. However, it was disabled in 1.12. Vault 1.13 includes this correction as enabled by default.</p>\n\n<h2>MFA login improvements</h2>\n\n<p>As of 1.10, Vault introduced Login MFA, a standardized configuration for integration with <a href=\"https://developer.hashicorp.com/vault/docs/enterprise/mfa/mfa-duo\">Duo</a>, <a href=\"https://developer.hashicorp.com/vault/docs/enterprise/mfa/mfa-pingid\">PingIdentity</a>, <a href=\"https://developer.hashicorp.com/vault/docs/enterprise/mfa/mfa-okta\">Okta</a>, and TOTP, but some customers have found UX challenges with these configurations. With these improvements introduced in 1.13, Customers will be able to migrate to <a href=\"https://developer.hashicorp.com/vault/docs/auth/login-mfa\">Login MFA</a> more easily. Login MFA will be easier to configure and debug.</p>\n\n<p>Prior to 1.13, customers had to specify an MFA ID for each MFA provider, which is a long UUID. This can be cumbersome for customers with many clusters. 1.13 introduces MFA name as a human-readable alias.</p>\n\n<p>Passcode was not being used consistently across methods, now there is consistent behavior across the CLI and API, regardless of method.</p>\n\n<h2>Vault Secrets Operator (beta)</h2>\n\n<p>Kubernetes applications using Vault for secrets management have had the option of leveraging <a href=\"https://www.hashicorp.com/blog/kubernetes-vault-integration-via-sidecar-agent-injector-vs-csi-provider\">a sidecar or the CSI secrets store provider</a> to inject secrets into files. This created a number of challenges.</p>\n\n<p>First, these approaches required applications to be modified if you wanted the ability to read from a file. Furthermore, applications need to be aware of when credentials have been modified so that they can be re-read from the file. </p>\n\n<p>Vault 1.13 introduces the Vault Operator to provide a resolution to these challenges. The Operator will allow customers to natively sync secrets from Vault to Kubernetes clusters. </p>\n\n<p>The Vault Secrets Operator will not be immediately available with the GA launch of 1.13. It will be available in late March.</p>\n\n<h2>Vault Agent improvements</h2>\n\n<p>Vault 1.13 includes several enhancements to the Vault Agent.</p>\n\n<ul>\n<li>Users can get started with Vault Agent without needing to set up <a href=\"https://developer.hashicorp.com/vault/docs/agent\">auth methods</a>. This feature is for learning and testing. It is not recommended for production use.</li>\n<li>Listeners for the Vault Agent can now be configured with a role of “metrics only” so that a service can be configured to listen on a particular port for the purpose of metrics collection only.</li>\n<li>The Vault Agent can now read configurations from multiple files.</li>\n<li>The Vault Agent persists logging when there is a mismatch between the agent and server.</li>\n</ul>\n\n<h2>HCP link for self-managed Vault (private beta)</h2>\n\n<p>In Vault 1.13 and the HashiCorp Cloud Platform (HCP), we’ve introduced a feature enabling active connections between self-managed Vault clusters and HCP. The feature is similar to the <a href=\"https://www.hashicorp.com/blog/new-hcp-based-global-management-plane-for-consul-now-in-public-beta\">Consul global management plane</a>. You sign up for free on HCP to use it, and you can connect self-managed clusters into one platform and access applications built on top of HCP, such as the operations monitoring and usage insights features currently in private beta. </p>\n\n<p>We’ve chosen specifically to add these capabilities to HCP because adding data processing functionalities to the Vault binary could increase memory consumption. To participate in this private beta you must first upgrade to Vault 1.13. However, the upgrade doesn’t need to occur in your production environments. Simply upgrade a pre-production environment to Vault 1.13 and you can start testing. If you would like to participate in the beta please contact our product team by emailing <a href=\"mailto:siranjeevi.dheenadhayalan@hashicorp.com\">siranjeevi.dheenadhayalan@hashicorp.com</a>.</p>\n\n<h2>Certificate revocation for cross-cluster management</h2>\n\n<p>To improve the <a href=\"https://developer.hashicorp.com/vault/docs/secrets/pki/considerations#what-are-cross-cluster-crls\">cross-cluster certificate management</a> user experience, Vault 1.13 extends revocation capability support (including certificate revocation lists (CRLs) and online certificate status protocol (OCSP)) across multiple Vault clusters for the same PKI mount.</p>\n\n<h2>PKI health checks</h2>\n\n<p>Vault 1.13 introduces <a href=\"https://developer.hashicorp.com/vault/docs/commands/pki/health-check\">PKI health check CLI</a> commands to help organizations troubleshoot issues and avoid downtime. The following configurations are included: </p>\n\n<ul>\n<li>CA</li>\n<li>CRL validity</li>\n<li>Role permissions</li>\n<li>Audit for potentially unsafe parameters</li>\n<li>API’s</li>\n<li>Certificate volume</li>\n</ul>\n\n<h2>Enhanced KMIP with PKCS#11 operations</h2>\n\n<p>In Vault 1.13 we have added support in the KMIP secrets engine (KMIP Asymmetric Key Lifecycle,  Advanced CryptoGraphic Server profiles) for key <a href=\"https://developer.hashicorp.com/vault/docs/configuration/seal/pkcs11\">PKCS#11 operations</a> such as signature (sign/verify), random number generation (RNG), and MAC sign/verify. These should enable better KMIP/PKCS#11 integrations for Vault with a broader base of devices and software. </p>\n\n<h2>Managed Transit keys</h2>\n\n<p>Customers with particularly conservative risk profiles require their keys to be created and stored within hardware security modules (HSMs) or an external KMS. We want to make it easier for organizations to leverage Vault across all sections of their infrastructure, including HSMs and KMS. </p>\n\n<p>Vault 1.13 introduces support for offloading <a href=\"https://developer.hashicorp.com/vault/docs/enterprise/managed-keys\">Transit key cryptographic operations</a> (encrypt, decrypt, MAC sign/verify, RNG generation) from Transit to an HSM or cloud KMS. Organizations can now generate new Transit keys and key pairs using key material in an external HSM or KMS, and then use them for encryption and signatures on secrets in Vault. These features make it possible to centralize secrets and encryption management in Vault even in cases where Vault doesn’t support certain cryptographic algorithms (such as SEED/ARIA) required by an organization’s compliance policies.</p>\n\n<h2>Enable rotate-root in Azure auth method</h2>\n\n<p>While the rotate-root endpoint is available in the Azure secrets engine, it has not been implemented in our<a href=\"https://developer.hashicorp.com/vault/docs/secrets/azure#tutorial\"> Azure auth method</a>. For customers who want to rotate their client secrets in the Azure auth method mounts on a routine basis, this requires manual rotation. To do this, users need to manually rotate the client secret in Azure, and then manually update the Azure auth configuration. At scale, this is impractical. </p>\n\n<p>Vault 1.13 adds rotate-root capabilities to the Azure auth method, allowing users to generate a new client secret for the root account defined in the config of Azure auth method mounts. The generated value will be known only by Vault.</p>\n\n<h2>Upgrade details</h2>\n\n<p>This release also includes additional new features, workflow enhancements, general improvements, and bug fixes. The Vault 1.13 <a href=\"https://github.com/hashicorp/vault/blob/master/CHANGELOG.md\">changelog</a> lists all the updates. Please visit the <a href=\"https://learn.hashicorp.com/collections/vault/new-release\">Vault Release Highlights</a> page for step-by-step tutorials demonstrating the new features.</p>\n\n<p>Vault 1.13 introduces significant new functionality. As such, please review the <a href=\"https://www.vaultproject.io/docs/upgrading\">Upgrading Vault page</a>, as well as the <a href=\"https://www.vaultproject.io/docs/deprecation\">Feature Deprecation Notice and Plans page</a> for further details.</p>\n\n<p>As always, we recommend upgrading and testing new releases in an isolated environment. If you experience any issues, please report them on the <a href=\"https://github.com/hashicorp/vault/issues\">Vault GitHub issue tracker</a> or post to the <a href=\"https://discuss.hashicorp.com/c/vault/30\">Vault discussion forum</a>. As a reminder, if you believe you have found a security issue in Vault, please responsibly disclose it by emailing <a href=\"mailto:security@hashicorp.com\">security@hashicorp.com</a> — do not use the public issue tracker. For more information, please consult <a href=\"https://www.hashicorp.com/security\">our security policy and our PGP key</a>.</p>\n\n<p>For more information about Vault Enterprise, visit <a href=\"https://www.hashicorp.com/products/vault\">hashicorp.com/products/vault</a>. </p>\n","author":"Rich Dubose","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"e0bb89c8ffb5394f827f1b43cd88ff7fc40d1c26a81623878a9d4d65eb9d17b9","category":"Tech"}