{"title":"China firm reportedly cracks AirDrop using a flaw Apple has known about since 2019","link":"https://www.macworld.com/article/2197576/airdrop-cracked-security-sharingd-flaw.html","date":1704894746000,"content":"<p><a href=\"https://www.macworld.com\">Macworld</a></p>\n\n<div>\n<section><div></div></section>\n\n\n\n<p>AirDrop became very popular in China recently, for the simple reason that the function completely disguises the sender’s contact details. As AirDrop transmission does not take place via the internet or cellular phone network, but from iPhone to iPhone via Bluetooth identification and a local Wi-Fi network, it’s extremely difficult, if not impossible, for authorities to identify senders. This allowed protesters to exchange important messages, memes, and photos with each other without the police being able to crack the networks. </p>\n\n\n\n<p>With the launch of iOS 16.1.1 around a year ago, however, Apple put in place a <a href=\"https://www.macworld.com/article/1377200/apple-to-limit-airdrop-everyone-setting-to-10-minutes.html\">time limit of 10 minutes</a> when sharing connections with Everyone, rather than the default Contacts Only setting. The official line was that this move was intended to combat AirDrop spam and abuse, but the suspicion was that Apple was acceding to the wishes of the Chinese government–particularly as the change applied first in China.</p>\n\n\n\n<p>Now a Chinese state-licensed security company from Beijing <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://sfj.beijing.gov.cn/sfj/sfdt/ywdt82/flfw93/436331732/index.html&amp;xcust=1-1-2197576-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">claims</a> (via <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://www.bloomberg.com/news/articles/2024-01-09/china-says-cracked-apple-s-airdrop-to-identify-message-sources&amp;xcust=1-1-2197576-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">Bloomberg</a>) it has successfully cracked the system and obtained the contact details of an AirDrop sender. The firm says its experts have found log data for the AirDrop process on a recipient’s iPhone; the device name of the sender’s iPhone, along with their email and telephone number, is saved on the target iPhone during data transfer. Although the latter two details are converted into hash values, the security company has found a method to convert these hash values into readable text.</p>\n\n\n\n<p>We can confirm parts of this claim. We launched the console on our Mac and AirDropped a file to it from an iPhone, discovering from the console log data that the “sharingd” process is responsible for AirDrop. This contains a dedicated sub-process called “AirDrop,” but several other sub-processes were also active during the file transfer. We found the name of our iPhone in one of the sub-processes, along with the strength of the Bluetooth signal.</p>\n\n\n<div><figure><img loading=\"lazy\" src=\"https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?quality=50&amp;strip=all&amp;w=1200\" alt=\"Geräte-Angaben in den Konsole-Logs\" srcset=\"https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?quality=50&amp;strip=all 1950w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?resize=300%2C90&amp;quality=50&amp;strip=all 300w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?resize=768%2C230&amp;quality=50&amp;strip=all 768w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?resize=1200%2C359&amp;quality=50&amp;strip=all 1200w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-13.20.49.jpg?resize=1536%2C460&amp;quality=50&amp;strip=all 1536w\" width=\"1200\" height=\"359\" /><figcaption><p>Device details in the console logs.</p> </figcaption></figure><p>Halyna Kubiv</p></div>\n\n\n\n<p>The “AirDrop” sub-process actually stores the hash values for the email and phone number belonging to the contacted iPhone (see screenshot), but we were unable to access the plain text. </p>\n\n\n<div><figure><img loading=\"lazy\" src=\"https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?quality=50&amp;strip=all&amp;w=1200\" alt=\"Konsole-Logs bei der Airdrop-Übertragung\" srcset=\"https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?quality=50&amp;strip=all 1980w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?resize=300%2C93&amp;quality=50&amp;strip=all 300w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?resize=768%2C238&amp;quality=50&amp;strip=all 768w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?resize=1200%2C372&amp;quality=50&amp;strip=all 1200w, https://b2c-contenthub.com/wp-content/uploads/2024/01/Bildschirmfoto-2024-01-09-um-12.27.29.jpg?resize=1536%2C476&amp;quality=50&amp;strip=all 1536w\" width=\"1200\" height=\"372\" /><figcaption><p>Console logs during the AirDrop transfer</p>. </figcaption></figure><p>Halyna Kubiv</p></div>\n\n\n\n<p>Last but not least, it should be noted that our Mac and our iPhone are trusted devices, otherwise the AirDrop transfer would not work at all. Even with unknown contacts, the recipient must first authorize the data transfer; no foreign files are transferred without their knowledge. If the reports are true, AirDrop is a threat to dissidents in authoritarian states, as they believe they can remain anonymous when exchanging files.</p>\n\n\n\n<h2>Why didn’t Apple fix the flaw?</h2>\n\n\n\n<p>Security researchers have been warning Apple since at least 2019 that the AirDrop protocol is flawed and can be cracked. In August 2021, the group led by Alexander Heinrich at TU Darmstadt presented a much more secure alternative <a href=\"https://go.redirectingat.com/?id=111346X1569486&amp;url=https://tuprints.ulb.tu-darmstadt.de/20599/&amp;xcust=1-1-2197576-1-0-0&amp;sref=https://www.macworld.com/feed\" target=\"_blank\">called Private Drop</a>. </p>\n\n\n\n<p>The problem with AirDrop is that the protocol requests the address and phone number verified via the Apple ID from the sender’s device and the recipient’s device when establishing a connection if these are not in the address book of both parties. Although they are stored as hash values, they are fairly easy to decipher: the phone number consists only of digits and is easy to decode using a brute-force attack. For emails, attackers guess the usual alias structures, then search for possible matches in dictionaries and databases of leaked emails. </p>\n\n\n\n<p>According to Heinrich, it was only a matter of time before the security gaps in AirDrop were abused. However, the researchers have so far only intercepted the data during transmission attempts. The fact that the personal data of AirDrop contacts is stored locally on the iPhone was previously unknown. </p>\n\n\n\n<p>Heinrich says Apple reportedly contacted the researchers from Darmstadt about the loophole way back when iOS 16 was still in development. However, Heinrich was unable to find any significant changes to the transfer protocol security. Apple’s difficulty would be that the newer and more secure version of the AirDrop protocol would not be backward compatible with older iOS versions, he added.</p>\n\n\n\n<p><em>This article originally appeared on Macwelt and was translated and edited by David Price.</em></p>\n\niOS</div>","author":"","siteTitle":"Macworld","siteHash":"37e84dd5a21fa961d6d6630e269546024dbb7741b2e2fadbe74f47383c70dfbb","entryHash":"3de68a0b8a6fe4ecadad11b415ec15e1cf50897682acacbab6877336ab5760f3","category":"Apple"}