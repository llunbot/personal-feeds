{"title":"แนวทางในการ generate API Doc จาก traffic การใช้งาน","link":"https://www.somkiat.cc/generate-api-doc-from-traffic/","date":1747044270000,"content":"<p><img width=\"150\" height=\"150\" src=\"https://www.somkiat.cc/wp-content/uploads/2025/05/generate-api-doc-from-traffic-150x150.jpg\" alt=\"\" loading=\"lazy\" srcset=\"https://www.somkiat.cc/wp-content/uploads/2025/05/generate-api-doc-from-traffic-150x150.jpg 150w, https://www.somkiat.cc/wp-content/uploads/2025/05/generate-api-doc-from-traffic-75x75.jpg 75w\" /></p>\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/05/generate-api-doc-from-traffic.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/05/generate-api-doc-from-traffic.jpg\" alt=\"\" width=\"563\" height=\"375\" /></a></figure>\n\n\n\n<p>ปัญหาและคำถามหนึ่งที่น่าสนใจ สำหรับการพัฒนาระบบ API คือ<br />ถ้าระบบงานของเราไม่มี API Document เช่น Swager หรือ OpenAPI และ Scalar<br />เราจะสร้างขึ้นมาอย่างไรดี<br />แถม code ก็ไม่สามารถแก้ไขอะไรได้อีก (ทั้งไม่มีสิทธิ์ และ  code เก่ามาก ๆ)<br />ดังนั้นมาดูแนวทางการแก้ไขกันหน่อย</p>\n\n\n\n<span></span>\n\n\n\n<p><strong>แนวทางการแก้ไขจากเงื่อนไขและข้อจำกัดต่าง ๆ </strong></p>\n\n\n\n<p>สามารถทำงานดังนี้</p>\n\n\n\n<ul>\n<li>ทำแบบ manual เองเลย</li>\n\n\n\n<li>ทำการสร้างจาก access log ที่มีของระบบ ว่าแต่มีการบันทึก request และ response ไว้หรือไม่</li>\n\n\n\n<li>ทำ proxy มากั้นเพื่อ capture ข้อมูลของ traffic ในการทดสอบไว้</li>\n</ul>\n\n\n\n<p><strong>สิ่งที่เลือกคือ การใช้ proxy มาช่วย</strong></p>\n\n\n\n<p>จากนั้นก็ดูว่ามีเครื่องมืออะไรบ้าง<br />พบว่ามีเครื่องมือในการ capture เยอะมาก ๆ<br />แต่มีอยู่ตัวหนึ่งที่ไม่ได้เพียงแค่ capture traffic เท่านั้น<br />แต่ยังสร้าง API document ตาม spec ของ Swagger/Open API ให้เลย<br />ไม่พอ ยังทำการสร้าง postman collection ให้อีกด้วย<br />นั่นคือ <strong><a href=\"https://github.com/tienanr/docurift\">DocuRift</a></strong><br />มาลองใช้งานกันดู</p>\n\n\n\n<p><strong>โครงสร้างการทำงานของ Docurift เป็นดังรูป</strong></p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/05/docurift-01.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/05/docurift-01.jpg\" alt=\"\" width=\"516\" height=\"251\" /></a></figure>\n\n\n\n<p><strong>ลองติดตั้งและใช้งาน</strong></p>\n\n\n\n[gist id=\"dc7cefc5ec345c9e1337ac3f9cfb7bbc\" file=\"1.txt\"]\n\n\n\n<p>คำอธิบาย</p>\n\n\n\n<ul>\n<li>กำหนด backend url ไปยังชื่อ Host และ Post ของ API</li>\n\n\n\n<li>ทำการกำหนด port ของ proxy server</li>\n\n\n\n<li>ทำการกำหนด port ของ analyzer server สำหรับดูเอกสารต่าง ๆ ทั้ง Swagger/Open API และ Postman collection</li>\n</ul>\n\n\n\n<p>เมื่อทุกอย่างเรียบร้อยลอง start API server <br />และกำหนด proxy ที่ browser หรือ ผ่านเครื่องมือต่าง ๆ ให้ชี้ไปยัง Docurift proxy port<br />จากนั้นก็เริ่มใช้งานระบบ<br />ทาง <strong>Docurift</strong> จะ generate report ให้แบบ realtime กันเลย<br />จะได้ผลการทำงานดังนี้</p>\n\n\n\n<p><strong>API Document  ในรูปแบบ Swagger/Open API</strong></p>\n\n\n\n<p>ดูผ่าน analyzer port ได้เลย จากตัวอย่างคือ 9877</p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/05/openapi-report-01.jpg\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/05/openapi-report-01-1024x629.jpg\" alt=\"\" width=\"460\" height=\"282\" /></a></figure>\n\n\n\n<p><strong>Postman Collection </strong></p>\n\n\n\n<p>ดูผ่าน URL = <a href=\"http://localhost:9877/postman.json\" target=\"_blank\">http://localhost:9877/postman.json</a><br />เอามาเปิดใน Postman ได้ผลดังนี้</p>\n\n\n\n<figure><a href=\"https://www.somkiat.cc/wp-content/uploads/2025/05/openapi-report-02.png\"><img src=\"https://www.somkiat.cc/wp-content/uploads/2025/05/openapi-report-02-1024x361.png\" alt=\"\" width=\"467\" height=\"165\" /></a></figure>\n\n\n\n<p>ได้สิ่งที่ต้องการแล้วแบบง่าย ๆ<br />น่าจะเป็นอีกหนึ่งแนวทาง<br />ลองนำไปใช้กันดู<br />ขอให้สนุกกับการ coding ครับ</p>\n","author":"somkiat","siteTitle":"cc :: somkiat","siteHash":"3a23a5a4389e1e40c6fbb16520a8cc20df5b3591c25145ce72aaa18b19e48201","entryHash":"26349cd50692f3cbcff4e6c4c6c09fcf9f8aa2c360d0b56f093d42d25aa27ac3","category":"Thai"}