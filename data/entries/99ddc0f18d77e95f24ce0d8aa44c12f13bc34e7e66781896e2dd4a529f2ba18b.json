{"title":"How secret scanning works","link":"https://www.hashicorp.com/blog/how-secret-scanning-works","date":1713456000000,"content":"<p>Secret scanning is crucial for securing an enterprise’s security management lifecycle. Secret scanning helps identify and prevent security threats posed by exposed sensitive information, passwords, API keys, and other credentials. </p>\n\n<p><a href=\"https://github.blog/2023-11-08-the-state-of-open-source-and-ai/\">GitHub’s Octoverse</a> highlights several mediums where sensitive information may be exposed, including code, configuration tools, CI/CD platforms, and communication channels used to collaborate. When discovered bad actors, this type of information can be used to access systems and associated data, resulting in data breaches and other security incidents.</p>\n\n<p>Secret scanning solutions proactively identify potential security threats so they can be remedied before they can be exploited. Scanning solutions search code repositories, commits, configuration tools, and other data sources for sensitive information, passwords and access keys. </p>\n\n<p>Secret scanning is a key component of modern security strategies that helps organizations in several ways, including:</p>\n\n<ul>\n<li><strong>Preventing data breaches</strong>: Secret scanning solutions help prevent data breaches by identifying and remediating threats before leaked passwords or API keys can be exploited.</li>\n<li><strong>Improving compliance</strong>: Many organizations are subject to regulatory frameworks designed to protect sensitive information, including publicly identifiable information (PII). </li>\n<li><strong>Protecting reputations</strong>: Security incidents can significantly damage an organization's reputation, which affects their ability to conduct business and negatively impacts revenue.</li>\n<li><strong>Cost reduction and avoidance</strong>: Organizations affected by data breaches or other security incidents incur significant costs. The primary costs associated with security incidents include legal fees, remediation, additional auditing, and lost business. IBM’s <a href=\"https://www.ibm.com/reports/data-breach\">Costs of a Data Breach Report</a> estimates that the average cost of a data breach is $4.45 million.</li>\n</ul>\n\n<h2>Approaches to secret scanning</h2>\n\n<p>There are multiple programmatic strategies to secret scanning, including:</p>\n\n<ul>\n<li><strong>Regular expression scanning:</strong> Regular expressions are simply a sequence of characters that specify a matching pattern in text. Regular expressions scans are useful for evaluating types of sensitive information that often follow a pattern like API keys or access tokens.</li>\n<li><strong>Dictionary scanning:</strong> The dictionary approach involves using pre-defined data sources of known secrets to identify potential vulnerabilities. The data source may originate from a series of secrets directly entered into the scanning solution or a secrets management platform like <a href=\"https://www.vaultproject.io/\">HashiCorp Vault</a>. Dictionary scanning focuses on evaluating log files, code repositories, and configuration tools. This approach to scanning is especially effective when a secrets management tool is used as the dictionary’s data source. This approach allows users to understand if a secret is current or no longer in use —  something regular expression scanning cannot do.</li>\n<li><strong>Hybrid scanning:</strong> Hybrid scanning combines multiple evaluation approaches. Using regular expression and dictionary-based scanning together would be an example of hybrid scanning. More scanning approaches increases the effectiveness of secret scanning and detects a broader range of secrets while also raising fewer false positives.</li>\n</ul>\n\n<h2>Common locations for secrets</h2>\n\n<p>Secrets can hide in many places, so it’s important to scan for secrets in the most likely locations:</p>\n\n<ol>\n<li><strong>Code:</strong> Developers may accidentally hard-code sensitive information, passwords, or API keys directly into their application code or configuration files. </li>\n<li><strong>Collaboration tools:</strong> Venues like Confluence, JIRA, Slack, and other tools are used for  collaboration between DevOps, DevSecOps, Platform Ops, and business partners. During collaboration, secrets and sensitive information may be left on these platforms, which may fall outside the organization’s security policies. </li>\n<li><strong>Container images:</strong> Container images are a common location to hold hard-coded secrets, which can make containers vulnerable to attackers. When a developer uses base images, especially from a public registry like Docker Hub, they are leveraging external code that should be considered untrusted. These containers may contain hard-coded secrets. </li>\n<li><strong>The broader technology stack:</strong> A DevOps stack includes a wide range of tools and services, such as repositories, build systems, and deployment pipelines, that may contain secrets that are not properly protected. </li>\n</ol>\n\n<h2>HCP Vault Radar as your secrets scanning solution</h2>\n\n<p><a href=\"https://www.hashicorp.com/blog/hcp-vault-radar-for-secret-discovery-enters-limited-availability\">HCP Vault Radar, now in limited availability</a>, is an extension to the HashiCorp Vault secrets management platform that conducts ongoing reconnaissance of unsecured secrets stored as plaintext in code repositories, configuration tools, DevOps tools, and collaboration tools.</p>\n\n<p>HCP Vault Radar employs a hybrid scanning approach using both regular expressions and dictionaries to find leaked secrets and sensitive information. This broad set of evaluation techniques makes HCP Vault Radar an effective secrets scanning solution that can significantly reduce your organization’s attack surface and risk of data breach.</p>\n\n<p>HCP Vault Radar focuses on several areas to ensure its effectiveness in secrets discovery.</p>\n\n<p><strong>Developer experience:</strong> HCP Vault Radar supports Git-based source control tools like GitHub, GitLab, and BitBucket. It can be automated to conduct scans over code repositories but also supports a developer’s native workflow by scanning commits and pull requests.  </p>\n\n<p><strong>Coverage:</strong> HCP Vault Radar provides comprehensive coverage of relevant locations where secrets may be found. Supported locations include:</p>\n\n<ul>\n<li>Code repositories</li>\n<li>Container images</li>\n<li>Configuration files and tools like AWS Parameter Store</li>\n<li>Amazon S3</li>\n<li>Confluence</li>\n<li>File directories</li>\n<li>Databases</li>\n</ul>\n\n<p>Wide coverage helps ensure vulnerabilities are identified across all areas of the software supply chain process, and broad integrations ensure that exposures can be remedied within common development workflows.</p>\n\n<p><strong>Accuracy:</strong> HCP Vault Radar leverages hybrid approach using a broad array of scanning approaches, including:  </p>\n\n<ul>\n<li>Scanning for known patterns</li>\n<li>Testing for high entropy</li>\n<li>Check for liveness whenever possible</li>\n<li>Ignore rules that can help users tune secrets detection</li>\n</ul>\n\n<p>This hybrid secret scanning approach reduces both false positives and false negatives. False positives can lead to wasted time and effort on the exploration and remediation of non-existent issues, while false negatives can leave vulnerabilities undetected and expose the organization to risk. </p>\n\n<p><strong>Monitoring and alerting:</strong> HCP Vault Radar provides monitoring and alerting capabilities to enable quick detection and remediation. Real-time alerts and notifications can be configured to fire when vulnerabilities are identified, and can be integrated with existing incident-response workflows.</p>\n\n<p><strong>Prioritization:</strong> HCP Vault Radar is a risk-based code security platform that prioritizes evaluation results based on the presence of: </p>\n\n<ul>\n<li>High-risk content in code (secrets in code, PII, and other high risk content)</li>\n<li>Risks due to misconfigurations of Git repositories</li>\n<li>Non-conformance with access and identity governance best practices</li>\n</ul>\n\n<p><strong>Customization:</strong> You can customize HCP Vault Radar’s scanning rules to meet the specific needs of your organization. This includes defining custom rules for identifying and prioritizing the sensitive data it discovers..</p>\n\n<h2>Getting started</h2>\n\n<p>HCP Vault Radar is an exciting new addition to HashiCorp Vault’s secret lifecycle management capabilities that helps enterprises reduce risk associated with credential exposure. Discovery of unmanaged secrets and subsequent remediation workflows further differentiate Vault’s secrets lifecycle management offering by enabling organizations to take a proactive approach to remediation <em>before</em> a data breach occurs. </p>\n\n<p>To learn more, check out these resources:</p>\n\n<ul>\n<li><a href=\"https://www.hashicorp.com/blog/hcp-vault-radar-for-secret-discovery-enters-limited-availability\">HCP Vault Radar limited availability announcement</a></li>\n<li><a href=\"https://developer.hashicorp.com/hcp/docs/vault-radar\">HCP Vault Radar product documentation</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/solutions-to-secret-sprawl\">Solutions to secret sprawl</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/new-hcp-vault-secrets-radar-and-other-features-fight-secrets-sprawl\">New HCP Vault Secrets, Radar, and other features fight secret sprawl</a></li>\n<li><a href=\"https://www.hashicorp.com/contact-sales?interest=vault\">Contact</a> HashiCorp sales</li>\n<li><a href=\"https://www.youtube.com/watch?v=7CoZo6ucr00\">HCP Vault Radar: finding unmanaged secrets</a></li>\n</ul>\n","author":"Rich Dubose","siteTitle":"HashiCorp Blog","siteHash":"219aa6310b3388f2335eba49871f4df9581f2c58eaeb5e498363b54e835b7001","entryHash":"99ddc0f18d77e95f24ce0d8aa44c12f13bc34e7e66781896e2dd4a529f2ba18b","category":"Tech"}