{"title":"AWS Clean Rooms now supports multiple clouds and data sources","link":"https://aws.amazon.com/blogs/aws/aws-clean-rooms-now-supports-multiple-clouds-and-data-sources/","date":1733110058000,"content":"<p>Today, we are announcing support for Snowflake and <a href=\"https://aws.amazon.com/athena\">Amazon Athena</a> as new sources for <a href=\"https://aws.amazon.com/clean-rooms/\">AWS Clean Rooms</a> data collaborations. AWS Clean Rooms helps you and your partners more seamlessly and securely analyze your collective datasets without sharing or copying one another’s underlying data. This enhancement helps you collaborate with datasets stored in Snowflake or those queryable through Athena features, such as <a href=\"https://console.aws.amazon.com/lakeformation/\">AWS Lake Formation</a> permissions or <a href=\"https://docs.aws.amazon.com/athena/latest/ug/views-glue.html\">AWS Glue Data Catalog views</a>, without moving or revealing the source data.</p> \n<p>You often need to collaborate with partners to analyze datasets to get insights for research and development, investments, or marketing and advertising campaigns. In some cases, your partners’ datasets are stored or managed outside of <a href=\"https://aws.amazon.com/s3/\">Amazon Simple Storage Service (Amazon S3)</a>, and companies want to reduce or eliminate the complexity, cost, compliance risks, and delays that are associated with moving or copying data. Companies also find that copying data can result in them using outdated information, potentially reducing the quality of the insights gained.</p> \n<p>This launch helps companies to collaborate on the most up-to-date collective datasets in an AWS Clean Rooms collaboration with zero extract, transform, and load (zero-ETL). This eliminates the cost and complexity associated with migrating datasets out of existing environments. For example, an advertiser with data stored in Amazon S3 and a media publisher with data stored in Snowflake can run an audience overlap analysis to determine the percentage of users present in their collective datasets without having to build ETL data pipelines, or share underlying data with one another. No underlying data from external data sources is permanently stored in AWS Clean Rooms during the collaboration process and any data temporarily read into the AWS Clean Rooms analysis environment is deleted upon query completion. You can now work with your partners regardless of where their data is stored, streamlining the process of generating insights.</p> \n<p>Let me show you how to use this feature.</p> \n<p><span><strong>How to use multiple clouds and data sources in AWS Clean Rooms<br /> </strong></span>To demonstrate this feature, I use a scenario between an advertiser, Company A, and a publisher, Company B. Company A wants to know how many of their high-value users can be reached on Company B’s website before running an ad campaign. Company A stores their data in Amazon S3. Company B stores their data in Snowflake. To use AWS Clean Rooms, both parties must have their own AWS accounts.</p> \n<p>In this demo, Company A, the advertiser, is the collaboration creator. Company A creates the AWS Clean Rooms collaboration and invites Company B, who has data hosted in Snowflake, to collaborate. You can follow the specific steps to create a collaboration in the <a href=\"https://aws.amazon.com/blogs/aws/aws-clean-rooms-now-generally-available/\">AWS Clean Rooms general availability announcement blog post</a>.</p> \n<p>Next, I show how Company B, the publisher, creates a configured table in AWS Clean Rooms, specifying Snowflake as the data source and providing the Secrets Manager Amazon Resource Name (ARN). <a href=\"https://aws.amazon.com/secrets-manager/\">AWS Secrets Manager</a> helps you manage, retrieve, and rotate secrets such as database credentials throughout their lifecycles. Your secret must contain the credentials for a Snowflake user with read-only permission to the data you want to collaborate with. AWS Clean Rooms will use it to read your secret and access the data stored in Snowflake. See the <a href=\"https://docs.aws.amazon.com/secretsmanager/latest/userguide/create_secret.html\">Secrets Manager documentation</a> for step-by-step instructions for creating your secret.</p> \n<p>Using Company B’s AWS account, I go to the <a href=\"https://console.aws.amazon.com/cleanrooms/\">AWS Clean Rooms console</a> and choose <strong>Tables</strong> under <strong>Configured resources</strong>. I choose <strong>Configure new table</strong>. I choose <strong>Snowflake</strong> under <strong>Third-party clouds and data sources</strong>. I enter the <strong>Secret ARN</strong> for the secret that contains Snowflake credentials for a role with read access to the dataset stored in Snowflake I want to collaborate with. These are the credentials that you use to verify the identity of the entity trying to access the Snowflake table and schema. If you don’t have a secret ARN, you can create a new secret using the <strong>Store a new secret for this table</strong> option.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/12/01a-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/12/01a-LaunchMarketingIntake-1256.png\" width=\"1472\" height=\"875\" /></a></p> \n<p>To define the <strong>t</strong><strong>able and schema details</strong>, I use the <strong>Import from file</strong> option and choose the Columns View Information Schema CSV file I exported from Snowflake to populate the information for me. You can also enter the information manually.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/07-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/07-LaunchMarketingIntake-1256.png\" width=\"1179\" height=\"899\" /></a></p> \n<p>For this demo, I choose <strong>All columns</strong> under the <strong>Columns allowed in collaborations</strong>. Next, I choose <strong>Configure new table</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/02a-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/02a-LaunchMarketingIntake-1256.png\" width=\"1337\" height=\"637\" /></a></p> \n<p>I go to the configured table and observe the table details, such as AWS accounts allowed to create queries and columns available for querying. On this page, I can edit the table name, description, and analysis rule.</p> \n<p>As part of configuring a table to use in AWS Clean Rooms for collaboration analysis, I need to configure an analysis rule. An analysis rule is a privacy-enhancing control that each data owner sets up on a configured table. An analysis rule determines how the configured table can be analyzed. I choose <strong>Configure analysis rule </strong>to configure a custom analysis rule that allows custom queries to be run on the configured table.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/11-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/11-LaunchMarketingIntake-1256.png\" width=\"1924\" height=\"756\" /></a></p> \n<p>In Step 1, I proceed with the selections. You can use <strong>JSON editor</strong> to create, paste, or import an analysis rule definition in a JSON format. I choose <strong>Next</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/12-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/12-LaunchMarketingIntake-1256.png\" width=\"1480\" height=\"630\" /></a></p> \n<p>In Step 2, I choose <strong>Allow any queries created by specific collaborators to run without review on this table</strong> under <strong>Analyses for direct querying</strong>. With this option, only queries provided by the AWS accounts that I specify in the list of allowed accounts can be run on the table. All analysis templates created by the allowed accounts will automatically be allowed to be run on this table without requiring a review. I choose the allowed account under <strong>AWS account ID </strong>and choose <strong>Next</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/13-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/13-LaunchMarketingIntake-1256.png\" width=\"1478\" height=\"640\" /></a></p> \n<p>In Step 3, I proceed with the selections. I choose <strong>None</strong> under <strong>Columns not allowed in output</strong> to allow all columns to be shown in the query output. I choose <strong>Not allowed</strong> under <strong>Additional analyses applied to output</strong>, so no additional analyses can be run on this table. I choose <strong>Next</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/14-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/20/14-LaunchMarketingIntake-1256.png\" width=\"1481\" height=\"649\" /></a></p> \n<p>In the final step, I review the configuration and choose <strong>Configure analysis rule</strong>.</p> \n<p>Next, I associate the table with the collaboration Company A, the advertiser, created using <strong>Associate to collaboration</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/08a-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/08a-LaunchMarketingIntake-1256.png\" width=\"1912\" height=\"898\" /></a></p> \n<p>On the pop-up window, I choose a collaboration from the ones with active memberships and select <strong>Choose collaboration</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/09-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/18/09-LaunchMarketingIntake-1256.png\" width=\"1924\" height=\"914\" /></a></p> \n<p>On the next page, I choose the <strong>Configured table name</strong> and enter the <strong>Name</strong> under <strong>Table associations details</strong>. I choose a method to authorize AWS Clean Rooms to give the permission to query the table. I choose <strong>Associate table</strong>.</p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/05-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/05-LaunchMarketingIntake-1256.png\" width=\"1199\" height=\"1019\" /></a></p> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/06-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/06/06-LaunchMarketingIntake-1256.png\" width=\"1924\" height=\"741\" /></a></p> \n<p>Company A, the advertiser, and Company B, the publisher, can now run an audience overlap analysis to determine the percentage of users present in their collective datasets without accessing each other’s raw data. The analysis helps determine how much of the advertiser’s audience can be reached by the publisher. By evaluating the overlap, advertisers can determine whether the publisher provides unique reach or if the publisher’s audience predominantly overlaps with the advertiser’s existing audience, without either party having to move or share their source data. I switch to Company A’s account and go to <a href=\"https://console.aws.amazon.com/cleanrooms/\">AWS Clean Rooms</a> console. I choose the collaboration I created and run the following query to get the audience overlap analysis result:</p> \n<pre><code>select count (distinct emailaddress)\nfrom customer_data_example as advertiser\ninner join synthetic_customer_data  as publisher\non 'emailaddress' = 'publisher_hashed_email_address'</code></pre> \n<p><a href=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/19/10-LaunchMarketingIntake-1256.png\"><img loading=\"lazy\" src=\"https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/11/19/10-LaunchMarketingIntake-1256.png\" width=\"1687\" height=\"876\" /></a></p> \n<p>In this example, I used Snowflake as a data source. You can also run queries on this data using Athena while following <a href=\"https://console.aws.amazon.com/lakeformation/\">AWS Lake Formation</a> permissions. This helps you do row- and column-level filtering with Lake Formation fine-grained access control and transform data using AWS Glue Data Catalog views before the datasets are associated to the collaboration.</p> \n<p><span><strong>Customer and partner voices<br /> </strong></span>“Data security and privacy is essential to our work at Kinective Media by United Airlines, the world’s first traveler media network,” said <strong>Khatidja Ajania, Director, Strategic Partnerships, Kinective Media by United Airlines</strong>. “AWS Clean Rooms support of source data in multiple clouds and AWS sources enables us to securely and seamlessly work with more brands to deliver on closed loop measurement and other key use cases. This enhancement will make it easier for us to securely deliver personalized experiences, content, and relevant offerings to millions of United travelers through privacy-enhanced collaboration with our advertisers and partners.”</p> \n<p>“Snowflake recognizes the challenges of source data interoperability across tech stacks when using data clean room technology; we are excited to see the progress and one more step taken in the direction of a shared goal to empower users to unlock the full potential of their data partnerships through their solution of choice, safely and effectively” – <strong>Kamakshi Sivaramakrishnan, General Manager, Snowflake Data Clean Rooms</strong><span><strong><br /> </strong></span></p> \n<p><span><strong>Now available<br /> </strong></span>Support for Snowﬂake and Athena as data sources in AWS Clean Rooms oﬀers signiﬁcant beneﬁts for cross-cloud collaboration. This launch eliminates the need for data movement across clouds and data sources and simpliﬁes the collaboration process. This is a first step in our eﬀorts to expand the ways in which customers can securely collaborate with any of their partners while protecting sensitive information, regardless of where their data is stored.</p> \n<p>Get started with <a href=\"https://aws.amazon.com/clean-rooms/\">AWS Clean Rooms</a> today. To learn more about collaborating with multiple data sources, visit the <a href=\"https://docs.aws.amazon.com/clean-rooms/\">AWS Clean Rooms documentation</a>.</p> \n<p><a href=\"https://www.linkedin.com/in/esrakayabali/\">— Esra</a></p>","author":"Esra Kayabali","siteTitle":"AWS News Blog","siteHash":"6093e072e4117ec22616e844cb857d03ca62c57a411a8affc77cb5e8b6b15bf6","entryHash":"95e2c38fd1b78aecbed8a85a972c4763dc2dc607d8ec50533763a4dc49b66c82","category":"Tech"}